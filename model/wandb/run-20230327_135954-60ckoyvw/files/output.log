[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'learning_rate' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_epochs' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'weight_decay' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'depth' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'heads' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'attn_dropout' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'dim_ff' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'd_model' was locked by 'sweep' (ignored update).
  0%|                                                                                                                            | 0/70 [00:00<?, ?it/s]
Creating dataset...
Loading data from /home/usuaris/veu/gerard.calvo.bartra/nuwe/model/../data/supply_chain_train_raw.csv
Train batch 0:
{'data': tensor([[-0.5292, -0.9199, -1.0240,  ...,  0.0000,  0.0000,  0.0000],
        [-0.6732,  0.8221, -1.0240,  ...,  0.0000,  0.0000,  0.0000],
        [-0.6744, -0.0489,  1.2890,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [ 1.2796, -0.5466,  1.2890,  ...,  0.0000,  0.0000,  1.0000],
        [ 1.1065,  0.2000,  0.5180,  ...,  0.0000,  0.0000,  0.0000],
        [ 1.8507,  0.0756,  2.0600,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1,
        1, 1, 1, 1, 1, 1, 1, 1])}
Validation batch 0:
{'data': tensor([[-0.7021, -0.9862, -0.2985,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7690,  0.4015,  2.1085,  ...,  0.0000,  0.0000,  1.0000],
        [-0.7355,  0.0231, -1.1008,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-0.7259,  0.1492, -0.2985,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.4713,  0.5277,  2.1085,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7987, -0.2293,  0.5039,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 0, 1, 1])}
batch_data.shape: torch.Size([32, 38])
Percentage of positive and negative samples in the training set:
1    0.839094
0    0.160906
Name: Attrition_Flag, dtype: float64
FTTransformer(
  (numerical_embedder): NumericalEmbedder(
    (linear): Linear(in_features=38, out_features=128, bias=True)
  )
  (layers): ModuleList(
    (0-3): 4 x ModuleList(
      (0): Attention(
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (to_qkv): Linear(in_features=128, out_features=384, bias=False)
        (to_out): Linear(in_features=128, out_features=128, bias=False)
        (dropout): Dropout(p=0.09198550408781048, inplace=False)
      )
      (1): Sequential(
        (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (1): Linear(in_features=128, out_features=128, bias=True)
        (2): GEGLU()
        (3): Dropout(p=0.09198550408781048, inplace=False)
        (4): Linear(in_features=64, out_features=128, bias=True)
      )
    )
  )
  (to_logits): Sequential(
    (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (1): ReLU()
    (2): Linear(in_features=128, out_features=1, bias=True)
    (3): Sigmoid()
  )
)
Num params:  368897

  1%|█▋                                                                                                                  | 1/70 [00:05<06:02,  5.25s/it]
Epoch 0 (train) - Loss: 0.079

  3%|███▎                                                                                                                | 2/70 [00:11<06:30,  5.74s/it]
Epoch 1 (train) - Loss: 0.061

  4%|████▉                                                                                                               | 3/70 [00:16<06:16,  5.63s/it]
Epoch 2 (train) - Loss: 0.060

  6%|██████▋                                                                                                             | 4/70 [00:21<05:53,  5.36s/it]
Epoch 3 (train) - Loss: 0.059

  7%|████████▎                                                                                                           | 5/70 [00:27<06:02,  5.57s/it]
Epoch 4 (train) - Loss: 0.060

  9%|█████████▉                                                                                                          | 6/70 [00:33<05:57,  5.59s/it]
Epoch 5 (train) - Loss: 0.058

 10%|███████████▌                                                                                                        | 7/70 [00:39<06:06,  5.81s/it]
Epoch 6 (train) - Loss: 0.058

 11%|█████████████▎                                                                                                      | 8/70 [00:47<06:42,  6.50s/it]
Epoch 7 (train) - Loss: 0.057

 13%|██████████████▉                                                                                                     | 9/70 [00:54<06:53,  6.78s/it]
Epoch 8 (train) - Loss: 0.055

 14%|████████████████▍                                                                                                  | 10/70 [01:02<07:05,  7.09s/it]
Epoch 9 (train) - Loss: 0.055
Epoch 9 (test) - Accuracy: 0.914 - F1 score: 0.949

 16%|██████████████████                                                                                                 | 11/70 [01:11<07:33,  7.68s/it]
Epoch 10 (test) - Accuracy: 0.912 - F1 score: 0.949
Epoch 11 (train) - Loss: 0.056

 17%|███████████████████▋                                                                                               | 12/70 [01:20<07:48,  8.08s/it]
Epoch 12 (train) - Loss: 0.053

 19%|█████████████████████▎                                                                                             | 13/70 [01:30<08:05,  8.52s/it]
Epoch 13 (train) - Loss: 0.053

 20%|███████████████████████                                                                                            | 14/70 [01:40<08:19,  8.92s/it]

 21%|████████████████████████▋                                                                                          | 15/70 [01:49<08:24,  9.17s/it]
Epoch 14 (test) - Accuracy: 0.914 - F1 score: 0.950
Epoch 15 (train) - Loss: 0.049

 23%|██████████████████████████▎                                                                                        | 16/70 [02:00<08:40,  9.63s/it]
Epoch 16 (train) - Loss: 0.049

 24%|███████████████████████████▉                                                                                       | 17/70 [02:10<08:32,  9.66s/it]
Epoch 17 (train) - Loss: 0.048

 26%|█████████████████████████████▌                                                                                     | 18/70 [02:20<08:36,  9.94s/it]
Epoch 18 (train) - Loss: 0.048

 27%|███████████████████████████████▏                                                                                   | 19/70 [02:31<08:30, 10.00s/it]
Epoch 19 (train) - Loss: 0.047

 29%|████████████████████████████████▊                                                                                  | 20/70 [02:40<08:16,  9.92s/it]

 30%|██████████████████████████████████▌                                                                                | 21/70 [02:50<07:57,  9.74s/it]
Epoch 20 (test) - Accuracy: 0.913 - F1 score: 0.949
Epoch 21 (train) - Loss: 0.045

 31%|████████████████████████████████████▏                                                                              | 22/70 [02:58<07:32,  9.42s/it]
Epoch 22 (train) - Loss: 0.045

 33%|█████████████████████████████████████▊                                                                             | 23/70 [03:07<07:10,  9.16s/it]
Epoch 23 (train) - Loss: 0.045

 34%|███████████████████████████████████████▍                                                                           | 24/70 [03:16<07:03,  9.22s/it]
Epoch 24 (train) - Loss: 0.045

 36%|█████████████████████████████████████████                                                                          | 25/70 [03:26<07:06,  9.47s/it]
Epoch 25 (train) - Loss: 0.044

 37%|██████████████████████████████████████████▋                                                                        | 26/70 [03:36<07:00,  9.55s/it]

 39%|████████████████████████████████████████████▎                                                                      | 27/70 [03:45<06:48,  9.51s/it]
Epoch 26 (test) - Accuracy: 0.922 - F1 score: 0.954
Epoch 27 (train) - Loss: 0.044

 40%|██████████████████████████████████████████████                                                                     | 28/70 [03:55<06:40,  9.53s/it]
Epoch 28 (train) - Loss: 0.044

 41%|███████████████████████████████████████████████▋                                                                   | 29/70 [04:04<06:27,  9.45s/it]
Epoch 29 (train) - Loss: 0.043

 43%|█████████████████████████████████████████████████▎                                                                 | 30/70 [04:13<06:12,  9.32s/it]
Epoch 30 (train) - Loss: 0.044

 44%|██████████████████████████████████████████████████▉                                                                | 31/70 [04:23<06:05,  9.38s/it]
Epoch 31 (train) - Loss: 0.042

 46%|████████████████████████████████████████████████████▌                                                              | 32/70 [04:32<05:56,  9.37s/it]

 47%|██████████████████████████████████████████████████████▏                                                            | 33/70 [04:41<05:45,  9.33s/it]
Epoch 32 (test) - Accuracy: 0.923 - F1 score: 0.955
Epoch 33 (train) - Loss: 0.043

 49%|███████████████████████████████████████████████████████▊                                                           | 34/70 [04:50<05:29,  9.16s/it]
Epoch 34 (train) - Loss: 0.045

 50%|█████████████████████████████████████████████████████████▌                                                         | 35/70 [04:59<05:19,  9.12s/it]
Epoch 35 (train) - Loss: 0.043

 51%|███████████████████████████████████████████████████████████▏                                                       | 36/70 [05:08<05:10,  9.13s/it]
Epoch 36 (train) - Loss: 0.044

 53%|████████████████████████████████████████████████████████████▊                                                      | 37/70 [05:17<04:56,  9.00s/it]
Epoch 37 (train) - Loss: 0.043

 54%|██████████████████████████████████████████████████████████████▍                                                    | 38/70 [05:26<04:46,  8.96s/it]
Epoch 38 (train) - Loss: 0.042

 56%|████████████████████████████████████████████████████████████████                                                   | 39/70 [05:35<04:37,  8.95s/it]

 57%|█████████████████████████████████████████████████████████████████▋                                                 | 40/70 [05:44<04:27,  8.91s/it]

 59%|███████████████████████████████████████████████████████████████████▎                                               | 41/70 [05:52<04:12,  8.69s/it]
Epoch 40 (train) - Loss: 0.041
Epoch 40 (test) - Accuracy: 0.923 - F1 score: 0.955
Epoch 41 (train) - Loss: 0.042

 60%|█████████████████████████████████████████████████████████████████████                                              | 42/70 [06:01<04:05,  8.78s/it]
Epoch 42 (train) - Loss: 0.041

 61%|██████████████████████████████████████████████████████████████████████▋                                            | 43/70 [06:10<03:59,  8.89s/it]
Epoch 43 (train) - Loss: 0.042

 63%|████████████████████████████████████████████████████████████████████████▎                                          | 44/70 [06:19<03:48,  8.79s/it]
Epoch 44 (train) - Loss: 0.040

 64%|█████████████████████████████████████████████████████████████████████████▉                                         | 45/70 [06:26<03:31,  8.45s/it]
Epoch 45 (train) - Loss: 0.041

 66%|███████████████████████████████████████████████████████████████████████████▌                                       | 46/70 [06:34<03:20,  8.37s/it]
Epoch 46 (train) - Loss: 0.041

 67%|█████████████████████████████████████████████████████████████████████████████▏                                     | 47/70 [06:43<03:12,  8.38s/it]
Epoch 47 (train) - Loss: 0.040

 69%|██████████████████████████████████████████████████████████████████████████████▊                                    | 48/70 [06:50<02:59,  8.14s/it]
Epoch 48 (train) - Loss: 0.042

 70%|████████████████████████████████████████████████████████████████████████████████▌                                  | 49/70 [06:58<02:48,  8.03s/it]
Epoch 49 (train) - Loss: 0.041

 71%|██████████████████████████████████████████████████████████████████████████████████▏                                | 50/70 [07:07<02:44,  8.21s/it]
Epoch 50 (train) - Loss: 0.040

 73%|███████████████████████████████████████████████████████████████████████████████████▊                               | 51/70 [07:15<02:35,  8.19s/it]
Epoch 51 (train) - Loss: 0.040

 74%|█████████████████████████████████████████████████████████████████████████████████████▍                             | 52/70 [07:23<02:25,  8.09s/it]
Epoch 52 (train) - Loss: 0.040

 76%|███████████████████████████████████████████████████████████████████████████████████████                            | 53/70 [07:31<02:18,  8.16s/it]
Epoch 53 (train) - Loss: 0.040

 77%|████████████████████████████████████████████████████████████████████████████████████████▋                          | 54/70 [07:39<02:11,  8.19s/it]
Epoch 54 (train) - Loss: 0.041

 79%|██████████████████████████████████████████████████████████████████████████████████████████▎                        | 55/70 [07:47<02:02,  8.16s/it]

 80%|████████████████████████████████████████████████████████████████████████████████████████████                       | 56/70 [07:56<01:55,  8.26s/it]
Epoch 55 (test) - Accuracy: 0.923 - F1 score: 0.955
Epoch 56 (train) - Loss: 0.039

 81%|█████████████████████████████████████████████████████████████████████████████████████████████▋                     | 57/70 [08:04<01:47,  8.27s/it]
Epoch 57 (train) - Loss: 0.039

 83%|███████████████████████████████████████████████████████████████████████████████████████████████▎                   | 58/70 [08:13<01:40,  8.40s/it]
Epoch 58 (train) - Loss: 0.040

 84%|████████████████████████████████████████████████████████████████████████████████████████████████▉                  | 59/70 [08:21<01:31,  8.36s/it]
Epoch 59 (train) - Loss: 0.040

 86%|██████████████████████████████████████████████████████████████████████████████████████████████████▌                | 60/70 [08:29<01:23,  8.32s/it]
Epoch 60 (train) - Loss: 0.040

 87%|████████████████████████████████████████████████████████████████████████████████████████████████████▏              | 61/70 [08:39<01:16,  8.55s/it]
Epoch 61 (train) - Loss: 0.038

 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 62/70 [08:47<01:08,  8.57s/it]
Epoch 62 (train) - Loss: 0.039

 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 63/70 [08:55<00:59,  8.46s/it]

 91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▏         | 64/70 [09:04<00:50,  8.49s/it]
Epoch 63 (test) - Accuracy: 0.925 - F1 score: 0.956
Epoch 64 (train) - Loss: 0.039

 93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▊        | 65/70 [09:12<00:42,  8.44s/it]
Epoch 65 (train) - Loss: 0.039

 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▍      | 66/70 [09:20<00:33,  8.39s/it]
Epoch 66 (train) - Loss: 0.041

 96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████     | 67/70 [09:29<00:25,  8.38s/it]
Epoch 67 (train) - Loss: 0.040

 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋   | 68/70 [09:37<00:16,  8.27s/it]
Epoch 68 (train) - Loss: 0.039

 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎ | 69/70 [09:46<00:08,  8.40s/it]
Epoch 69 (train) - Loss: 0.038
Epoch 69 (test) - Accuracy: 0.921 - F1 score: 0.954
Plotting the results...
Saving the plot as 'results_ftt_model_2_raw.png'...
Saving the model as 'ftt_model_2_raw'...

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [09:55<00:00,  8.50s/it]
Done!