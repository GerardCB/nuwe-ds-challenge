[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'learning_rate' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_epochs' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'hidden_size' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_layers' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'dropout' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'weight_decay' was locked by 'sweep' (ignored update).
  0%|                                                                                              | 0/70 [00:00<?, ?it/s]
Creating dataset...
Loading data from /home/usuaris/veu/gerard.calvo.bartra/nuwe/model/../data/supply_chain_train_balanced.csv
Train batch 0:
{'data': tensor([[ 0.1719, -0.4065, -0.5574,  ...,  0.0000,  0.0000,  0.0000],
        [-1.7650,  0.6141,  0.3519,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.8175, -0.4065, -0.5574,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [ 0.8175,  0.6141,  1.2611,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.8175,  0.6141,  0.3519,  ...,  0.0000,  0.0000,  0.0000],
        [ 1.4631, -0.4065,  0.3519,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1,
        1, 0, 0, 1, 1, 0, 1, 1])}
Validation batch 0:
{'data': tensor([[-1.1402,  0.6459, -1.3412,  ...,  0.0000,  0.0000,  0.0000],
        [-0.4862, -0.3693,  1.1670,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.1677, -0.3693, -1.3412,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-1.1402,  0.6459,  2.0031,  ...,  0.0000,  0.0000,  0.0000],
        [-0.4862,  0.6459, -0.5051,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.1677, -0.3693,  1.1670,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1,
        1, 0, 1, 1, 1, 0, 0, 1])}
batch_data.shape: torch.Size([32, 32])
Percentage of positive and negative samples in the training set:
1    0.644696
0    0.355304
Name: Attrition_Flag, dtype: float64
BaselineNet(
  (fc): Sequential(
    (fc0): Linear(in_features=32, out_features=256, bias=True)
    (relu0): ReLU()
    (dropout0): Dropout(p=0.09362569749112357, inplace=False)
    (fc1): Linear(in_features=256, out_features=256, bias=True)
    (relu1): ReLU()
    (dropout1): Dropout(p=0.09362569749112357, inplace=False)
    (fc2): Linear(in_features=256, out_features=256, bias=True)
    (relu2): ReLU()
    (dropout2): Dropout(p=0.09362569749112357, inplace=False)
    (fc3): Linear(in_features=256, out_features=256, bias=True)
    (relu3): ReLU()
    (dropout3): Dropout(p=0.09362569749112357, inplace=False)
    (fc4): Linear(in_features=256, out_features=256, bias=True)
    (relu4): ReLU()
    (dropout4): Dropout(p=0.09362569749112357, inplace=False)
    (fc5): Linear(in_features=256, out_features=1, bias=True)
    (sigmoid): Sigmoid()
  )
)
Num params:  271873
Training the model...
Epoch 0 (train) - Loss: 0.398


  3%|██▍                                                                                   | 2/70 [00:05<03:14,  2.86s/it]
Epoch 1 (train) - Loss: 0.305
EPOCH 1 (test) - Accuracy: 0.893 - F1 score: 0.918
Epoch 2 (train) - Loss: 0.273

  4%|███▋                                                                                  | 3/70 [00:08<03:06,  2.78s/it]
Epoch 3 (train) - Loss: 0.255


  7%|██████▏                                                                               | 5/70 [00:13<02:56,  2.71s/it]
Epoch 4 (train) - Loss: 0.233
EPOCH 4 (test) - Accuracy: 0.894 - F1 score: 0.919
Epoch 5 (train) - Loss: 0.226

  9%|███████▎                                                                              | 6/70 [00:16<02:53,  2.72s/it]
Epoch 6 (train) - Loss: 0.210


 11%|█████████▊                                                                            | 8/70 [00:21<02:47,  2.69s/it]
Epoch 7 (train) - Loss: 0.222
EPOCH 7 (test) - Accuracy: 0.917 - F1 score: 0.937
Epoch 8 (train) - Loss: 0.197

 13%|███████████                                                                           | 9/70 [00:24<02:51,  2.81s/it]
Epoch 9 (train) - Loss: 0.197

 14%|████████████▏                                                                        | 10/70 [00:27<02:44,  2.75s/it]
Epoch 10 (train) - Loss: 0.174

 16%|█████████████▎                                                                       | 11/70 [00:30<02:43,  2.78s/it]
Epoch 11 (train) - Loss: 0.172


 19%|███████████████▊                                                                     | 13/70 [00:40<03:49,  4.02s/it]
Epoch 12 (train) - Loss: 0.164
EPOCH 12 (test) - Accuracy: 0.912 - F1 score: 0.931

 20%|█████████████████                                                                    | 14/70 [00:43<03:39,  3.91s/it]
EPOCH 13 (test) - Accuracy: 0.905 - F1 score: 0.923

 21%|██████████████████▏                                                                  | 15/70 [00:47<03:38,  3.97s/it]
EPOCH 14 (test) - Accuracy: 0.923 - F1 score: 0.940
Epoch 15 (train) - Loss: 0.140

 23%|███████████████████▍                                                                 | 16/70 [00:55<04:26,  4.93s/it]
Epoch 16 (train) - Loss: 0.140

 24%|████████████████████▋                                                                | 17/70 [00:58<03:58,  4.51s/it]
Epoch 17 (train) - Loss: 0.137

 26%|█████████████████████▊                                                               | 18/70 [01:04<04:21,  5.03s/it]
Epoch 18 (train) - Loss: 0.114

 27%|███████████████████████                                                              | 19/70 [01:08<03:59,  4.69s/it]
Epoch 19 (train) - Loss: 0.120

 29%|████████████████████████▎                                                            | 20/70 [01:12<03:41,  4.43s/it]
Epoch 20 (train) - Loss: 0.114


 31%|██████████████████████████▋                                                          | 22/70 [01:20<03:18,  4.13s/it]
Epoch 21 (train) - Loss: 0.111
EPOCH 21 (test) - Accuracy: 0.928 - F1 score: 0.944
Epoch 22 (train) - Loss: 0.109

 33%|███████████████████████████▉                                                         | 23/70 [01:35<05:47,  7.38s/it]
Epoch 23 (train) - Loss: 0.109

 34%|█████████████████████████████▏                                                       | 24/70 [01:42<05:46,  7.52s/it]
Epoch 24 (train) - Loss: 0.104

 36%|██████████████████████████████▎                                                      | 25/70 [01:46<04:50,  6.46s/it]
Epoch 25 (train) - Loss: 0.097

 37%|███████████████████████████████▌                                                     | 26/70 [01:50<04:12,  5.73s/it]
Epoch 26 (train) - Loss: 0.095

 39%|████████████████████████████████▊                                                    | 27/70 [01:54<03:42,  5.18s/it]
Epoch 27 (train) - Loss: 0.091

 40%|██████████████████████████████████                                                   | 28/70 [01:58<03:23,  4.84s/it]
Epoch 28 (train) - Loss: 0.093

 41%|███████████████████████████████████▏                                                 | 29/70 [02:02<03:06,  4.54s/it]
Epoch 29 (train) - Loss: 0.103


 44%|█████████████████████████████████████▋                                               | 31/70 [02:10<02:40,  4.12s/it]
Epoch 30 (train) - Loss: 0.087

 46%|██████████████████████████████████████▊                                              | 32/70 [02:14<02:34,  4.05s/it]
Epoch 31 (train) - Loss: 0.081

 47%|████████████████████████████████████████                                             | 33/70 [02:18<02:28,  4.02s/it]
Epoch 32 (train) - Loss: 0.090

 49%|█████████████████████████████████████████▎                                           | 34/70 [02:22<02:25,  4.03s/it]
Epoch 33 (train) - Loss: 0.082

 50%|██████████████████████████████████████████▌                                          | 35/70 [02:26<02:20,  4.02s/it]
Epoch 34 (train) - Loss: 0.076
EPOCH 34 (test) - Accuracy: 0.917 - F1 score: 0.935

 51%|███████████████████████████████████████████▋                                         | 36/70 [02:29<02:14,  3.97s/it]
EPOCH 35 (test) - Accuracy: 0.920 - F1 score: 0.935

 53%|████████████████████████████████████████████▉                                        | 37/70 [02:33<02:10,  3.95s/it]
EPOCH 36 (test) - Accuracy: 0.917 - F1 score: 0.936

 54%|██████████████████████████████████████████████▏                                      | 38/70 [02:37<02:06,  3.95s/it]
EPOCH 37 (test) - Accuracy: 0.918 - F1 score: 0.937

 56%|███████████████████████████████████████████████▎                                     | 39/70 [02:41<02:03,  3.98s/it]
EPOCH 38 (test) - Accuracy: 0.923 - F1 score: 0.940

 57%|████████████████████████████████████████████████▌                                    | 40/70 [02:45<01:58,  3.96s/it]
EPOCH 39 (test) - Accuracy: 0.917 - F1 score: 0.934
Epoch 40 (train) - Loss: 0.074

 59%|█████████████████████████████████████████████████▊                                   | 41/70 [02:49<01:51,  3.85s/it]
Epoch 41 (train) - Loss: 0.060

 60%|███████████████████████████████████████████████████                                  | 42/70 [02:53<01:45,  3.79s/it]
Epoch 42 (train) - Loss: 0.065

 61%|████████████████████████████████████████████████████▏                                | 43/70 [02:56<01:43,  3.83s/it]
Epoch 43 (train) - Loss: 0.074

 63%|█████████████████████████████████████████████████████▍                               | 44/70 [03:00<01:40,  3.88s/it]
Epoch 44 (train) - Loss: 0.064

 64%|██████████████████████████████████████████████████████▋                              | 45/70 [03:04<01:35,  3.80s/it]
Epoch 45 (train) - Loss: 0.073


 67%|█████████████████████████████████████████████████████████                            | 47/70 [03:12<01:27,  3.79s/it]
Epoch 46 (train) - Loss: 0.064
EPOCH 46 (test) - Accuracy: 0.917 - F1 score: 0.934

 69%|██████████████████████████████████████████████████████████▎                          | 48/70 [03:15<01:23,  3.77s/it]
EPOCH 47 (test) - Accuracy: 0.921 - F1 score: 0.939
Epoch 48 (train) - Loss: 0.065

 70%|███████████████████████████████████████████████████████████▍                         | 49/70 [03:19<01:19,  3.80s/it]
Epoch 49 (train) - Loss: 0.070

 71%|████████████████████████████████████████████████████████████▋                        | 50/70 [03:23<01:16,  3.81s/it]
Epoch 50 (train) - Loss: 0.061

 73%|█████████████████████████████████████████████████████████████▉                       | 51/70 [03:27<01:12,  3.81s/it]
Epoch 51 (train) - Loss: 0.058

 74%|███████████████████████████████████████████████████████████████▏                     | 52/70 [03:31<01:08,  3.80s/it]
Epoch 52 (train) - Loss: 0.072

 76%|████████████████████████████████████████████████████████████████▎                    | 53/70 [03:34<01:04,  3.79s/it]
Epoch 53 (train) - Loss: 0.061

 77%|█████████████████████████████████████████████████████████████████▌                   | 54/70 [03:38<01:01,  3.84s/it]
Epoch 54 (train) - Loss: 0.083

 79%|██████████████████████████████████████████████████████████████████▊                  | 55/70 [03:42<00:58,  3.88s/it]
Epoch 55 (train) - Loss: 0.079

 80%|████████████████████████████████████████████████████████████████████                 | 56/70 [03:46<00:54,  3.91s/it]
Epoch 56 (train) - Loss: 0.059

 81%|█████████████████████████████████████████████████████████████████████▏               | 57/70 [03:50<00:49,  3.82s/it]
Epoch 57 (train) - Loss: 0.068

 83%|██████████████████████████████████████████████████████████████████████▍              | 58/70 [03:54<00:46,  3.88s/it]
Epoch 58 (train) - Loss: 0.085

 84%|███████████████████████████████████████████████████████████████████████▋             | 59/70 [04:13<01:32,  8.39s/it]

 86%|████████████████████████████████████████████████████████████████████████▊            | 60/70 [04:24<01:30,  9.09s/it]
EPOCH 59 (test) - Accuracy: 0.909 - F1 score: 0.929

 87%|██████████████████████████████████████████████████████████████████████████           | 61/70 [04:28<01:07,  7.55s/it]

 89%|███████████████████████████████████████████████████████████████████████████▎         | 62/70 [04:32<00:52,  6.53s/it]
Epoch 61 (train) - Loss: 0.054
EPOCH 61 (test) - Accuracy: 0.917 - F1 score: 0.935
Epoch 62 (train) - Loss: 0.062


 91%|█████████████████████████████████████████████████████████████████████████████▋       | 64/70 [04:48<00:41,  6.92s/it]
Epoch 63 (train) - Loss: 0.061

 93%|██████████████████████████████████████████████████████████████████████████████▉      | 65/70 [04:52<00:30,  6.00s/it]
Epoch 64 (train) - Loss: 0.060
EPOCH 64 (test) - Accuracy: 0.918 - F1 score: 0.936

 94%|████████████████████████████████████████████████████████████████████████████████▏    | 66/70 [04:56<00:21,  5.37s/it]
EPOCH 65 (test) - Accuracy: 0.917 - F1 score: 0.936

 96%|█████████████████████████████████████████████████████████████████████████████████▎   | 67/70 [04:59<00:14,  4.92s/it]
EPOCH 66 (test) - Accuracy: 0.912 - F1 score: 0.930
Epoch 67 (train) - Loss: 0.070

 97%|██████████████████████████████████████████████████████████████████████████████████▌  | 68/70 [05:03<00:09,  4.61s/it]
Epoch 68 (train) - Loss: 0.082

 99%|███████████████████████████████████████████████████████████████████████████████████▊ | 69/70 [05:07<00:04,  4.44s/it]

100%|█████████████████████████████████████████████████████████████████████████████████████| 70/70 [05:12<00:00,  4.46s/it]
EPOCH 69 (test) - Accuracy: 0.901 - F1 score: 0.925
Plotting the results...
Saving the plot as 'results_baseline_model_2_balanced.png'...
Saving the model as 'baseline_model_2_balanced'...
Generating the test.json file...
Done!