[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'learning_rate' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_epochs' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'hidden_size' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_layers' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'dropout' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'weight_decay' was locked by 'sweep' (ignored update).
  0%|                                                                                              | 0/50 [00:00<?, ?it/s]
Creating dataset...
Loading data from /home/usuaris/veu/gerard.calvo.bartra/nuwe/model/../data/supply_chain_train_balanced.csv
Train batch 0:
{'data': tensor([[-1.1194, -1.4270, -0.5574,  ...,  0.0000,  0.0000,  0.0000],
        [ 1.4631, -0.4065, -0.5574,  ...,  0.0000,  0.0000,  0.0000],
        [ 1.4631, -1.4270, -2.3759,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [ 0.8175,  0.6141,  0.3519,  ...,  0.0000,  0.0000,  0.0000],
        [-1.1194, -0.4065, -1.4666,  ...,  0.0000,  0.0000,  1.0000],
        [-1.7650,  1.6346,  0.3519,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0,
        0, 1, 0, 1, 1, 0, 1, 0])}
Validation batch 0:
{'data': tensor([[-1.1402,  0.6459, -1.3412,  ...,  0.0000,  0.0000,  0.0000],
        [-0.4862, -0.3693,  1.1670,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.1677, -0.3693, -1.3412,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-1.1402,  0.6459,  2.0031,  ...,  0.0000,  0.0000,  0.0000],
        [-0.4862,  0.6459, -0.5051,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.1677, -0.3693,  1.1670,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1,
        1, 0, 1, 1, 1, 0, 0, 1])}
batch_data.shape: torch.Size([32, 32])
Percentage of positive and negative samples in the training set:
1    0.644696
0    0.355304
Name: Attrition_Flag, dtype: float64
BaselineNet(
  (fc): Sequential(
    (fc0): Linear(in_features=32, out_features=512, bias=True)
    (relu0): ReLU()
    (dropout0): Dropout(p=0.3121216844375423, inplace=False)
    (fc1): Linear(in_features=512, out_features=512, bias=True)
    (relu1): ReLU()
    (dropout1): Dropout(p=0.3121216844375423, inplace=False)
    (fc2): Linear(in_features=512, out_features=512, bias=True)
    (relu2): ReLU()
    (dropout2): Dropout(p=0.3121216844375423, inplace=False)
    (fc3): Linear(in_features=512, out_features=512, bias=True)
    (relu3): ReLU()
    (dropout3): Dropout(p=0.3121216844375423, inplace=False)
    (fc4): Linear(in_features=512, out_features=512, bias=True)
    (relu4): ReLU()
    (dropout4): Dropout(p=0.3121216844375423, inplace=False)
    (fc5): Linear(in_features=512, out_features=1, bias=True)
    (sigmoid): Sigmoid()
  )
)
Num params:  1068033

  2%|█▋                                                                                    | 1/50 [00:02<02:26,  2.99s/it]
Epoch 0 (train) - Loss: 0.442

  4%|███▍                                                                                  | 2/50 [00:06<02:41,  3.37s/it]
Epoch 1 (train) - Loss: 0.368

  6%|█████▏                                                                                | 3/50 [00:09<02:34,  3.28s/it]
Epoch 2 (train) - Loss: 0.385
EPOCH 2 (test) - Accuracy: 0.859 - F1 score: 0.894
Epoch 3 (train) - Loss: 0.385


 10%|████████▌                                                                             | 5/50 [00:15<02:20,  3.12s/it]
Epoch 4 (train) - Loss: 0.420

 12%|██████████▎                                                                           | 6/50 [00:18<02:13,  3.02s/it]
Epoch 5 (train) - Loss: 0.342
EPOCH 5 (test) - Accuracy: 0.869 - F1 score: 0.894
Epoch 6 (train) - Loss: 0.391

 14%|████████████                                                                          | 7/50 [00:22<02:15,  3.16s/it]
Epoch 7 (train) - Loss: 0.343

 16%|█████████████▊                                                                        | 8/50 [00:24<02:09,  3.07s/it]
Epoch 8 (train) - Loss: 0.348


 20%|█████████████████                                                                    | 10/50 [00:32<02:13,  3.33s/it]
Epoch 9 (train) - Loss: 0.344
EPOCH 9 (test) - Accuracy: 0.869 - F1 score: 0.900
Epoch 10 (train) - Loss: 0.390


 24%|████████████████████▍                                                                | 12/50 [00:49<03:56,  6.21s/it]
Epoch 11 (train) - Loss: 0.343

 26%|██████████████████████                                                               | 13/50 [00:54<03:25,  5.56s/it]
Epoch 12 (train) - Loss: 0.309
EPOCH 12 (test) - Accuracy: 0.841 - F1 score: 0.870
Epoch 13 (train) - Loss: 0.329

 28%|███████████████████████▊                                                             | 14/50 [00:58<03:06,  5.18s/it]
Epoch 14 (train) - Loss: 0.327

 30%|█████████████████████████▌                                                           | 15/50 [01:02<02:51,  4.91s/it]
Epoch 15 (train) - Loss: 0.348

 32%|███████████████████████████▏                                                         | 16/50 [01:06<02:41,  4.74s/it]
Epoch 16 (train) - Loss: 0.355

 34%|████████████████████████████▉                                                        | 17/50 [01:11<02:34,  4.67s/it]

 36%|██████████████████████████████▌                                                      | 18/50 [01:15<02:25,  4.56s/it]
EPOCH 17 (test) - Accuracy: 0.896 - F1 score: 0.919
Epoch 18 (train) - Loss: 0.463

 38%|████████████████████████████████▎                                                    | 19/50 [01:20<02:25,  4.69s/it]
Epoch 19 (train) - Loss: 0.455

 40%|██████████████████████████████████                                                   | 20/50 [01:24<02:15,  4.52s/it]
Epoch 20 (train) - Loss: 0.335

 42%|███████████████████████████████████▋                                                 | 21/50 [01:29<02:11,  4.53s/it]

 44%|█████████████████████████████████████▍                                               | 22/50 [01:33<02:05,  4.49s/it]

 46%|███████████████████████████████████████                                              | 23/50 [01:38<01:59,  4.43s/it]
Epoch 22 (train) - Loss: 0.306
EPOCH 22 (test) - Accuracy: 0.862 - F1 score: 0.890
Epoch 23 (train) - Loss: 0.452

 48%|████████████████████████████████████████▊                                            | 24/50 [01:42<01:54,  4.39s/it]
Epoch 24 (train) - Loss: 0.356

 50%|██████████████████████████████████████████▌                                          | 25/50 [01:46<01:48,  4.36s/it]
Epoch 25 (train) - Loss: 0.618

 52%|████████████████████████████████████████████▏                                        | 26/50 [01:51<01:47,  4.49s/it]

 54%|█████████████████████████████████████████████▉                                       | 27/50 [01:55<01:42,  4.45s/it]

 56%|███████████████████████████████████████████████▌                                     | 28/50 [02:00<01:36,  4.41s/it]
Epoch 27 (train) - Loss: 0.393
EPOCH 27 (test) - Accuracy: 0.853 - F1 score: 0.892
Epoch 28 (train) - Loss: 0.577

 58%|█████████████████████████████████████████████████▎                                   | 29/50 [02:04<01:31,  4.36s/it]
Epoch 29 (train) - Loss: 0.524

 60%|███████████████████████████████████████████████████                                  | 30/50 [02:08<01:27,  4.36s/it]
Epoch 30 (train) - Loss: 0.496

 62%|████████████████████████████████████████████████████▋                                | 31/50 [02:13<01:25,  4.51s/it]

 64%|██████████████████████████████████████████████████████▍                              | 32/50 [02:17<01:19,  4.44s/it]
EPOCH 31 (test) - Accuracy: 0.851 - F1 score: 0.882
Epoch 32 (train) - Loss: 0.424

 66%|████████████████████████████████████████████████████████                             | 33/50 [02:22<01:14,  4.37s/it]
Epoch 33 (train) - Loss: 0.495

 68%|█████████████████████████████████████████████████████████▊                           | 34/50 [02:26<01:09,  4.31s/it]
Epoch 34 (train) - Loss: 0.396

 70%|███████████████████████████████████████████████████████████▍                         | 35/50 [02:30<01:04,  4.30s/it]
Epoch 35 (train) - Loss: 0.488

 72%|█████████████████████████████████████████████████████████████▏                       | 36/50 [02:34<01:00,  4.29s/it]
Epoch 36 (train) - Loss: 0.612

 74%|██████████████████████████████████████████████████████████████▉                      | 37/50 [02:38<00:54,  4.22s/it]
Epoch 37 (train) - Loss: 0.382

 76%|████████████████████████████████████████████████████████████████▌                    | 38/50 [02:43<00:50,  4.23s/it]
Epoch 38 (train) - Loss: 0.530

 78%|██████████████████████████████████████████████████████████████████▎                  | 39/50 [02:47<00:46,  4.26s/it]
Epoch 39 (train) - Loss: 0.512

 80%|████████████████████████████████████████████████████████████████████                 | 40/50 [02:51<00:41,  4.12s/it]
Epoch 40 (train) - Loss: 0.317

 82%|█████████████████████████████████████████████████████████████████████▋               | 41/50 [02:55<00:37,  4.15s/it]

 84%|███████████████████████████████████████████████████████████████████████▍             | 42/50 [03:00<00:33,  4.25s/it]

 86%|█████████████████████████████████████████████████████████████████████████            | 43/50 [03:04<00:29,  4.23s/it]
Epoch 42 (train) - Loss: 0.661
EPOCH 42 (test) - Accuracy: 0.846 - F1 score: 0.878
Epoch 43 (train) - Loss: 0.979

 88%|██████████████████████████████████████████████████████████████████████████▊          | 44/50 [03:08<00:25,  4.20s/it]
Epoch 44 (train) - Loss: 0.581

 90%|████████████████████████████████████████████████████████████████████████████▌        | 45/50 [03:12<00:21,  4.23s/it]
Epoch 45 (train) - Loss: 0.871

 92%|██████████████████████████████████████████████████████████████████████████████▏      | 46/50 [03:16<00:16,  4.22s/it]
Epoch 46 (train) - Loss: 0.821

 94%|███████████████████████████████████████████████████████████████████████████████▉     | 47/50 [03:20<00:12,  4.20s/it]
Epoch 47 (train) - Loss: 1.075

 96%|█████████████████████████████████████████████████████████████████████████████████▌   | 48/50 [03:25<00:08,  4.29s/it]
Epoch 48 (train) - Loss: 0.504

 98%|███████████████████████████████████████████████████████████████████████████████████▎ | 49/50 [03:29<00:04,  4.28s/it]

100%|█████████████████████████████████████████████████████████████████████████████████████| 50/50 [03:33<00:00,  4.28s/it]
EPOCH 49 (test) - Accuracy: 0.792 - F1 score: 0.825
Plotting the results...
Saving the plot as 'results_baseline_model_2_balanced.png'...
Saving the model as 'baseline_model_2_balanced'...
Generating the test.json file...
Done!