[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'learning_rate' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_epochs' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'weight_decay' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'depth' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'heads' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'attn_dropout' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'dim_ff' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'd_model' was locked by 'sweep' (ignored update).
  0%|                                                                                                                            | 0/90 [00:00<?, ?it/s]
Creating dataset...
Loading data from /home/usuaris/veu/gerard.calvo.bartra/nuwe/model/../data/supply_chain_train_raw.csv
Train batch 0:
{'data': tensor([[ 0.4649,  0.9466, -1.0240,  ...,  0.0000,  0.0000,  1.0000],
        [-0.8001, -1.0443, -1.0240,  ...,  0.0000,  0.0000,  0.0000],
        [-0.8193, -0.7954,  1.2890,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [ 1.5364,  0.8221, -1.0240,  ...,  0.0000,  0.0000,  0.0000],
        [ 1.3564, -0.7954,  0.5180,  ...,  0.0000,  0.0000,  0.0000],
        [-0.5070, -2.1641, -1.0240,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1,
        1, 1, 0, 1, 1, 1, 1, 1])}
Validation batch 0:
{'data': tensor([[-0.7021, -0.9862, -0.2985,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7690,  0.4015,  2.1085,  ...,  0.0000,  0.0000,  1.0000],
        [-0.7355,  0.0231, -1.1008,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-0.7259,  0.1492, -0.2985,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.4713,  0.5277,  2.1085,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7987, -0.2293,  0.5039,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 0, 1, 1])}
batch_data.shape: torch.Size([32, 38])
Percentage of positive and negative samples in the training set:
1    0.839094
0    0.160906
Name: Attrition_Flag, dtype: float64
FTTransformer(
  (numerical_embedder): NumericalEmbedder(
    (linear): Linear(in_features=38, out_features=32, bias=True)
  )
  (layers): ModuleList(
    (0): ModuleList(
      (0): Attention(
        (norm): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
        (to_qkv): Linear(in_features=32, out_features=96, bias=False)
        (to_out): Linear(in_features=32, out_features=32, bias=False)
        (dropout): Dropout(p=0.06727068150433102, inplace=False)
      )
      (1): Sequential(
        (0): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
        (1): Linear(in_features=32, out_features=128, bias=True)
        (2): GEGLU()
        (3): Dropout(p=0.06727068150433102, inplace=False)
        (4): Linear(in_features=64, out_features=32, bias=True)
      )
    )
  )
  (to_logits): Sequential(
    (0): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
    (1): ReLU()
    (2): Linear(in_features=32, out_features=1, bias=True)
    (3): Sigmoid()
  )
)
Num params:  11873

  1%|█▎                                                                                                                  | 1/90 [00:03<04:36,  3.11s/it]
Epoch 0 (train) - Loss: 0.093

  2%|██▌                                                                                                                 | 2/90 [00:05<03:57,  2.70s/it]
Epoch 1 (train) - Loss: 0.074

  3%|███▊                                                                                                                | 3/90 [00:08<03:57,  2.73s/it]
Epoch 2 (train) - Loss: 0.072

  4%|█████▏                                                                                                              | 4/90 [00:11<03:54,  2.73s/it]
Epoch 3 (train) - Loss: 0.070

  6%|██████▍                                                                                                             | 5/90 [00:13<03:47,  2.67s/it]
Epoch 4 (train) - Loss: 0.066

  7%|███████▋                                                                                                            | 6/90 [00:16<03:42,  2.65s/it]
Epoch 5 (train) - Loss: 0.068

  8%|█████████                                                                                                           | 7/90 [00:18<03:43,  2.69s/it]
Epoch 6 (train) - Loss: 0.063

  9%|██████████▎                                                                                                         | 8/90 [00:21<03:35,  2.63s/it]
Epoch 7 (train) - Loss: 0.063

 10%|███████████▌                                                                                                        | 9/90 [00:24<03:39,  2.70s/it]
Epoch 8 (train) - Loss: 0.062

 11%|████████████▊                                                                                                      | 10/90 [00:27<03:48,  2.85s/it]
Epoch 9 (train) - Loss: 0.059

 12%|██████████████                                                                                                     | 11/90 [00:30<03:41,  2.80s/it]
Epoch 10 (train) - Loss: 0.061

 13%|███████████████▎                                                                                                   | 12/90 [00:32<03:37,  2.79s/it]
Epoch 11 (train) - Loss: 0.059
Epoch 11 (test) - Accuracy: 0.904 - F1 score: 0.945

 14%|████████████████▌                                                                                                  | 13/90 [00:35<03:31,  2.74s/it]

 16%|█████████████████▉                                                                                                 | 14/90 [00:38<03:25,  2.70s/it]
Epoch 13 (train) - Loss: 0.062

 17%|███████████████████▏                                                                                               | 15/90 [00:41<03:26,  2.76s/it]
Epoch 14 (train) - Loss: 0.062
Epoch 14 (test) - Accuracy: 0.905 - F1 score: 0.946

 18%|████████████████████▍                                                                                              | 16/90 [00:43<03:20,  2.71s/it]

 19%|█████████████████████▋                                                                                             | 17/90 [00:46<03:14,  2.67s/it]
Epoch 16 (train) - Loss: 0.060

 20%|███████████████████████                                                                                            | 18/90 [00:49<03:18,  2.76s/it]
Epoch 17 (train) - Loss: 0.059
Epoch 17 (test) - Accuracy: 0.906 - F1 score: 0.946
Epoch 18 (train) - Loss: 0.058

 21%|████████████████████████▎                                                                                          | 19/90 [00:52<03:21,  2.84s/it]
Epoch 19 (train) - Loss: 0.059

 22%|█████████████████████████▌                                                                                         | 20/90 [00:54<03:11,  2.74s/it]
Epoch 20 (train) - Loss: 0.059

 23%|██████████████████████████▊                                                                                        | 21/90 [00:57<03:16,  2.85s/it]
Epoch 21 (train) - Loss: 0.058

 24%|████████████████████████████                                                                                       | 22/90 [01:00<03:09,  2.79s/it]
Epoch 22 (train) - Loss: 0.060

 26%|█████████████████████████████▍                                                                                     | 23/90 [01:03<03:08,  2.81s/it]
Epoch 23 (train) - Loss: 0.058

 27%|██████████████████████████████▋                                                                                    | 24/90 [01:06<03:01,  2.76s/it]
Epoch 24 (train) - Loss: 0.055

 28%|███████████████████████████████▉                                                                                   | 25/90 [01:08<03:02,  2.80s/it]
Epoch 25 (train) - Loss: 0.058

 29%|█████████████████████████████████▏                                                                                 | 26/90 [01:11<02:55,  2.74s/it]
Epoch 26 (train) - Loss: 0.055

 30%|██████████████████████████████████▌                                                                                | 27/90 [01:14<03:02,  2.89s/it]
Epoch 27 (train) - Loss: 0.057

 31%|███████████████████████████████████▊                                                                               | 28/90 [01:17<02:56,  2.84s/it]
Epoch 28 (train) - Loss: 0.055

 32%|█████████████████████████████████████                                                                              | 29/90 [01:20<02:59,  2.94s/it]
Epoch 29 (train) - Loss: 0.052

 33%|██████████████████████████████████████▎                                                                            | 30/90 [01:23<02:49,  2.82s/it]
Epoch 30 (train) - Loss: 0.051

 34%|███████████████████████████████████████▌                                                                           | 31/90 [01:25<02:43,  2.78s/it]
Epoch 31 (train) - Loss: 0.052

 36%|████████████████████████████████████████▉                                                                          | 32/90 [01:29<02:47,  2.89s/it]
Epoch 32 (train) - Loss: 0.051

 37%|██████████████████████████████████████████▏                                                                        | 33/90 [01:31<02:42,  2.84s/it]
Epoch 33 (train) - Loss: 0.052

 38%|███████████████████████████████████████████▍                                                                       | 34/90 [01:34<02:41,  2.89s/it]
Epoch 34 (train) - Loss: 0.049

 39%|████████████████████████████████████████████▋                                                                      | 35/90 [01:37<02:35,  2.83s/it]
Epoch 35 (train) - Loss: 0.049

 40%|██████████████████████████████████████████████                                                                     | 36/90 [01:40<02:37,  2.92s/it]
Epoch 36 (train) - Loss: 0.050

 41%|███████████████████████████████████████████████▎                                                                   | 37/90 [01:43<02:30,  2.85s/it]
Epoch 37 (train) - Loss: 0.049

 42%|████████████████████████████████████████████████▌                                                                  | 38/90 [01:45<02:24,  2.79s/it]
Epoch 38 (train) - Loss: 0.048

 43%|█████████████████████████████████████████████████▊                                                                 | 39/90 [01:48<02:20,  2.75s/it]
Epoch 39 (train) - Loss: 0.051

 44%|███████████████████████████████████████████████████                                                                | 40/90 [01:51<02:16,  2.73s/it]
Epoch 40 (train) - Loss: 0.050

 46%|████████████████████████████████████████████████████▍                                                              | 41/90 [01:54<02:17,  2.80s/it]
Epoch 41 (train) - Loss: 0.048

 47%|█████████████████████████████████████████████████████▋                                                             | 42/90 [01:56<02:10,  2.71s/it]
Epoch 42 (train) - Loss: 0.049

 48%|██████████████████████████████████████████████████████▉                                                            | 43/90 [01:59<02:10,  2.78s/it]
Epoch 43 (train) - Loss: 0.046

 49%|████████████████████████████████████████████████████████▏                                                          | 44/90 [02:02<02:07,  2.76s/it]
Epoch 44 (train) - Loss: 0.046

 50%|█████████████████████████████████████████████████████████▌                                                         | 45/90 [02:05<02:06,  2.81s/it]
Epoch 45 (train) - Loss: 0.046

 51%|██████████████████████████████████████████████████████████▊                                                        | 46/90 [02:08<02:05,  2.86s/it]
Epoch 46 (train) - Loss: 0.046

 52%|████████████████████████████████████████████████████████████                                                       | 47/90 [02:11<02:03,  2.87s/it]
Epoch 47 (train) - Loss: 0.047

 53%|█████████████████████████████████████████████████████████████▎                                                     | 48/90 [02:13<01:55,  2.75s/it]
Epoch 48 (train) - Loss: 0.048

 54%|██████████████████████████████████████████████████████████████▌                                                    | 49/90 [02:16<01:56,  2.85s/it]
Epoch 49 (train) - Loss: 0.044

 56%|███████████████████████████████████████████████████████████████▉                                                   | 50/90 [02:19<01:51,  2.78s/it]
Epoch 50 (train) - Loss: 0.043

 57%|█████████████████████████████████████████████████████████████████▏                                                 | 51/90 [02:22<01:48,  2.77s/it]
Epoch 51 (train) - Loss: 0.044

 58%|██████████████████████████████████████████████████████████████████▍                                                | 52/90 [02:24<01:45,  2.77s/it]
Epoch 52 (train) - Loss: 0.045

 59%|███████████████████████████████████████████████████████████████████▋                                               | 53/90 [02:27<01:41,  2.75s/it]
Epoch 53 (train) - Loss: 0.044

 60%|█████████████████████████████████████████████████████████████████████                                              | 54/90 [02:30<01:41,  2.82s/it]
Epoch 54 (train) - Loss: 0.044

 61%|██████████████████████████████████████████████████████████████████████▎                                            | 55/90 [02:33<01:36,  2.77s/it]
Epoch 55 (train) - Loss: 0.043

 62%|███████████████████████████████████████████████████████████████████████▌                                           | 56/90 [02:36<01:37,  2.85s/it]
Epoch 56 (train) - Loss: 0.044

 63%|████████████████████████████████████████████████████████████████████████▊                                          | 57/90 [02:39<01:35,  2.90s/it]
Epoch 57 (train) - Loss: 0.044

 64%|██████████████████████████████████████████████████████████████████████████                                         | 58/90 [02:41<01:29,  2.81s/it]
Epoch 58 (train) - Loss: 0.045

 66%|███████████████████████████████████████████████████████████████████████████▍                                       | 59/90 [02:44<01:28,  2.86s/it]
Epoch 59 (train) - Loss: 0.045

 67%|████████████████████████████████████████████████████████████████████████████▋                                      | 60/90 [02:47<01:23,  2.78s/it]
Epoch 60 (train) - Loss: 0.043

 68%|█████████████████████████████████████████████████████████████████████████████▉                                     | 61/90 [02:49<01:17,  2.69s/it]
Epoch 61 (train) - Loss: 0.046

 69%|███████████████████████████████████████████████████████████████████████████████▏                                   | 62/90 [02:52<01:15,  2.68s/it]
Epoch 62 (train) - Loss: 0.044


 71%|█████████████████████████████████████████████████████████████████████████████████▊                                 | 64/90 [02:58<01:11,  2.74s/it]
Epoch 63 (train) - Loss: 0.044
Epoch 63 (test) - Accuracy: 0.913 - F1 score: 0.949
Epoch 64 (train) - Loss: 0.042

 72%|███████████████████████████████████████████████████████████████████████████████████                                | 65/90 [03:00<01:09,  2.77s/it]

 73%|████████████████████████████████████████████████████████████████████████████████████▎                              | 66/90 [03:04<01:09,  2.88s/it]
Epoch 65 (test) - Accuracy: 0.918 - F1 score: 0.953
Epoch 66 (train) - Loss: 0.043

 74%|█████████████████████████████████████████████████████████████████████████████████████▌                             | 67/90 [03:06<01:05,  2.86s/it]
Epoch 67 (train) - Loss: 0.043

 76%|██████████████████████████████████████████████████████████████████████████████████████▉                            | 68/90 [03:09<01:02,  2.86s/it]
Epoch 68 (train) - Loss: 0.043

 77%|████████████████████████████████████████████████████████████████████████████████████████▏                          | 69/90 [03:12<00:58,  2.80s/it]
Epoch 69 (train) - Loss: 0.043

 78%|█████████████████████████████████████████████████████████████████████████████████████████▍                         | 70/90 [03:15<00:56,  2.81s/it]
Epoch 70 (train) - Loss: 0.043

 79%|██████████████████████████████████████████████████████████████████████████████████████████▋                        | 71/90 [03:18<00:54,  2.86s/it]
Epoch 71 (train) - Loss: 0.043

 80%|████████████████████████████████████████████████████████████████████████████████████████████                       | 72/90 [03:21<00:52,  2.92s/it]
Epoch 72 (train) - Loss: 0.043

 81%|█████████████████████████████████████████████████████████████████████████████████████████████▎                     | 73/90 [03:23<00:47,  2.82s/it]
Epoch 73 (train) - Loss: 0.043

 82%|██████████████████████████████████████████████████████████████████████████████████████████████▌                    | 74/90 [03:27<00:47,  2.96s/it]
Epoch 74 (train) - Loss: 0.044

 83%|███████████████████████████████████████████████████████████████████████████████████████████████▊                   | 75/90 [03:30<00:44,  2.96s/it]
Epoch 75 (train) - Loss: 0.042

 84%|█████████████████████████████████████████████████████████████████████████████████████████████████                  | 76/90 [03:32<00:41,  2.93s/it]
Epoch 76 (train) - Loss: 0.043

 86%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                | 77/90 [03:35<00:37,  2.87s/it]
Epoch 77 (train) - Loss: 0.042

 87%|███████████████████████████████████████████████████████████████████████████████████████████████████▋               | 78/90 [03:38<00:33,  2.82s/it]
Epoch 78 (train) - Loss: 0.045

 88%|████████████████████████████████████████████████████████████████████████████████████████████████████▉              | 79/90 [03:41<00:31,  2.87s/it]

 89%|██████████████████████████████████████████████████████████████████████████████████████████████████████▏            | 80/90 [03:43<00:27,  2.78s/it]
Epoch 79 (test) - Accuracy: 0.923 - F1 score: 0.955
Epoch 80 (train) - Loss: 0.043

 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 81/90 [03:47<00:26,  2.93s/it]

 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████▊          | 82/90 [03:50<00:23,  2.90s/it]
Epoch 81 (test) - Accuracy: 0.920 - F1 score: 0.954
Epoch 82 (train) - Loss: 0.043

 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████         | 83/90 [03:52<00:19,  2.79s/it]
Epoch 83 (train) - Loss: 0.042

 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▎       | 84/90 [03:55<00:17,  2.91s/it]
Epoch 84 (train) - Loss: 0.042

 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 85/90 [03:58<00:14,  2.90s/it]

 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▉     | 86/90 [04:01<00:12,  3.01s/it]
Epoch 85 (test) - Accuracy: 0.911 - F1 score: 0.949
Epoch 86 (train) - Loss: 0.043

 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏   | 87/90 [04:05<00:09,  3.05s/it]

 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍  | 88/90 [04:08<00:06,  3.03s/it]
Epoch 87 (test) - Accuracy: 0.915 - F1 score: 0.951
Epoch 88 (train) - Loss: 0.043

 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋ | 89/90 [04:11<00:03,  3.06s/it]
Epoch 89 (train) - Loss: 0.043
Epoch 89 (test) - Accuracy: 0.917 - F1 score: 0.952
Plotting the results...

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [04:13<00:00,  2.82s/it]
Saving the model as 'ftt_model_2_raw'...
Generating the test.json file...
Done!