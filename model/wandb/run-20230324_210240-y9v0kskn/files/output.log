[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'learning_rate' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_epochs' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'hidden_size' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_layers' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'dropout' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'weight_decay' was locked by 'sweep' (ignored update).
  0%|                                                                                              | 0/40 [00:00<?, ?it/s]
Creating dataset...
Loading data from /home/usuaris/veu/gerard.calvo.bartra/nuwe/model/../data/supply_chain_train_raw.csv
Train batch 0:
{'data': tensor([[-0.5480, -1.1687,  0.5180,  ...,  0.0000,  0.0000,  0.0000],
        [-0.5740,  1.6931, -1.0240,  ...,  0.0000,  0.0000,  0.0000],
        [-0.5299, -0.0489, -0.2530,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [ 0.8806, -0.7954,  0.5180,  ...,  0.0000,  0.0000,  0.0000],
        [-0.6855, -0.5466,  0.5180,  ...,  0.0000,  0.0000,  0.0000],
        [-0.6666, -0.1733, -0.2530,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1,
        1, 1, 0, 1, 0, 1, 1, 1])}
Validation batch 0:
{'data': tensor([[-0.7021, -0.9862, -0.2985,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7690,  0.4015,  2.1085,  ...,  0.0000,  0.0000,  1.0000],
        [-0.7355,  0.0231, -1.1008,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-0.7259,  0.1492, -0.2985,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.4713,  0.5277,  2.1085,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7987, -0.2293,  0.5039,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 0, 1, 1])}
batch_data.shape: torch.Size([32, 38])
Percentage of positive and negative samples in the training set:
1    0.839094
0    0.160906
Name: Attrition_Flag, dtype: float64
BaselineNet(
  (fc): Sequential(
    (fc0): Linear(in_features=38, out_features=512, bias=True)
    (relu0): ReLU()
    (dropout0): Dropout(p=0.1839914194170899, inplace=False)
    (fc1): Linear(in_features=512, out_features=512, bias=True)
    (relu1): ReLU()
    (dropout1): Dropout(p=0.1839914194170899, inplace=False)
    (fc2): Linear(in_features=512, out_features=512, bias=True)
    (relu2): ReLU()
    (dropout2): Dropout(p=0.1839914194170899, inplace=False)
    (fc3): Linear(in_features=512, out_features=1, bias=True)
    (sigmoid): Sigmoid()
  )
)
Num params:  545793

  2%|██▏                                                                                   | 1/40 [00:04<02:51,  4.39s/it]
Epoch 0 (train) - Loss: 0.246

  5%|████▎                                                                                 | 2/40 [00:08<02:46,  4.37s/it]
Epoch 1 (train) - Loss: 0.187

  8%|██████▍                                                                               | 3/40 [00:13<02:43,  4.41s/it]
Epoch 2 (train) - Loss: 0.169
Epoch 2 (test) - Accuracy: 0.937 - F1 score: 0.963

 10%|████████▌                                                                             | 4/40 [00:17<02:38,  4.39s/it]

 12%|██████████▊                                                                           | 5/40 [00:22<02:34,  4.42s/it]
Epoch 4 (train) - Loss: 0.157

 15%|████████████▉                                                                         | 6/40 [00:26<02:28,  4.38s/it]
Epoch 5 (train) - Loss: 0.148
Epoch 5 (test) - Accuracy: 0.943 - F1 score: 0.966
Epoch 6 (train) - Loss: 0.143

 18%|███████████████                                                                       | 7/40 [00:31<02:30,  4.55s/it]
Epoch 7 (train) - Loss: 0.136

 20%|█████████████████▏                                                                    | 8/40 [00:36<02:31,  4.74s/it]

 22%|███████████████████▎                                                                  | 9/40 [00:41<02:33,  4.94s/it]
Epoch 8 (test) - Accuracy: 0.944 - F1 score: 0.967
Epoch 9 (train) - Loss: 0.126

 25%|█████████████████████▎                                                               | 10/40 [00:47<02:33,  5.11s/it]
Epoch 10 (train) - Loss: 0.123

 28%|███████████████████████▍                                                             | 11/40 [00:53<02:33,  5.30s/it]
Epoch 11 (train) - Loss: 0.118

 30%|█████████████████████████▌                                                           | 12/40 [00:58<02:32,  5.44s/it]
Epoch 12 (train) - Loss: 0.119

 32%|███████████████████████████▋                                                         | 13/40 [01:04<02:29,  5.55s/it]
Epoch 13 (train) - Loss: 0.111

 35%|█████████████████████████████▋                                                       | 14/40 [01:10<02:25,  5.60s/it]
Epoch 14 (train) - Loss: 0.110

 38%|███████████████████████████████▉                                                     | 15/40 [01:15<02:20,  5.63s/it]

 40%|██████████████████████████████████                                                   | 16/40 [01:21<02:15,  5.65s/it]
Epoch 15 (test) - Accuracy: 0.951 - F1 score: 0.971

 42%|████████████████████████████████████▏                                                | 17/40 [01:27<02:14,  5.84s/it]
Epoch 16 (test) - Accuracy: 0.947 - F1 score: 0.969
Epoch 17 (train) - Loss: 0.097

 45%|██████████████████████████████████████▎                                              | 18/40 [01:33<02:07,  5.80s/it]
Epoch 18 (train) - Loss: 0.094

 48%|████████████████████████████████████████▍                                            | 19/40 [01:39<02:02,  5.82s/it]
Epoch 19 (train) - Loss: 0.099

 50%|██████████████████████████████████████████▌                                          | 20/40 [01:45<01:57,  5.85s/it]
Epoch 20 (train) - Loss: 0.092

 52%|████████████████████████████████████████████▋                                        | 21/40 [01:51<01:51,  5.87s/it]
Epoch 21 (train) - Loss: 0.090

 55%|██████████████████████████████████████████████▊                                      | 22/40 [01:57<01:46,  5.91s/it]
Epoch 22 (train) - Loss: 0.092

 57%|████████████████████████████████████████████████▊                                    | 23/40 [02:03<01:40,  5.88s/it]
Epoch 23 (train) - Loss: 0.095

 60%|███████████████████████████████████████████████████                                  | 24/40 [02:08<01:32,  5.75s/it]

 62%|█████████████████████████████████████████████████████▏                               | 25/40 [02:13<01:24,  5.64s/it]
Epoch 24 (test) - Accuracy: 0.949 - F1 score: 0.970
Epoch 25 (train) - Loss: 0.081

 65%|███████████████████████████████████████████████████████▎                             | 26/40 [02:19<01:19,  5.66s/it]
Epoch 26 (train) - Loss: 0.087

 68%|█████████████████████████████████████████████████████████▍                           | 27/40 [02:25<01:12,  5.59s/it]
Epoch 27 (train) - Loss: 0.082

 70%|███████████████████████████████████████████████████████████▍                         | 28/40 [02:30<01:07,  5.64s/it]
Epoch 28 (train) - Loss: 0.077

 72%|█████████████████████████████████████████████████████████████▋                       | 29/40 [02:36<01:01,  5.62s/it]

 75%|███████████████████████████████████████████████████████████████▊                     | 30/40 [02:42<00:56,  5.66s/it]
Epoch 29 (test) - Accuracy: 0.947 - F1 score: 0.968

 78%|█████████████████████████████████████████████████████████████████▉                   | 31/40 [02:47<00:50,  5.65s/it]
Epoch 30 (test) - Accuracy: 0.954 - F1 score: 0.973
Epoch 31 (train) - Loss: 0.076

 80%|████████████████████████████████████████████████████████████████████                 | 32/40 [02:53<00:44,  5.61s/it]
Epoch 32 (train) - Loss: 0.074

 82%|██████████████████████████████████████████████████████████████████████▏              | 33/40 [02:59<00:39,  5.66s/it]
Epoch 33 (train) - Loss: 0.074


 88%|██████████████████████████████████████████████████████████████████████████▍          | 35/40 [03:10<00:28,  5.60s/it]
Epoch 34 (train) - Loss: 0.082
Epoch 34 (test) - Accuracy: 0.942 - F1 score: 0.966
Epoch 35 (train) - Loss: 0.075

 90%|████████████████████████████████████████████████████████████████████████████▌        | 36/40 [03:15<00:22,  5.56s/it]
Epoch 36 (train) - Loss: 0.073

 92%|██████████████████████████████████████████████████████████████████████████████▋      | 37/40 [03:21<00:16,  5.56s/it]
Epoch 37 (train) - Loss: 0.074

 95%|████████████████████████████████████████████████████████████████████████████████▊    | 38/40 [03:26<00:11,  5.59s/it]
Epoch 38 (train) - Loss: 0.068

 98%|██████████████████████████████████████████████████████████████████████████████████▉  | 39/40 [03:32<00:05,  5.58s/it]

100%|█████████████████████████████████████████████████████████████████████████████████████| 40/40 [03:38<00:00,  5.45s/it]
Epoch 39 (test) - Accuracy: 0.941 - F1 score: 0.964
Plotting the results...
Saving the plot as 'results_baseline_model_2_raw.png'...
Saving the model as 'baseline_model_2_raw'...
Generating the test.json file...
Done!