[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'learning_rate' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_epochs' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'hidden_size' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_layers' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'dropout' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'weight_decay' was locked by 'sweep' (ignored update).
  0%|                                                                                              | 0/70 [00:00<?, ?it/s]
Creating dataset...
Loading data from /home/usuaris/veu/gerard.calvo.bartra/nuwe/model/../data/supply_chain_train_balanced.csv
Train batch 0:
{'data': tensor([[-0.4738, -1.4270, -0.5574,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.8175, -0.4065, -0.5574,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.1719,  0.6141,  0.3519,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [ 0.1719,  0.6141, -0.5574,  ...,  0.0000,  0.0000,  0.0000],
        [-1.1194, -0.4065, -0.5574,  ...,  0.0000,  0.0000,  0.0000],
        [-0.4738,  0.6141,  0.3519,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0,
        1, 1, 1, 1, 0, 1, 0, 1])}
Validation batch 0:
{'data': tensor([[-1.1402,  0.6459, -1.3412,  ...,  0.0000,  0.0000,  0.0000],
        [-0.4862, -0.3693,  1.1670,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.1677, -0.3693, -1.3412,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-1.1402,  0.6459,  2.0031,  ...,  0.0000,  0.0000,  0.0000],
        [-0.4862,  0.6459, -0.5051,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.1677, -0.3693,  1.1670,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1,
        1, 0, 1, 1, 1, 0, 0, 1])}
batch_data.shape: torch.Size([32, 32])
Percentage of positive and negative samples in the training set:
1    0.644696
0    0.355304
Name: Attrition_Flag, dtype: float64
BaselineNet(
  (fc): Sequential(
    (fc0): Linear(in_features=32, out_features=512, bias=True)
    (relu0): ReLU()
    (dropout0): Dropout(p=0.24115848454089273, inplace=False)
    (fc1): Linear(in_features=512, out_features=512, bias=True)
    (relu1): ReLU()
    (dropout1): Dropout(p=0.24115848454089273, inplace=False)
    (fc2): Linear(in_features=512, out_features=512, bias=True)
    (relu2): ReLU()
    (dropout2): Dropout(p=0.24115848454089273, inplace=False)
    (fc3): Linear(in_features=512, out_features=512, bias=True)
    (relu3): ReLU()
    (dropout3): Dropout(p=0.24115848454089273, inplace=False)
    (fc4): Linear(in_features=512, out_features=1, bias=True)
    (sigmoid): Sigmoid()
  )
)
Num params:  805377

  1%|█▏                                                                                    | 1/70 [00:03<03:29,  3.04s/it]
Epoch 0 (train) - Loss: 0.393
Epoch 0 (test) - Accuracy: 0.812 - F1 score: 0.870

  3%|██▍                                                                                   | 2/70 [00:05<03:09,  2.78s/it]

  4%|███▋                                                                                  | 3/70 [00:08<02:55,  2.62s/it]
Epoch 2 (train) - Loss: 0.288

  6%|████▉                                                                                 | 4/70 [00:10<02:52,  2.61s/it]
Epoch 3 (train) - Loss: 0.271

  7%|██████▏                                                                               | 5/70 [00:13<02:46,  2.56s/it]
Epoch 4 (train) - Loss: 0.251

 10%|████████▌                                                                             | 7/70 [00:18<02:40,  2.55s/it]
Epoch 5 (train) - Loss: 0.255
Epoch 5 (test) - Accuracy: 0.909 - F1 score: 0.931
Epoch 6 (train) - Loss: 0.243

 11%|█████████▊                                                                            | 8/70 [00:20<02:37,  2.55s/it]
Epoch 7 (train) - Loss: 0.253
Epoch 7 (test) - Accuracy: 0.910 - F1 score: 0.931

 13%|███████████                                                                           | 9/70 [00:23<02:42,  2.67s/it]

 14%|████████████▏                                                                        | 10/70 [00:26<02:38,  2.65s/it]
Epoch 9 (train) - Loss: 0.222

 16%|█████████████▎                                                                       | 11/70 [00:29<02:38,  2.68s/it]
Epoch 10 (train) - Loss: 0.227

 17%|██████████████▌                                                                      | 12/70 [00:31<02:38,  2.74s/it]
Epoch 11 (train) - Loss: 0.232

 19%|███████████████▊                                                                     | 13/70 [00:35<02:44,  2.89s/it]
Epoch 12 (train) - Loss: 0.208

 20%|█████████████████                                                                    | 14/70 [00:38<02:47,  3.00s/it]
Epoch 13 (train) - Loss: 0.216

 21%|██████████████████▏                                                                  | 15/70 [00:42<02:56,  3.20s/it]
Epoch 14 (train) - Loss: 0.210

 23%|███████████████████▍                                                                 | 16/70 [00:46<03:04,  3.42s/it]
Epoch 15 (train) - Loss: 0.203

 24%|████████████████████▋                                                                | 17/70 [00:49<03:09,  3.57s/it]
Epoch 16 (train) - Loss: 0.191
Epoch 16 (test) - Accuracy: 0.904 - F1 score: 0.926
Epoch 17 (train) - Loss: 0.180


 27%|███████████████████████                                                              | 19/70 [00:57<03:11,  3.75s/it]
Epoch 18 (train) - Loss: 0.185

 29%|████████████████████████▎                                                            | 20/70 [01:01<03:09,  3.79s/it]
Epoch 19 (train) - Loss: 0.184

 30%|█████████████████████████▌                                                           | 21/70 [01:05<03:01,  3.70s/it]
Epoch 20 (train) - Loss: 0.177
Epoch 20 (test) - Accuracy: 0.910 - F1 score: 0.932
Epoch 21 (train) - Loss: 0.166

 31%|██████████████████████████▋                                                          | 22/70 [01:09<03:01,  3.77s/it]
Epoch 22 (train) - Loss: 0.169

 33%|███████████████████████████▉                                                         | 23/70 [01:13<03:02,  3.88s/it]
Epoch 23 (train) - Loss: 0.154

 34%|█████████████████████████████▏                                                       | 24/70 [01:17<02:57,  3.85s/it]
Epoch 24 (train) - Loss: 0.159

 36%|██████████████████████████████▎                                                      | 25/70 [01:20<02:54,  3.87s/it]
Epoch 25 (train) - Loss: 0.166

 37%|███████████████████████████████▌                                                     | 26/70 [01:24<02:52,  3.91s/it]
Epoch 26 (train) - Loss: 0.148

 39%|████████████████████████████████▊                                                    | 27/70 [01:29<02:49,  3.95s/it]
Epoch 27 (train) - Loss: 0.151

 40%|██████████████████████████████████                                                   | 28/70 [01:33<02:46,  3.97s/it]
Epoch 28 (train) - Loss: 0.157

 41%|███████████████████████████████████▏                                                 | 29/70 [01:37<02:42,  3.96s/it]
Epoch 29 (train) - Loss: 0.146

 43%|████████████████████████████████████▍                                                | 30/70 [01:40<02:34,  3.87s/it]
Epoch 30 (train) - Loss: 0.151

 44%|█████████████████████████████████████▋                                               | 31/70 [01:44<02:33,  3.94s/it]
Epoch 31 (train) - Loss: 0.149

 46%|██████████████████████████████████████▊                                              | 32/70 [01:48<02:29,  3.93s/it]
Epoch 32 (train) - Loss: 0.147

 47%|████████████████████████████████████████                                             | 33/70 [01:52<02:24,  3.91s/it]
Epoch 33 (train) - Loss: 0.149

 49%|█████████████████████████████████████████▎                                           | 34/70 [01:56<02:22,  3.96s/it]
Epoch 34 (train) - Loss: 0.146

 50%|██████████████████████████████████████████▌                                          | 35/70 [02:00<02:15,  3.87s/it]
Epoch 35 (train) - Loss: 0.150

 51%|███████████████████████████████████████████▋                                         | 36/70 [02:04<02:11,  3.88s/it]
Epoch 36 (train) - Loss: 0.147

 53%|████████████████████████████████████████████▉                                        | 37/70 [02:08<02:10,  3.96s/it]
Epoch 37 (train) - Loss: 0.142

 54%|██████████████████████████████████████████████▏                                      | 38/70 [02:12<02:06,  3.94s/it]
Epoch 38 (train) - Loss: 0.136

 56%|███████████████████████████████████████████████▎                                     | 39/70 [02:16<02:02,  3.95s/it]
Epoch 39 (train) - Loss: 0.137

 57%|████████████████████████████████████████████████▌                                    | 40/70 [02:20<01:58,  3.96s/it]
Epoch 40 (train) - Loss: 0.126

 59%|█████████████████████████████████████████████████▊                                   | 41/70 [02:24<01:55,  4.00s/it]
Epoch 41 (train) - Loss: 0.132

 60%|███████████████████████████████████████████████████                                  | 42/70 [02:28<01:51,  3.97s/it]
Epoch 42 (train) - Loss: 0.130

 61%|████████████████████████████████████████████████████▏                                | 43/70 [02:32<01:47,  3.97s/it]
Epoch 43 (train) - Loss: 0.138

 63%|█████████████████████████████████████████████████████▍                               | 44/70 [02:36<01:43,  3.99s/it]
Epoch 44 (train) - Loss: 0.134

 64%|██████████████████████████████████████████████████████▋                              | 45/70 [02:40<01:42,  4.10s/it]
Epoch 45 (train) - Loss: 0.116

 66%|███████████████████████████████████████████████████████▊                             | 46/70 [02:44<01:38,  4.10s/it]
Epoch 46 (train) - Loss: 0.121

 67%|█████████████████████████████████████████████████████████                            | 47/70 [02:48<01:33,  4.05s/it]
Epoch 47 (train) - Loss: 0.130

 69%|██████████████████████████████████████████████████████████▎                          | 48/70 [02:52<01:30,  4.13s/it]
Epoch 48 (train) - Loss: 0.135

 70%|███████████████████████████████████████████████████████████▍                         | 49/70 [02:56<01:25,  4.05s/it]
Epoch 49 (train) - Loss: 0.139

 71%|████████████████████████████████████████████████████████████▋                        | 50/70 [03:00<01:20,  4.00s/it]
Epoch 50 (train) - Loss: 0.110

 73%|█████████████████████████████████████████████████████████████▉                       | 51/70 [03:04<01:17,  4.08s/it]
Epoch 51 (train) - Loss: 0.124

 74%|███████████████████████████████████████████████████████████████▏                     | 52/70 [03:08<01:10,  3.93s/it]
Epoch 52 (train) - Loss: 0.126

 76%|████████████████████████████████████████████████████████████████▎                    | 53/70 [03:13<01:10,  4.13s/it]
Epoch 53 (train) - Loss: 0.120

 77%|█████████████████████████████████████████████████████████████████▌                   | 54/70 [03:17<01:06,  4.14s/it]
Epoch 54 (train) - Loss: 0.128

 79%|██████████████████████████████████████████████████████████████████▊                  | 55/70 [03:23<01:11,  4.78s/it]

 80%|████████████████████████████████████████████████████████████████████                 | 56/70 [03:34<01:31,  6.55s/it]
Epoch 55 (test) - Accuracy: 0.915 - F1 score: 0.933

 81%|█████████████████████████████████████████████████████████████████████▏               | 57/70 [03:41<01:30,  6.94s/it]
Epoch 56 (test) - Accuracy: 0.918 - F1 score: 0.937

 83%|██████████████████████████████████████████████████████████████████████▍              | 58/70 [03:46<01:12,  6.06s/it]
Epoch 57 (test) - Accuracy: 0.921 - F1 score: 0.939

 84%|███████████████████████████████████████████████████████████████████████▋             | 59/70 [03:49<00:59,  5.42s/it]
Epoch 58 (test) - Accuracy: 0.894 - F1 score: 0.916
Epoch 59 (train) - Loss: 0.126

 86%|████████████████████████████████████████████████████████████████████████▊            | 60/70 [03:53<00:49,  4.96s/it]
Epoch 60 (train) - Loss: 0.118

 87%|██████████████████████████████████████████████████████████████████████████           | 61/70 [03:57<00:40,  4.55s/it]
Epoch 61 (train) - Loss: 0.109

 89%|███████████████████████████████████████████████████████████████████████████▎         | 62/70 [04:01<00:34,  4.36s/it]
Epoch 62 (train) - Loss: 0.124

 90%|████████████████████████████████████████████████████████████████████████████▌        | 63/70 [04:05<00:29,  4.19s/it]
Epoch 63 (train) - Loss: 0.122

 91%|█████████████████████████████████████████████████████████████████████████████▋       | 64/70 [04:08<00:24,  4.07s/it]
Epoch 64 (train) - Loss: 0.125

 93%|██████████████████████████████████████████████████████████████████████████████▉      | 65/70 [04:12<00:20,  4.01s/it]
Epoch 65 (train) - Loss: 0.114


 96%|█████████████████████████████████████████████████████████████████████████████████▎   | 67/70 [04:22<00:12,  4.32s/it]
Epoch 66 (train) - Loss: 0.115
Epoch 66 (test) - Accuracy: 0.915 - F1 score: 0.934
Epoch 67 (train) - Loss: 0.120

 97%|██████████████████████████████████████████████████████████████████████████████████▌  | 68/70 [04:26<00:08,  4.18s/it]
Epoch 68 (train) - Loss: 0.107

 99%|███████████████████████████████████████████████████████████████████████████████████▊ | 69/70 [04:30<00:04,  4.12s/it]
Epoch 69 (train) - Loss: 0.110
Epoch 69 (test) - Accuracy: 0.918 - F1 score: 0.936
Plotting the results...

100%|█████████████████████████████████████████████████████████████████████████████████████| 70/70 [04:35<00:00,  3.94s/it]
Saving the model as 'baseline_model_2_balanced'...
Generating the test.json file...
Done!