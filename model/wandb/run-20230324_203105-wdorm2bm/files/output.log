[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'learning_rate' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_epochs' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'hidden_size' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_layers' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'dropout' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'weight_decay' was locked by 'sweep' (ignored update).
  0%|                                                                                              | 0/50 [00:00<?, ?it/s]
Creating dataset...
Loading data from /home/usuaris/veu/gerard.calvo.bartra/nuwe/model/../data/supply_chain_train_raw.csv
Train batch 0:
{'data': tensor([[-0.8001,  1.1954, -1.0240,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7848,  1.0710,  0.5180,  ...,  0.0000,  0.0000,  0.0000],
        [-0.4982,  0.0756,  1.2890,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [ 0.8051,  0.5733, -1.0240,  ...,  0.0000,  0.0000,  0.0000],
        [-0.6645,  0.2000,  1.2890,  ...,  0.0000,  0.0000,  0.0000],
        [ 1.3583,  1.1954,  0.5180,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        0, 1, 1, 1, 1, 1, 1, 1])}
Validation batch 0:
{'data': tensor([[-0.7021, -0.9862, -0.2985,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7690,  0.4015,  2.1085,  ...,  0.0000,  0.0000,  1.0000],
        [-0.7355,  0.0231, -1.1008,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-0.7259,  0.1492, -0.2985,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.4713,  0.5277,  2.1085,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7987, -0.2293,  0.5039,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 0, 1, 1])}
batch_data.shape: torch.Size([32, 38])
Percentage of positive and negative samples in the training set:
1    0.839094
0    0.160906
Name: Attrition_Flag, dtype: float64
BaselineNet(
  (fc): Sequential(
    (fc0): Linear(in_features=38, out_features=128, bias=True)
    (relu0): ReLU()
    (dropout0): Dropout(p=0.2424517909717701, inplace=False)
    (fc1): Linear(in_features=128, out_features=128, bias=True)
    (relu1): ReLU()
    (dropout1): Dropout(p=0.2424517909717701, inplace=False)
    (fc2): Linear(in_features=128, out_features=128, bias=True)
    (relu2): ReLU()
    (dropout2): Dropout(p=0.2424517909717701, inplace=False)
    (fc3): Linear(in_features=128, out_features=128, bias=True)
    (relu3): ReLU()
    (dropout3): Dropout(p=0.2424517909717701, inplace=False)
    (fc4): Linear(in_features=128, out_features=1, bias=True)
    (sigmoid): Sigmoid()
  )
)
Num params:  54657

  2%|█▋                                                                                    | 1/50 [00:04<03:17,  4.02s/it]
Epoch 0 (train) - Loss: 0.275
Epoch 0 (test) - Accuracy: 0.923 - F1 score: 0.955

  4%|███▍                                                                                  | 2/50 [00:07<03:05,  3.87s/it]
Epoch 1 (test) - Accuracy: 0.918 - F1 score: 0.951

  6%|█████▏                                                                                | 3/50 [00:11<02:59,  3.82s/it]
Epoch 2 (test) - Accuracy: 0.923 - F1 score: 0.955

  8%|██████▉                                                                               | 4/50 [00:15<02:59,  3.90s/it]
Epoch 3 (test) - Accuracy: 0.933 - F1 score: 0.960

 10%|████████▌                                                                             | 5/50 [00:19<02:57,  3.94s/it]
Epoch 4 (test) - Accuracy: 0.933 - F1 score: 0.960
Epoch 5 (train) - Loss: 0.181

 12%|██████████▎                                                                           | 6/50 [00:23<02:50,  3.88s/it]
Epoch 6 (train) - Loss: 0.168


 16%|█████████████▊                                                                        | 8/50 [00:31<02:48,  4.02s/it]
Epoch 7 (train) - Loss: 0.161

 18%|███████████████▍                                                                      | 9/50 [00:35<02:47,  4.09s/it]
Epoch 8 (train) - Loss: 0.166
Epoch 8 (test) - Accuracy: 0.916 - F1 score: 0.950
Epoch 9 (train) - Loss: 0.163

 20%|█████████████████                                                                    | 10/50 [00:39<02:43,  4.08s/it]

 22%|██████████████████▋                                                                  | 11/50 [00:44<02:41,  4.14s/it]
Epoch 10 (test) - Accuracy: 0.929 - F1 score: 0.958

 24%|████████████████████▍                                                                | 12/50 [00:48<02:39,  4.18s/it]

 26%|██████████████████████                                                               | 13/50 [00:52<02:35,  4.19s/it]
Epoch 12 (train) - Loss: 0.161

 28%|███████████████████████▊                                                             | 14/50 [00:56<02:31,  4.20s/it]
Epoch 13 (train) - Loss: 0.164

 30%|█████████████████████████▌                                                           | 15/50 [01:01<02:26,  4.20s/it]
Epoch 14 (train) - Loss: 0.156

 32%|███████████████████████████▏                                                         | 16/50 [01:05<02:24,  4.24s/it]
Epoch 15 (train) - Loss: 0.153

 34%|████████████████████████████▉                                                        | 17/50 [01:09<02:19,  4.22s/it]
Epoch 16 (train) - Loss: 0.163

 36%|██████████████████████████████▌                                                      | 18/50 [01:13<02:15,  4.25s/it]
Epoch 17 (train) - Loss: 0.161
Epoch 17 (test) - Accuracy: 0.940 - F1 score: 0.965

 38%|████████████████████████████████▎                                                    | 19/50 [01:18<02:12,  4.27s/it]
Epoch 18 (test) - Accuracy: 0.937 - F1 score: 0.964

 40%|██████████████████████████████████                                                   | 20/50 [01:22<02:08,  4.28s/it]

 42%|███████████████████████████████████▋                                                 | 21/50 [01:26<02:03,  4.26s/it]
Epoch 20 (train) - Loss: 0.143

 44%|█████████████████████████████████████▍                                               | 22/50 [01:31<02:00,  4.29s/it]
Epoch 21 (train) - Loss: 0.145

 46%|███████████████████████████████████████                                              | 23/50 [01:35<01:56,  4.31s/it]
Epoch 22 (train) - Loss: 0.145

 48%|████████████████████████████████████████▊                                            | 24/50 [01:39<01:51,  4.28s/it]
Epoch 23 (train) - Loss: 0.153
Epoch 23 (test) - Accuracy: 0.934 - F1 score: 0.961
Epoch 24 (train) - Loss: 0.145

 50%|██████████████████████████████████████████▌                                          | 25/50 [01:43<01:47,  4.29s/it]

 52%|████████████████████████████████████████████▏                                        | 26/50 [01:48<01:43,  4.30s/it]
Epoch 25 (test) - Accuracy: 0.935 - F1 score: 0.961

 54%|█████████████████████████████████████████████▉                                       | 27/50 [01:52<01:38,  4.28s/it]

 56%|███████████████████████████████████████████████▌                                     | 28/50 [01:56<01:33,  4.24s/it]
Epoch 27 (train) - Loss: 0.146

 58%|█████████████████████████████████████████████████▎                                   | 29/50 [02:01<01:29,  4.28s/it]
Epoch 28 (train) - Loss: 0.135

 60%|███████████████████████████████████████████████████                                  | 30/50 [02:05<01:24,  4.22s/it]
Epoch 29 (train) - Loss: 0.149

 62%|████████████████████████████████████████████████████▋                                | 31/50 [02:09<01:20,  4.26s/it]
Epoch 30 (train) - Loss: 0.139

 64%|██████████████████████████████████████████████████████▍                              | 32/50 [02:13<01:16,  4.24s/it]
Epoch 31 (train) - Loss: 0.160

 66%|████████████████████████████████████████████████████████                             | 33/50 [02:17<01:11,  4.21s/it]
Epoch 32 (train) - Loss: 0.196
Epoch 32 (test) - Accuracy: 0.929 - F1 score: 0.958
Epoch 33 (train) - Loss: 0.138

 68%|█████████████████████████████████████████████████████████▊                           | 34/50 [02:22<01:07,  4.21s/it]
Epoch 34 (train) - Loss: 0.141

 70%|███████████████████████████████████████████████████████████▍                         | 35/50 [02:26<01:02,  4.19s/it]

 72%|█████████████████████████████████████████████████████████████▏                       | 36/50 [02:30<00:59,  4.22s/it]

 74%|██████████████████████████████████████████████████████████████▉                      | 37/50 [02:35<00:59,  4.56s/it]
Epoch 36 (train) - Loss: 0.139

 76%|████████████████████████████████████████████████████████████████▌                    | 38/50 [02:40<00:53,  4.45s/it]
Epoch 37 (train) - Loss: 0.151
Epoch 37 (test) - Accuracy: 0.937 - F1 score: 0.963

 78%|██████████████████████████████████████████████████████████████████▎                  | 39/50 [02:44<00:48,  4.38s/it]
Epoch 38 (test) - Accuracy: 0.936 - F1 score: 0.962

 80%|████████████████████████████████████████████████████████████████████                 | 40/50 [02:48<00:43,  4.33s/it]
Epoch 39 (test) - Accuracy: 0.944 - F1 score: 0.967

 82%|█████████████████████████████████████████████████████████████████████▋               | 41/50 [02:52<00:38,  4.29s/it]

 84%|███████████████████████████████████████████████████████████████████████▍             | 42/50 [02:56<00:33,  4.23s/it]
Epoch 41 (train) - Loss: 0.157

 86%|█████████████████████████████████████████████████████████████████████████            | 43/50 [03:00<00:29,  4.22s/it]
Epoch 42 (train) - Loss: 0.142

 88%|██████████████████████████████████████████████████████████████████████████▊          | 44/50 [03:05<00:25,  4.31s/it]
Epoch 43 (train) - Loss: 0.169

 90%|████████████████████████████████████████████████████████████████████████████▌        | 45/50 [03:09<00:21,  4.21s/it]
Epoch 44 (train) - Loss: 0.130

 92%|██████████████████████████████████████████████████████████████████████████████▏      | 46/50 [03:13<00:16,  4.20s/it]
Epoch 45 (train) - Loss: 0.134

 94%|███████████████████████████████████████████████████████████████████████████████▉     | 47/50 [03:17<00:12,  4.21s/it]
Epoch 46 (train) - Loss: 0.154

 96%|█████████████████████████████████████████████████████████████████████████████████▌   | 48/50 [03:22<00:08,  4.20s/it]
Epoch 47 (train) - Loss: 0.145

 98%|███████████████████████████████████████████████████████████████████████████████████▎ | 49/50 [03:26<00:04,  4.16s/it]
Epoch 48 (train) - Loss: 0.130
Epoch 48 (test) - Accuracy: 0.941 - F1 score: 0.965
Epoch 49 (train) - Loss: 0.152
Epoch 49 (test) - Accuracy: 0.937 - F1 score: 0.963

100%|█████████████████████████████████████████████████████████████████████████████████████| 50/50 [03:30<00:00,  4.21s/it]
Saving the plot as 'results_baseline_model_2_raw.png'...
Saving the model as 'baseline_model_2_raw'...
Generating the test.json file...
Done!