[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'learning_rate' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_epochs' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'weight_decay' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'depth' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'heads' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'attn_dropout' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'dim_ff' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'd_model' was locked by 'sweep' (ignored update).
  0%|                                                                                                          | 0/70 [00:00<?, ?it/s]
Creating dataset...
Loading data from /home/usuaris/veu/gerard.calvo.bartra/nuwe/model/../data/supply_chain_train_raw.csv
Train batch 0:
{'data': tensor([[ 1.3233, -1.4176,  1.2890,  ...,  0.0000,  0.0000,  0.0000],
        [-0.8353,  1.1954, -1.0240,  ...,  0.0000,  0.0000,  0.0000],
        [-0.6131, -0.9199, -1.0240,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [ 2.2650,  1.1954, -1.0240,  ...,  0.0000,  0.0000,  0.0000],
        [ 1.8183,  0.6977,  1.2890,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7254,  0.4489, -0.2530,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1])}
Validation batch 0:
{'data': tensor([[-0.7021, -0.9862, -0.2985,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7690,  0.4015,  2.1085,  ...,  0.0000,  0.0000,  1.0000],
        [-0.7355,  0.0231, -1.1008,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-0.7259,  0.1492, -0.2985,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.4713,  0.5277,  2.1085,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7987, -0.2293,  0.5039,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 0, 1, 1])}
batch_data.shape: torch.Size([32, 38])
Percentage of positive and negative samples in the training set:
1    0.839094
0    0.160906
Name: Attrition_Flag, dtype: float64
FTTransformer(
  (numerical_embedder): NumericalEmbedder(
    (linear): Linear(in_features=38, out_features=128, bias=True)
  )
  (layers): ModuleList(
    (0-2): 3 x ModuleList(
      (0): Attention(
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (to_qkv): Linear(in_features=128, out_features=384, bias=False)
        (to_out): Linear(in_features=128, out_features=128, bias=False)
        (dropout): Dropout(p=0.01496100817067969, inplace=False)
      )
      (1): Sequential(
        (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (1): Linear(in_features=128, out_features=128, bias=True)
        (2): GEGLU()
        (3): Dropout(p=0.01496100817067969, inplace=False)
        (4): Linear(in_features=64, out_features=128, bias=True)
      )
    )
  )
  (to_logits): Sequential(
    (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (1): ReLU()
    (2): Linear(in_features=128, out_features=1, bias=True)
    (3): Sigmoid()
  )
)
Num params:  278017

  1%|█▍                                                                                                | 1/70 [00:04<04:52,  4.23s/it]
Epoch 0 (train) - Loss: 0.085

  3%|██▊                                                                                               | 2/70 [00:08<04:39,  4.11s/it]
Epoch 1 (train) - Loss: 0.069

  4%|████▏                                                                                             | 3/70 [00:12<04:43,  4.23s/it]
Epoch 2 (train) - Loss: 0.063
Epoch 2 (test) - Accuracy: 0.907 - F1 score: 0.947

  6%|█████▌                                                                                            | 4/70 [00:17<05:05,  4.62s/it]

  7%|███████                                                                                           | 5/70 [00:24<05:36,  5.18s/it]
Epoch 4 (train) - Loss: 0.059

  9%|████████▍                                                                                         | 6/70 [00:30<05:57,  5.58s/it]
Epoch 5 (train) - Loss: 0.061

 10%|█████████▊                                                                                        | 7/70 [00:37<06:19,  6.02s/it]
Epoch 6 (train) - Loss: 0.058

 11%|███████████▏                                                                                      | 8/70 [00:45<06:57,  6.73s/it]
Epoch 7 (train) - Loss: 0.059
Epoch 7 (test) - Accuracy: 0.906 - F1 score: 0.946

 13%|████████████▌                                                                                     | 9/70 [00:53<07:16,  7.16s/it]

 14%|█████████████▊                                                                                   | 10/70 [01:00<07:10,  7.17s/it]
Epoch 9 (train) - Loss: 0.056
Epoch 9 (test) - Accuracy: 0.903 - F1 score: 0.944

 16%|███████████████▏                                                                                 | 11/70 [01:07<07:01,  7.15s/it]

 17%|████████████████▋                                                                                | 12/70 [01:15<06:56,  7.17s/it]
Epoch 11 (train) - Loss: 0.054

 19%|██████████████████                                                                               | 13/70 [01:22<06:49,  7.18s/it]
Epoch 12 (train) - Loss: 0.052
Epoch 12 (test) - Accuracy: 0.916 - F1 score: 0.952
Epoch 13 (train) - Loss: 0.051

 20%|███████████████████▍                                                                             | 14/70 [01:30<06:58,  7.48s/it]
Epoch 14 (train) - Loss: 0.051

 21%|████████████████████▊                                                                            | 15/70 [01:38<06:55,  7.55s/it]
Epoch 15 (train) - Loss: 0.050

 23%|██████████████████████▏                                                                          | 16/70 [01:46<07:01,  7.81s/it]

 24%|███████████████████████▌                                                                         | 17/70 [01:54<06:46,  7.66s/it]

 26%|████████████████████████▉                                                                        | 18/70 [02:02<06:46,  7.82s/it]
Epoch 17 (train) - Loss: 0.048
Epoch 17 (test) - Accuracy: 0.916 - F1 score: 0.952

 27%|██████████████████████████▎                                                                      | 19/70 [02:09<06:34,  7.73s/it]

 29%|███████████████████████████▋                                                                     | 20/70 [02:17<06:29,  7.78s/it]
Epoch 19 (train) - Loss: 0.045

 30%|█████████████████████████████                                                                    | 21/70 [02:25<06:20,  7.77s/it]
Epoch 20 (train) - Loss: 0.047

 31%|██████████████████████████████▍                                                                  | 22/70 [02:32<06:07,  7.66s/it]
Epoch 21 (train) - Loss: 0.046

 33%|███████████████████████████████▊                                                                 | 23/70 [02:40<05:57,  7.61s/it]
Epoch 22 (train) - Loss: 0.045

 34%|█████████████████████████████████▎                                                               | 24/70 [02:47<05:46,  7.53s/it]
Epoch 23 (train) - Loss: 0.043

 36%|██████████████████████████████████▋                                                              | 25/70 [02:54<05:31,  7.36s/it]
Epoch 24 (train) - Loss: 0.046

 37%|████████████████████████████████████                                                             | 26/70 [03:01<05:18,  7.25s/it]
Epoch 25 (train) - Loss: 0.045

 39%|█████████████████████████████████████▍                                                           | 27/70 [03:08<05:08,  7.17s/it]
Epoch 26 (train) - Loss: 0.041

 40%|██████████████████████████████████████▊                                                          | 28/70 [03:15<04:58,  7.10s/it]
Epoch 27 (train) - Loss: 0.042
Epoch 27 (test) - Accuracy: 0.925 - F1 score: 0.956

 41%|████████████████████████████████████████▏                                                        | 29/70 [03:22<04:44,  6.94s/it]

 43%|█████████████████████████████████████████▌                                                       | 30/70 [03:29<04:41,  7.03s/it]
Epoch 29 (train) - Loss: 0.043
Epoch 29 (test) - Accuracy: 0.914 - F1 score: 0.950

 44%|██████████████████████████████████████████▉                                                      | 31/70 [03:36<04:39,  7.16s/it]
Epoch 30 (test) - Accuracy: 0.924 - F1 score: 0.956

 46%|████████████████████████████████████████████▎                                                    | 32/70 [03:44<04:34,  7.22s/it]

 47%|█████████████████████████████████████████████▋                                                   | 33/70 [03:51<04:26,  7.19s/it]
Epoch 32 (train) - Loss: 0.041

 49%|███████████████████████████████████████████████                                                  | 34/70 [03:58<04:24,  7.36s/it]
Epoch 33 (train) - Loss: 0.042

 50%|████████████████████████████████████████████████▌                                                | 35/70 [04:06<04:19,  7.42s/it]
Epoch 34 (train) - Loss: 0.042
Epoch 34 (test) - Accuracy: 0.925 - F1 score: 0.956
Epoch 35 (train) - Loss: 0.040

 51%|█████████████████████████████████████████████████▉                                               | 36/70 [04:14<04:17,  7.58s/it]

 53%|███████████████████████████████████████████████████▎                                             | 37/70 [04:22<04:10,  7.59s/it]
Epoch 36 (test) - Accuracy: 0.930 - F1 score: 0.959

 54%|████████████████████████████████████████████████████▋                                            | 38/70 [04:30<04:08,  7.78s/it]

 56%|██████████████████████████████████████████████████████                                           | 39/70 [04:37<03:55,  7.59s/it]
Epoch 38 (train) - Loss: 0.040
Epoch 38 (test) - Accuracy: 0.933 - F1 score: 0.961
Epoch 39 (train) - Loss: 0.042

 57%|███████████████████████████████████████████████████████▍                                         | 40/70 [04:44<03:41,  7.40s/it]
Epoch 40 (train) - Loss: 0.041


 60%|██████████████████████████████████████████████████████████▏                                      | 42/70 [04:59<03:27,  7.43s/it]
Epoch 41 (train) - Loss: 0.042
Epoch 41 (test) - Accuracy: 0.936 - F1 score: 0.963

 61%|███████████████████████████████████████████████████████████▌                                     | 43/70 [05:06<03:20,  7.44s/it]

 63%|████████████████████████████████████████████████████████████▉                                    | 44/70 [05:13<03:09,  7.30s/it]
Epoch 43 (train) - Loss: 0.041
Epoch 43 (test) - Accuracy: 0.930 - F1 score: 0.959

 64%|██████████████████████████████████████████████████████████████▎                                  | 45/70 [05:20<03:01,  7.25s/it]

 66%|███████████████████████████████████████████████████████████████▋                                 | 46/70 [05:27<02:51,  7.16s/it]
Epoch 45 (train) - Loss: 0.041

 67%|█████████████████████████████████████████████████████████████████▏                               | 47/70 [05:35<02:44,  7.17s/it]
Epoch 46 (train) - Loss: 0.040
Epoch 46 (test) - Accuracy: 0.937 - F1 score: 0.963

 69%|██████████████████████████████████████████████████████████████████▌                              | 48/70 [05:42<02:39,  7.27s/it]

 70%|███████████████████████████████████████████████████████████████████▉                             | 49/70 [05:49<02:31,  7.22s/it]
Epoch 48 (train) - Loss: 0.040

 71%|█████████████████████████████████████████████████████████████████████▎                           | 50/70 [05:57<02:27,  7.35s/it]
Epoch 49 (train) - Loss: 0.040
Epoch 49 (test) - Accuracy: 0.933 - F1 score: 0.961
Epoch 50 (train) - Loss: 0.043


 74%|████████████████████████████████████████████████████████████████████████                         | 52/70 [06:11<02:08,  7.12s/it]
Epoch 51 (train) - Loss: 0.057
Epoch 51 (test) - Accuracy: 0.930 - F1 score: 0.958
Epoch 52 (train) - Loss: 0.042

 76%|█████████████████████████████████████████████████████████████████████████▍                       | 53/70 [06:18<02:00,  7.10s/it]

 77%|██████████████████████████████████████████████████████████████████████████▊                      | 54/70 [06:24<01:51,  6.97s/it]
Epoch 53 (test) - Accuracy: 0.930 - F1 score: 0.959

 79%|████████████████████████████████████████████████████████████████████████████▏                    | 55/70 [06:30<01:40,  6.67s/it]
Epoch 54 (test) - Accuracy: 0.937 - F1 score: 0.963
Epoch 55 (train) - Loss: 0.040


 81%|██████████████████████████████████████████████████████████████████████████████▉                  | 57/70 [06:41<01:19,  6.09s/it]
Epoch 56 (train) - Loss: 0.041
Epoch 56 (test) - Accuracy: 0.927 - F1 score: 0.957

 83%|████████████████████████████████████████████████████████████████████████████████▎                | 58/70 [06:48<01:15,  6.30s/it]
Epoch 57 (test) - Accuracy: 0.934 - F1 score: 0.961
Epoch 58 (train) - Loss: 0.041

 84%|█████████████████████████████████████████████████████████████████████████████████▊               | 59/70 [06:54<01:06,  6.06s/it]
Epoch 59 (train) - Loss: 0.042

 86%|███████████████████████████████████████████████████████████████████████████████████▏             | 60/70 [07:00<01:00,  6.07s/it]
Epoch 60 (train) - Loss: 0.042


 89%|█████████████████████████████████████████████████████████████████████████████████████▉           | 62/70 [07:12<00:48,  6.00s/it]
Epoch 61 (train) - Loss: 0.041

 90%|███████████████████████████████████████████████████████████████████████████████████████▎         | 63/70 [07:17<00:41,  5.89s/it]
Epoch 62 (train) - Loss: 0.041

 91%|████████████████████████████████████████████████████████████████████████████████████████▋        | 64/70 [07:25<00:37,  6.31s/it]
Epoch 63 (train) - Loss: 0.040

 93%|██████████████████████████████████████████████████████████████████████████████████████████       | 65/70 [07:31<00:31,  6.34s/it]
Epoch 64 (train) - Loss: 0.041
Epoch 64 (test) - Accuracy: 0.935 - F1 score: 0.962

 94%|███████████████████████████████████████████████████████████████████████████████████████████▍     | 66/70 [07:40<00:27,  6.98s/it]

 96%|████████████████████████████████████████████████████████████████████████████████████████████▊    | 67/70 [07:47<00:21,  7.05s/it]
Epoch 66 (train) - Loss: 0.041
Epoch 66 (test) - Accuracy: 0.931 - F1 score: 0.959
Epoch 67 (train) - Loss: 0.042

 97%|██████████████████████████████████████████████████████████████████████████████████████████████▏  | 68/70 [07:54<00:14,  7.12s/it]
Epoch 68 (train) - Loss: 0.039

 99%|███████████████████████████████████████████████████████████████████████████████████████████████▌ | 69/70 [08:02<00:07,  7.33s/it]
Epoch 69 (train) - Loss: 0.041
Epoch 69 (test) - Accuracy: 0.936 - F1 score: 0.962
Plotting the results...

100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [08:10<00:00,  7.01s/it]
Saving the model as 'ftt_model_2_raw'...
Generating the test.json file...
Done!