[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'learning_rate' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_epochs' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'weight_decay' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'depth' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'heads' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'attn_dropout' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'dim_ff' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'd_model' was locked by 'sweep' (ignored update).
  0%|                                                                                                                            | 0/70 [00:00<?, ?it/s]
Creating dataset...
Loading data from /home/usuaris/veu/gerard.calvo.bartra/nuwe/model/../data/supply_chain_train_raw.csv
Train batch 0:
{'data': tensor([[-0.5509,  0.4489, -1.0240,  ...,  0.0000,  0.0000,  0.0000],
        [-0.6452, -1.2931,  0.5180,  ...,  0.0000,  0.0000,  0.0000],
        [ 1.1308, -0.4221,  0.5180,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-0.6366,  0.4489, -0.2530,  ...,  0.0000,  0.0000,  0.0000],
        [-0.8356, -0.0489, -0.2530,  ...,  0.0000,  0.0000,  1.0000],
        [-0.4864,  2.3153, -1.0240,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1])}
Validation batch 0:
{'data': tensor([[-0.7021, -0.9862, -0.2985,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7690,  0.4015,  2.1085,  ...,  0.0000,  0.0000,  1.0000],
        [-0.7355,  0.0231, -1.1008,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-0.7259,  0.1492, -0.2985,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.4713,  0.5277,  2.1085,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7987, -0.2293,  0.5039,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 0, 1, 1])}
batch_data.shape: torch.Size([32, 38])
Percentage of positive and negative samples in the training set:
1    0.839094
0    0.160906
Name: Attrition_Flag, dtype: float64
FTTransformer(
  (numerical_embedder): NumericalEmbedder(
    (linear): Linear(in_features=38, out_features=32, bias=True)
  )
  (layers): ModuleList(
    (0-1): 2 x ModuleList(
      (0): Attention(
        (norm): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
        (to_qkv): Linear(in_features=32, out_features=96, bias=False)
        (to_out): Linear(in_features=32, out_features=32, bias=False)
        (dropout): Dropout(p=0.3367887967301192, inplace=False)
      )
      (1): Sequential(
        (0): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
        (1): Linear(in_features=32, out_features=32, bias=True)
        (2): GEGLU()
        (3): Dropout(p=0.3367887967301192, inplace=False)
        (4): Linear(in_features=16, out_features=32, bias=True)
      )
    )
  )
  (to_logits): Sequential(
    (0): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
    (1): ReLU()
    (2): Linear(in_features=32, out_features=1, bias=True)
    (3): Sigmoid()
  )
)
Num params:  12993

  1%|█▋                                                                                                                  | 1/70 [00:03<04:08,  3.59s/it]
Epoch 0 (train) - Loss: 0.086

  3%|███▎                                                                                                                | 2/70 [00:06<03:36,  3.18s/it]
Epoch 1 (train) - Loss: 0.062

  4%|████▉                                                                                                               | 3/70 [00:09<03:40,  3.29s/it]
Epoch 2 (train) - Loss: 0.060

  6%|██████▋                                                                                                             | 4/70 [00:13<03:39,  3.32s/it]
Epoch 3 (train) - Loss: 0.060

  7%|████████▎                                                                                                           | 5/70 [00:16<03:30,  3.24s/it]
Epoch 4 (train) - Loss: 0.059
Epoch 4 (test) - Accuracy: 0.911 - F1 score: 0.949

  9%|█████████▉                                                                                                          | 6/70 [00:19<03:30,  3.29s/it]

 10%|███████████▌                                                                                                        | 7/70 [00:23<03:37,  3.45s/it]
Epoch 6 (train) - Loss: 0.057

 11%|█████████████▎                                                                                                      | 8/70 [00:27<03:40,  3.56s/it]
Epoch 7 (train) - Loss: 0.055

 13%|██████████████▉                                                                                                     | 9/70 [00:31<03:41,  3.63s/it]
Epoch 8 (train) - Loss: 0.056

 14%|████████████████▍                                                                                                  | 10/70 [00:34<03:40,  3.68s/it]
Epoch 9 (train) - Loss: 0.054

 16%|██████████████████                                                                                                 | 11/70 [00:38<03:38,  3.70s/it]
Epoch 10 (train) - Loss: 0.053
Epoch 10 (test) - Accuracy: 0.919 - F1 score: 0.953
Epoch 11 (train) - Loss: 0.052

 17%|███████████████████▋                                                                                               | 12/70 [00:42<03:37,  3.76s/it]
Epoch 12 (train) - Loss: 0.054

 19%|█████████████████████▎                                                                                             | 13/70 [00:46<03:35,  3.78s/it]

 20%|███████████████████████                                                                                            | 14/70 [00:49<03:26,  3.68s/it]

 21%|████████████████████████▋                                                                                          | 15/70 [00:53<03:30,  3.82s/it]
Epoch 14 (train) - Loss: 0.051
Epoch 14 (test) - Accuracy: 0.919 - F1 score: 0.953

 23%|██████████████████████████▎                                                                                        | 16/70 [00:57<03:28,  3.85s/it]
Epoch 15 (test) - Accuracy: 0.918 - F1 score: 0.952

 24%|███████████████████████████▉                                                                                       | 17/70 [01:01<03:25,  3.88s/it]
Epoch 16 (test) - Accuracy: 0.923 - F1 score: 0.955

 26%|█████████████████████████████▌                                                                                     | 18/70 [01:05<03:21,  3.87s/it]
Epoch 17 (test) - Accuracy: 0.917 - F1 score: 0.952

 27%|███████████████████████████████▏                                                                                   | 19/70 [01:09<03:18,  3.90s/it]
Epoch 18 (test) - Accuracy: 0.922 - F1 score: 0.954
Epoch 19 (train) - Loss: 0.050

 29%|████████████████████████████████▊                                                                                  | 20/70 [01:13<03:10,  3.81s/it]
Epoch 20 (train) - Loss: 0.050

 30%|██████████████████████████████████▌                                                                                | 21/70 [01:17<03:10,  3.89s/it]
Epoch 21 (train) - Loss: 0.050

 31%|████████████████████████████████████▏                                                                              | 22/70 [01:21<03:06,  3.89s/it]
Epoch 22 (train) - Loss: 0.050

 33%|█████████████████████████████████████▊                                                                             | 23/70 [01:25<03:02,  3.88s/it]
Epoch 23 (train) - Loss: 0.050

 34%|███████████████████████████████████████▍                                                                           | 24/70 [01:28<02:53,  3.77s/it]
Epoch 24 (train) - Loss: 0.050

 36%|█████████████████████████████████████████                                                                          | 25/70 [01:32<02:54,  3.87s/it]
Epoch 25 (train) - Loss: 0.049

 37%|██████████████████████████████████████████▋                                                                        | 26/70 [01:36<02:55,  4.00s/it]
Epoch 26 (train) - Loss: 0.050

 39%|████████████████████████████████████████████▎                                                                      | 27/70 [01:40<02:50,  3.98s/it]
Epoch 27 (train) - Loss: 0.048

 40%|██████████████████████████████████████████████                                                                     | 28/70 [01:44<02:40,  3.83s/it]
Epoch 28 (train) - Loss: 0.047

 41%|███████████████████████████████████████████████▋                                                                   | 29/70 [01:48<02:37,  3.84s/it]
Epoch 29 (train) - Loss: 0.049

 43%|█████████████████████████████████████████████████▎                                                                 | 30/70 [01:52<02:37,  3.94s/it]
Epoch 30 (train) - Loss: 0.049

 44%|██████████████████████████████████████████████████▉                                                                | 31/70 [01:56<02:32,  3.90s/it]

 46%|████████████████████████████████████████████████████▌                                                              | 32/70 [01:59<02:25,  3.84s/it]
Epoch 31 (test) - Accuracy: 0.913 - F1 score: 0.949
Epoch 32 (train) - Loss: 0.049

 47%|██████████████████████████████████████████████████████▏                                                            | 33/70 [02:03<02:20,  3.80s/it]
Epoch 33 (train) - Loss: 0.049

 49%|███████████████████████████████████████████████████████▊                                                           | 34/70 [02:07<02:18,  3.84s/it]
Epoch 34 (train) - Loss: 0.049

 50%|█████████████████████████████████████████████████████████▌                                                         | 35/70 [02:11<02:17,  3.92s/it]
Epoch 35 (train) - Loss: 0.048

 51%|███████████████████████████████████████████████████████████▏                                                       | 36/70 [02:15<02:10,  3.83s/it]
Epoch 36 (train) - Loss: 0.049

 53%|████████████████████████████████████████████████████████████▊                                                      | 37/70 [02:19<02:08,  3.88s/it]
Epoch 37 (train) - Loss: 0.049

 54%|██████████████████████████████████████████████████████████████▍                                                    | 38/70 [02:23<02:04,  3.90s/it]
Epoch 38 (train) - Loss: 0.050

 56%|████████████████████████████████████████████████████████████████                                                   | 39/70 [02:27<02:00,  3.88s/it]
Epoch 39 (train) - Loss: 0.049

 57%|█████████████████████████████████████████████████████████████████▋                                                 | 40/70 [02:30<01:55,  3.84s/it]
Epoch 40 (train) - Loss: 0.048

 59%|███████████████████████████████████████████████████████████████████▎                                               | 41/70 [02:34<01:50,  3.81s/it]
Epoch 41 (train) - Loss: 0.049


 61%|██████████████████████████████████████████████████████████████████████▋                                            | 43/70 [02:42<01:43,  3.82s/it]
Epoch 42 (train) - Loss: 0.048

 63%|████████████████████████████████████████████████████████████████████████▎                                          | 44/70 [02:46<01:39,  3.83s/it]
Epoch 43 (train) - Loss: 0.048
Epoch 43 (test) - Accuracy: 0.919 - F1 score: 0.952

 64%|█████████████████████████████████████████████████████████████████████████▉                                         | 45/70 [02:50<01:37,  3.88s/it]
Epoch 44 (test) - Accuracy: 0.928 - F1 score: 0.958

 66%|███████████████████████████████████████████████████████████████████████████▌                                       | 46/70 [02:53<01:32,  3.85s/it]
Epoch 45 (test) - Accuracy: 0.924 - F1 score: 0.956

 67%|█████████████████████████████████████████████████████████████████████████████▏                                     | 47/70 [02:57<01:29,  3.88s/it]
Epoch 46 (test) - Accuracy: 0.917 - F1 score: 0.952
Epoch 47 (train) - Loss: 0.047

 69%|██████████████████████████████████████████████████████████████████████████████▊                                    | 48/70 [03:01<01:23,  3.81s/it]
Epoch 48 (train) - Loss: 0.048

 70%|████████████████████████████████████████████████████████████████████████████████▌                                  | 49/70 [03:05<01:18,  3.75s/it]
Epoch 49 (train) - Loss: 0.047

 71%|██████████████████████████████████████████████████████████████████████████████████▏                                | 50/70 [03:08<01:15,  3.76s/it]
Epoch 50 (train) - Loss: 0.048

 73%|███████████████████████████████████████████████████████████████████████████████████▊                               | 51/70 [03:12<01:12,  3.81s/it]
Epoch 51 (train) - Loss: 0.049

 74%|█████████████████████████████████████████████████████████████████████████████████████▍                             | 52/70 [03:16<01:09,  3.89s/it]
Epoch 52 (train) - Loss: 0.048


 77%|████████████████████████████████████████████████████████████████████████████████████████▋                          | 54/70 [03:24<01:00,  3.78s/it]
Epoch 53 (train) - Loss: 0.047
Epoch 53 (test) - Accuracy: 0.921 - F1 score: 0.954

 79%|██████████████████████████████████████████████████████████████████████████████████████████▎                        | 55/70 [03:27<00:56,  3.78s/it]
Epoch 54 (test) - Accuracy: 0.923 - F1 score: 0.955
Epoch 55 (train) - Loss: 0.049

 80%|████████████████████████████████████████████████████████████████████████████████████████████                       | 56/70 [03:31<00:51,  3.68s/it]
Epoch 56 (train) - Loss: 0.050

 81%|█████████████████████████████████████████████████████████████████████████████████████████████▋                     | 57/70 [03:35<00:48,  3.69s/it]
Epoch 57 (train) - Loss: 0.049

 83%|███████████████████████████████████████████████████████████████████████████████████████████████▎                   | 58/70 [03:38<00:44,  3.72s/it]
Epoch 58 (train) - Loss: 0.049

 84%|████████████████████████████████████████████████████████████████████████████████████████████████▉                  | 59/70 [03:42<00:41,  3.80s/it]
Epoch 59 (train) - Loss: 0.049

 86%|██████████████████████████████████████████████████████████████████████████████████████████████████▌                | 60/70 [03:46<00:37,  3.78s/it]

 87%|████████████████████████████████████████████████████████████████████████████████████████████████████▏              | 61/70 [03:50<00:33,  3.75s/it]
Epoch 60 (test) - Accuracy: 0.915 - F1 score: 0.951

 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 62/70 [03:53<00:29,  3.68s/it]
Epoch 61 (test) - Accuracy: 0.919 - F1 score: 0.953

 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 63/70 [03:57<00:26,  3.78s/it]
Epoch 62 (test) - Accuracy: 0.917 - F1 score: 0.952
Epoch 63 (train) - Loss: 0.048

 91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▏         | 64/70 [04:01<00:22,  3.79s/it]
Epoch 64 (train) - Loss: 0.048

 93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▊        | 65/70 [04:05<00:18,  3.72s/it]
Epoch 65 (train) - Loss: 0.048

 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▍      | 66/70 [04:08<00:14,  3.67s/it]
Epoch 66 (train) - Loss: 0.049

 96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████     | 67/70 [04:12<00:11,  3.73s/it]
Epoch 67 (train) - Loss: 0.050

 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋   | 68/70 [04:16<00:07,  3.73s/it]
Epoch 68 (train) - Loss: 0.048

 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎ | 69/70 [04:19<00:03,  3.65s/it]
Epoch 69 (train) - Loss: 0.048
Epoch 69 (test) - Accuracy: 0.917 - F1 score: 0.951
Plotting the results...
Saving the plot as 'results_ftt_model_2_raw.png'...

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [04:23<00:00,  3.76s/it]
Generating the test.json file...
Done!