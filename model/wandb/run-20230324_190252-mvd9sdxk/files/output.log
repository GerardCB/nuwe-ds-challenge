[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'learning_rate' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_epochs' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'hidden_size' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_layers' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'dropout' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'weight_decay' was locked by 'sweep' (ignored update).
  0%|                                                                                              | 0/80 [00:00<?, ?it/s]
Creating dataset...
Loading data from /home/usuaris/veu/gerard.calvo.bartra/nuwe/model/../data/supply_chain_train_balanced.csv
Train batch 0:
{'data': tensor([[-1.7650,  0.6141, -0.5574,  ...,  0.0000,  0.0000,  0.0000],
        [ 1.4631, -1.4270, -0.5574,  ...,  0.0000,  0.0000,  1.0000],
        [-0.4738,  0.6141,  0.3519,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-0.4738,  0.6141,  0.3519,  ...,  0.0000,  0.0000,  0.0000],
        [-1.7650, -1.4270, -1.4666,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.8175, -1.4270,  0.3519,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 0, 1, 1])}
Validation batch 0:
{'data': tensor([[-1.1402,  0.6459, -1.3412,  ...,  0.0000,  0.0000,  0.0000],
        [-0.4862, -0.3693,  1.1670,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.1677, -0.3693, -1.3412,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-1.1402,  0.6459,  2.0031,  ...,  0.0000,  0.0000,  0.0000],
        [-0.4862,  0.6459, -0.5051,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.1677, -0.3693,  1.1670,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1,
        1, 0, 1, 1, 1, 0, 0, 1])}
batch_data.shape: torch.Size([32, 32])
Percentage of positive and negative samples in the training set:
1    0.644696
0    0.355304
Name: Attrition_Flag, dtype: float64
BaselineNet(
  (fc): Sequential(
    (fc0): Linear(in_features=32, out_features=512, bias=True)
    (relu0): ReLU()
    (dropout0): Dropout(p=0.029123823566111807, inplace=False)
    (fc1): Linear(in_features=512, out_features=512, bias=True)
    (relu1): ReLU()
    (dropout1): Dropout(p=0.029123823566111807, inplace=False)
    (fc2): Linear(in_features=512, out_features=512, bias=True)
    (relu2): ReLU()
    (dropout2): Dropout(p=0.029123823566111807, inplace=False)
    (fc3): Linear(in_features=512, out_features=1, bias=True)
    (sigmoid): Sigmoid()
  )
)
Num params:  542721

  1%|█                                                                                     | 1/80 [00:03<04:27,  3.39s/it]
Epoch 0 (train) - Loss: 0.396

  2%|██▏                                                                                   | 2/80 [00:05<03:42,  2.86s/it]
Epoch 1 (train) - Loss: 0.296
Epoch 1 (test) - Accuracy: 0.878 - F1 score: 0.902
Epoch 2 (train) - Loss: 0.268

  4%|███▏                                                                                  | 3/80 [00:08<03:19,  2.59s/it]
Epoch 3 (train) - Loss: 0.252

  5%|████▎                                                                                 | 4/80 [00:10<03:13,  2.55s/it]
Epoch 4 (train) - Loss: 0.258

  6%|█████▍                                                                                | 5/80 [00:12<03:01,  2.42s/it]
Epoch 5 (train) - Loss: 0.249

  8%|██████▍                                                                               | 6/80 [00:15<03:03,  2.48s/it]
Epoch 6 (train) - Loss: 0.240

  9%|███████▌                                                                              | 7/80 [00:17<02:58,  2.45s/it]
Epoch 7 (train) - Loss: 0.229

 10%|████████▌                                                                             | 8/80 [00:20<02:57,  2.47s/it]
Epoch 8 (train) - Loss: 0.214

 11%|█████████▋                                                                            | 9/80 [00:22<02:53,  2.44s/it]
Epoch 9 (train) - Loss: 0.214

 12%|██████████▋                                                                          | 10/80 [00:25<02:50,  2.43s/it]
Epoch 10 (train) - Loss: 0.206

 14%|███████████▋                                                                         | 11/80 [00:27<02:47,  2.42s/it]
Epoch 11 (train) - Loss: 0.202

 15%|████████████▊                                                                        | 12/80 [00:29<02:45,  2.44s/it]
Epoch 12 (train) - Loss: 0.198

 16%|█████████████▊                                                                       | 13/80 [00:32<02:50,  2.55s/it]
Epoch 13 (train) - Loss: 0.185

 18%|██████████████▊                                                                      | 14/80 [00:35<02:58,  2.71s/it]
Epoch 14 (train) - Loss: 0.188

 19%|███████████████▉                                                                     | 15/80 [00:39<03:07,  2.89s/it]
Epoch 15 (train) - Loss: 0.172

 20%|█████████████████                                                                    | 16/80 [00:42<03:10,  2.98s/it]
Epoch 16 (train) - Loss: 0.171

 21%|██████████████████                                                                   | 17/80 [00:45<03:12,  3.06s/it]
Epoch 17 (train) - Loss: 0.164


 24%|████████████████████▏                                                                | 19/80 [00:52<03:11,  3.14s/it]
Epoch 18 (train) - Loss: 0.185
Epoch 18 (test) - Accuracy: 0.926 - F1 score: 0.943
Epoch 19 (train) - Loss: 0.165

 25%|█████████████████████▎                                                               | 20/80 [00:55<03:12,  3.20s/it]
Epoch 20 (train) - Loss: 0.155

 26%|██████████████████████▎                                                              | 21/80 [00:58<03:08,  3.20s/it]

 28%|███████████████████████▍                                                             | 22/80 [01:01<03:05,  3.20s/it]
Epoch 21 (test) - Accuracy: 0.888 - F1 score: 0.918
Epoch 22 (train) - Loss: 0.145

 29%|████████████████████████▍                                                            | 23/80 [01:04<03:02,  3.20s/it]
Epoch 23 (train) - Loss: 0.150

 30%|█████████████████████████▌                                                           | 24/80 [01:08<03:00,  3.22s/it]
Epoch 24 (train) - Loss: 0.145

 31%|██████████████████████████▌                                                          | 25/80 [01:11<02:57,  3.23s/it]
Epoch 25 (train) - Loss: 0.158


 34%|████████████████████████████▋                                                        | 27/80 [01:17<02:50,  3.22s/it]
Epoch 26 (train) - Loss: 0.140
Epoch 26 (test) - Accuracy: 0.918 - F1 score: 0.937
Epoch 27 (train) - Loss: 0.139


 36%|██████████████████████████████▊                                                      | 29/80 [01:24<02:41,  3.16s/it]
Epoch 28 (train) - Loss: 0.143
Epoch 28 (test) - Accuracy: 0.920 - F1 score: 0.936
Epoch 29 (train) - Loss: 0.124

 38%|███████████████████████████████▉                                                     | 30/80 [01:27<02:38,  3.18s/it]
Epoch 30 (train) - Loss: 0.129

 39%|████████████████████████████████▉                                                    | 31/80 [01:30<02:35,  3.17s/it]
Epoch 31 (train) - Loss: 0.134

 40%|██████████████████████████████████                                                   | 32/80 [01:33<02:31,  3.16s/it]
Epoch 32 (train) - Loss: 0.131

 41%|███████████████████████████████████                                                  | 33/80 [01:36<02:30,  3.20s/it]
Epoch 33 (train) - Loss: 0.126

 42%|████████████████████████████████████▏                                                | 34/80 [01:40<02:28,  3.23s/it]
Epoch 34 (train) - Loss: 0.139

 44%|█████████████████████████████████████▏                                               | 35/80 [01:43<02:23,  3.20s/it]
Epoch 35 (train) - Loss: 0.128

 45%|██████████████████████████████████████▎                                              | 36/80 [01:46<02:21,  3.22s/it]
Epoch 36 (train) - Loss: 0.117

 46%|███████████████████████████████████████▎                                             | 37/80 [01:49<02:18,  3.21s/it]
Epoch 37 (train) - Loss: 0.106

 48%|████████████████████████████████████████▍                                            | 38/80 [01:53<02:14,  3.20s/it]
Epoch 38 (train) - Loss: 0.130

 49%|█████████████████████████████████████████▍                                           | 39/80 [01:56<02:12,  3.24s/it]
Epoch 39 (train) - Loss: 0.126

 50%|██████████████████████████████████████████▌                                          | 40/80 [01:59<02:09,  3.24s/it]
Epoch 40 (train) - Loss: 0.119

 51%|███████████████████████████████████████████▌                                         | 41/80 [02:02<02:06,  3.24s/it]
Epoch 41 (train) - Loss: 0.122

 52%|████████████████████████████████████████████▋                                        | 42/80 [02:06<02:02,  3.23s/it]
Epoch 42 (train) - Loss: 0.117

 54%|█████████████████████████████████████████████▋                                       | 43/80 [02:09<02:00,  3.27s/it]
Epoch 43 (train) - Loss: 0.116

 55%|██████████████████████████████████████████████▊                                      | 44/80 [02:12<01:54,  3.18s/it]
Epoch 44 (train) - Loss: 0.113

 56%|███████████████████████████████████████████████▊                                     | 45/80 [02:15<01:51,  3.18s/it]
Epoch 45 (train) - Loss: 0.122

 57%|████████████████████████████████████████████████▊                                    | 46/80 [02:18<01:48,  3.20s/it]
Epoch 46 (train) - Loss: 0.119

 59%|█████████████████████████████████████████████████▉                                   | 47/80 [02:22<01:45,  3.21s/it]
Epoch 47 (train) - Loss: 0.115

 60%|███████████████████████████████████████████████████                                  | 48/80 [02:25<01:47,  3.35s/it]
Epoch 48 (train) - Loss: 0.119

 61%|████████████████████████████████████████████████████                                 | 49/80 [02:35<02:46,  5.36s/it]
Epoch 49 (train) - Loss: 0.103

 62%|█████████████████████████████████████████████████████▏                               | 50/80 [02:44<03:09,  6.32s/it]
Epoch 50 (train) - Loss: 0.114

 64%|██████████████████████████████████████████████████████▏                              | 51/80 [02:47<02:36,  5.39s/it]
Epoch 51 (train) - Loss: 0.107

 65%|███████████████████████████████████████████████████████▎                             | 52/80 [02:50<02:13,  4.77s/it]
Epoch 52 (train) - Loss: 0.118

 66%|████████████████████████████████████████████████████████▎                            | 53/80 [02:53<01:54,  4.25s/it]
Epoch 53 (train) - Loss: 0.106

 68%|█████████████████████████████████████████████████████████▍                           | 54/80 [02:57<01:41,  3.92s/it]
Epoch 54 (train) - Loss: 0.112

 69%|██████████████████████████████████████████████████████████▍                          | 55/80 [02:59<01:30,  3.61s/it]
Epoch 55 (train) - Loss: 0.111

 70%|███████████████████████████████████████████████████████████▍                         | 56/80 [03:03<01:25,  3.55s/it]
Epoch 56 (train) - Loss: 0.105

 71%|████████████████████████████████████████████████████████████▌                        | 57/80 [03:06<01:20,  3.51s/it]
Epoch 57 (train) - Loss: 0.098

 72%|█████████████████████████████████████████████████████████████▋                       | 58/80 [03:11<01:22,  3.74s/it]
Epoch 58 (train) - Loss: 0.112

 74%|██████████████████████████████████████████████████████████████▋                      | 59/80 [03:14<01:17,  3.69s/it]
Epoch 59 (train) - Loss: 0.102


 76%|████████████████████████████████████████████████████████████████▊                    | 61/80 [03:30<01:45,  5.54s/it]
Epoch 60 (train) - Loss: 0.113
Epoch 60 (test) - Accuracy: 0.928 - F1 score: 0.944
Epoch 61 (train) - Loss: 0.117

 78%|█████████████████████████████████████████████████████████████████▉                   | 62/80 [03:33<01:27,  4.85s/it]
Epoch 62 (train) - Loss: 0.096

 79%|██████████████████████████████████████████████████████████████████▉                  | 63/80 [03:39<01:26,  5.11s/it]
Epoch 63 (train) - Loss: 0.116

 80%|████████████████████████████████████████████████████████████████████                 | 64/80 [03:47<01:36,  6.02s/it]
Epoch 64 (train) - Loss: 0.103

 81%|█████████████████████████████████████████████████████████████████████                | 65/80 [03:55<01:39,  6.61s/it]
Epoch 65 (train) - Loss: 0.098

 82%|██████████████████████████████████████████████████████████████████████▏              | 66/80 [03:58<01:19,  5.65s/it]
Epoch 66 (train) - Loss: 0.108

 84%|███████████████████████████████████████████████████████████████████████▏             | 67/80 [04:01<01:02,  4.84s/it]
Epoch 67 (train) - Loss: 0.105

 85%|████████████████████████████████████████████████████████████████████████▎            | 68/80 [04:08<01:06,  5.50s/it]
Epoch 68 (train) - Loss: 0.116

 86%|█████████████████████████████████████████████████████████████████████████▎           | 69/80 [04:13<00:57,  5.26s/it]

 88%|██████████████████████████████████████████████████████████████████████████▍          | 70/80 [04:18<00:50,  5.04s/it]
Epoch 69 (test) - Accuracy: 0.925 - F1 score: 0.941
Epoch 70 (train) - Loss: 0.106

 89%|███████████████████████████████████████████████████████████████████████████▍         | 71/80 [04:21<00:40,  4.49s/it]
Epoch 71 (train) - Loss: 0.086

 90%|████████████████████████████████████████████████████████████████████████████▌        | 72/80 [04:24<00:31,  3.99s/it]
Epoch 72 (train) - Loss: 0.099

 91%|█████████████████████████████████████████████████████████████████████████████▌       | 73/80 [04:27<00:27,  3.87s/it]
Epoch 73 (train) - Loss: 0.115

 92%|██████████████████████████████████████████████████████████████████████████████▋      | 74/80 [04:31<00:22,  3.71s/it]
Epoch 74 (train) - Loss: 0.101

 94%|███████████████████████████████████████████████████████████████████████████████▋     | 75/80 [04:33<00:17,  3.43s/it]
Epoch 75 (train) - Loss: 0.097

 95%|████████████████████████████████████████████████████████████████████████████████▊    | 76/80 [04:37<00:13,  3.37s/it]
Epoch 76 (train) - Loss: 0.096

 96%|█████████████████████████████████████████████████████████████████████████████████▊   | 77/80 [04:39<00:09,  3.22s/it]
Epoch 77 (train) - Loss: 0.105

 98%|██████████████████████████████████████████████████████████████████████████████████▉  | 78/80 [04:43<00:06,  3.23s/it]
Epoch 78 (train) - Loss: 0.087

 99%|███████████████████████████████████████████████████████████████████████████████████▉ | 79/80 [04:46<00:03,  3.13s/it]
Epoch 79 (train) - Loss: 0.103
Epoch 79 (test) - Accuracy: 0.929 - F1 score: 0.944
Plotting the results...
Saving the plot as 'results_baseline_model_2_balanced.png'...
Saving the model as 'baseline_model_2_balanced'...

100%|█████████████████████████████████████████████████████████████████████████████████████| 80/80 [04:49<00:00,  3.62s/it]
Done!