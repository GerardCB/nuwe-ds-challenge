[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'learning_rate' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_epochs' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'weight_decay' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'depth' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'heads' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'attn_dropout' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'dim_ff' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'd_model' was locked by 'sweep' (ignored update).
  0%|                                                                                                                            | 0/90 [00:00<?, ?it/s]
Creating dataset...
Loading data from /home/usuaris/veu/gerard.calvo.bartra/nuwe/model/../data/supply_chain_train_raw.csv
Train batch 0:
{'data': tensor([[-0.8313, -0.7954, -1.0240,  ...,  0.0000,  0.0000,  0.0000],
        [-0.6961,  0.4489, -1.7950,  ...,  0.0000,  0.0000,  0.0000],
        [-0.6603, -0.4221,  1.2890,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-0.5924,  0.5733,  0.5180,  ...,  1.0000,  0.0000,  0.0000],
        [-0.7448,  1.1954, -0.2530,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7129, -0.1733, -0.2530,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1])}
Validation batch 0:
{'data': tensor([[-0.7021, -0.9862, -0.2985,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7690,  0.4015,  2.1085,  ...,  0.0000,  0.0000,  1.0000],
        [-0.7355,  0.0231, -1.1008,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-0.7259,  0.1492, -0.2985,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.4713,  0.5277,  2.1085,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7987, -0.2293,  0.5039,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 0, 1, 1])}
batch_data.shape: torch.Size([32, 38])
Percentage of positive and negative samples in the training set:
1    0.839094
0    0.160906
Name: Attrition_Flag, dtype: float64
FTTransformer(
  (numerical_embedder): NumericalEmbedder(
    (linear): Linear(in_features=38, out_features=32, bias=True)
  )
  (layers): ModuleList(
    (0): ModuleList(
      (0): Attention(
        (norm): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
        (to_qkv): Linear(in_features=32, out_features=96, bias=False)
        (to_out): Linear(in_features=32, out_features=32, bias=False)
        (dropout): Dropout(p=0.44521198713841326, inplace=False)
      )
      (1): Sequential(
        (0): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
        (1): Linear(in_features=32, out_features=512, bias=True)
        (2): GEGLU()
        (3): Dropout(p=0.44521198713841326, inplace=False)
        (4): Linear(in_features=256, out_features=32, bias=True)
      )
    )
  )
  (to_logits): Sequential(
    (0): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
    (1): ReLU()
    (2): Linear(in_features=32, out_features=1, bias=True)
    (3): Sigmoid()
  )
)
Num params:  30689

  1%|█▎                                                                                                                  | 1/90 [00:02<04:10,  2.81s/it]
Epoch 0 (train) - Loss: 0.100

  2%|██▌                                                                                                                 | 2/90 [00:05<04:03,  2.76s/it]
Epoch 1 (train) - Loss: 0.068

  3%|███▊                                                                                                                | 3/90 [00:07<03:41,  2.55s/it]
Epoch 2 (train) - Loss: 0.063

  4%|█████▏                                                                                                              | 4/90 [00:10<03:54,  2.72s/it]
Epoch 3 (train) - Loss: 0.061

  6%|██████▍                                                                                                             | 5/90 [00:13<03:51,  2.72s/it]
Epoch 4 (train) - Loss: 0.061

  7%|███████▋                                                                                                            | 6/90 [00:15<03:38,  2.60s/it]
Epoch 5 (train) - Loss: 0.058

  8%|█████████                                                                                                           | 7/90 [00:18<03:34,  2.58s/it]
Epoch 6 (train) - Loss: 0.057

  9%|██████████▎                                                                                                         | 8/90 [00:21<03:39,  2.67s/it]
Epoch 7 (train) - Loss: 0.056

 10%|███████████▌                                                                                                        | 9/90 [00:24<03:42,  2.75s/it]
Epoch 8 (train) - Loss: 0.058

 11%|████████████▊                                                                                                      | 10/90 [00:27<03:48,  2.85s/it]
Epoch 9 (train) - Loss: 0.056

 12%|██████████████                                                                                                     | 11/90 [00:30<03:57,  3.01s/it]
Epoch 10 (train) - Loss: 0.054

 13%|███████████████▎                                                                                                   | 12/90 [00:33<03:50,  2.96s/it]
Epoch 11 (train) - Loss: 0.054

 14%|████████████████▌                                                                                                  | 13/90 [00:36<03:49,  2.98s/it]
Epoch 12 (train) - Loss: 0.053
Epoch 12 (test) - Accuracy: 0.914 - F1 score: 0.950
Epoch 13 (train) - Loss: 0.051

 16%|█████████████████▉                                                                                                 | 14/90 [00:39<03:36,  2.85s/it]
Epoch 14 (train) - Loss: 0.052


 18%|████████████████████▍                                                                                              | 16/90 [00:44<03:26,  2.78s/it]
Epoch 15 (train) - Loss: 0.051

 19%|█████████████████████▋                                                                                             | 17/90 [00:46<03:16,  2.69s/it]
Epoch 16 (train) - Loss: 0.051

 20%|███████████████████████                                                                                            | 18/90 [00:49<03:12,  2.68s/it]
Epoch 17 (train) - Loss: 0.051

 21%|████████████████████████▎                                                                                          | 19/90 [00:52<03:23,  2.87s/it]
Epoch 18 (train) - Loss: 0.050
Epoch 18 (test) - Accuracy: 0.918 - F1 score: 0.952
Epoch 19 (train) - Loss: 0.049

 22%|█████████████████████████▌                                                                                         | 20/90 [00:55<03:17,  2.82s/it]
Epoch 20 (train) - Loss: 0.049

 23%|██████████████████████████▊                                                                                        | 21/90 [00:58<03:18,  2.88s/it]
Epoch 21 (train) - Loss: 0.048

 24%|████████████████████████████                                                                                       | 22/90 [01:01<03:13,  2.84s/it]
Epoch 22 (train) - Loss: 0.048

 26%|█████████████████████████████▍                                                                                     | 23/90 [01:04<03:06,  2.78s/it]
Epoch 23 (train) - Loss: 0.048

 27%|██████████████████████████████▋                                                                                    | 24/90 [01:07<03:11,  2.91s/it]
Epoch 24 (train) - Loss: 0.048

 28%|███████████████████████████████▉                                                                                   | 25/90 [01:10<03:10,  2.93s/it]
Epoch 25 (train) - Loss: 0.049

 29%|█████████████████████████████████▏                                                                                 | 26/90 [01:12<03:04,  2.89s/it]
Epoch 26 (train) - Loss: 0.047

 30%|██████████████████████████████████▌                                                                                | 27/90 [01:15<02:57,  2.82s/it]
Epoch 27 (train) - Loss: 0.047

 31%|███████████████████████████████████▊                                                                               | 28/90 [01:18<02:54,  2.81s/it]
Epoch 28 (train) - Loss: 0.048

 32%|█████████████████████████████████████                                                                              | 29/90 [01:21<02:50,  2.80s/it]
Epoch 29 (train) - Loss: 0.046

 33%|██████████████████████████████████████▎                                                                            | 30/90 [01:24<02:48,  2.81s/it]
Epoch 30 (train) - Loss: 0.046

 34%|███████████████████████████████████████▌                                                                           | 31/90 [01:26<02:39,  2.71s/it]
Epoch 31 (train) - Loss: 0.047

 36%|████████████████████████████████████████▉                                                                          | 32/90 [01:29<02:44,  2.83s/it]
Epoch 32 (train) - Loss: 0.046

 37%|██████████████████████████████████████████▏                                                                        | 33/90 [01:32<02:37,  2.76s/it]
Epoch 33 (train) - Loss: 0.046

 38%|███████████████████████████████████████████▍                                                                       | 34/90 [01:35<02:38,  2.82s/it]
Epoch 34 (train) - Loss: 0.046

 39%|████████████████████████████████████████████▋                                                                      | 35/90 [01:37<02:30,  2.74s/it]
Epoch 35 (train) - Loss: 0.047

 40%|██████████████████████████████████████████████                                                                     | 36/90 [01:40<02:31,  2.80s/it]
Epoch 36 (train) - Loss: 0.046

 41%|███████████████████████████████████████████████▎                                                                   | 37/90 [01:43<02:24,  2.73s/it]
Epoch 37 (train) - Loss: 0.046

 42%|████████████████████████████████████████████████▌                                                                  | 38/90 [01:46<02:28,  2.85s/it]
Epoch 38 (train) - Loss: 0.045

 43%|█████████████████████████████████████████████████▊                                                                 | 39/90 [01:49<02:32,  2.98s/it]
Epoch 39 (train) - Loss: 0.045

 44%|███████████████████████████████████████████████████                                                                | 40/90 [01:52<02:24,  2.89s/it]
Epoch 40 (train) - Loss: 0.045

 46%|████████████████████████████████████████████████████▍                                                              | 41/90 [01:55<02:26,  2.99s/it]
Epoch 41 (train) - Loss: 0.047

 47%|█████████████████████████████████████████████████████▋                                                             | 42/90 [01:58<02:21,  2.95s/it]
Epoch 42 (train) - Loss: 0.047

 48%|██████████████████████████████████████████████████████▉                                                            | 43/90 [02:01<02:18,  2.95s/it]
Epoch 43 (train) - Loss: 0.047

 49%|████████████████████████████████████████████████████████▏                                                          | 44/90 [02:04<02:14,  2.91s/it]
Epoch 44 (train) - Loss: 0.045

 50%|█████████████████████████████████████████████████████████▌                                                         | 45/90 [02:07<02:12,  2.93s/it]
Epoch 45 (train) - Loss: 0.046

 51%|██████████████████████████████████████████████████████████▊                                                        | 46/90 [02:09<02:04,  2.84s/it]
Epoch 46 (train) - Loss: 0.045

 52%|████████████████████████████████████████████████████████████                                                       | 47/90 [02:12<02:01,  2.83s/it]
Epoch 47 (train) - Loss: 0.045

 53%|█████████████████████████████████████████████████████████████▎                                                     | 48/90 [02:15<01:59,  2.83s/it]
Epoch 48 (train) - Loss: 0.045

 54%|██████████████████████████████████████████████████████████████▌                                                    | 49/90 [02:18<01:53,  2.76s/it]
Epoch 49 (train) - Loss: 0.046

 56%|███████████████████████████████████████████████████████████████▉                                                   | 50/90 [02:20<01:52,  2.81s/it]
Epoch 50 (train) - Loss: 0.045

 57%|█████████████████████████████████████████████████████████████████▏                                                 | 51/90 [02:23<01:45,  2.70s/it]
Epoch 51 (train) - Loss: 0.045

 58%|██████████████████████████████████████████████████████████████████▍                                                | 52/90 [02:26<01:47,  2.82s/it]
Epoch 52 (train) - Loss: 0.045

 59%|███████████████████████████████████████████████████████████████████▋                                               | 53/90 [02:29<01:43,  2.80s/it]
Epoch 53 (train) - Loss: 0.045

 60%|█████████████████████████████████████████████████████████████████████                                              | 54/90 [02:32<01:40,  2.78s/it]
Epoch 54 (train) - Loss: 0.044

 61%|██████████████████████████████████████████████████████████████████████▎                                            | 55/90 [02:35<01:41,  2.89s/it]
Epoch 55 (train) - Loss: 0.047

 62%|███████████████████████████████████████████████████████████████████████▌                                           | 56/90 [02:38<01:38,  2.89s/it]
Epoch 56 (train) - Loss: 0.046

 63%|████████████████████████████████████████████████████████████████████████▊                                          | 57/90 [02:40<01:33,  2.84s/it]
Epoch 57 (train) - Loss: 0.045

 64%|██████████████████████████████████████████████████████████████████████████                                         | 58/90 [02:43<01:32,  2.88s/it]
Epoch 58 (train) - Loss: 0.044

 66%|███████████████████████████████████████████████████████████████████████████▍                                       | 59/90 [02:46<01:26,  2.80s/it]
Epoch 59 (train) - Loss: 0.045

 67%|████████████████████████████████████████████████████████████████████████████▋                                      | 60/90 [02:49<01:25,  2.86s/it]
Epoch 60 (train) - Loss: 0.046

 68%|█████████████████████████████████████████████████████████████████████████████▉                                     | 61/90 [02:52<01:22,  2.83s/it]
Epoch 61 (train) - Loss: 0.045

 69%|███████████████████████████████████████████████████████████████████████████████▏                                   | 62/90 [02:54<01:19,  2.83s/it]
Epoch 62 (train) - Loss: 0.046

 70%|████████████████████████████████████████████████████████████████████████████████▌                                  | 63/90 [02:57<01:14,  2.77s/it]
Epoch 63 (train) - Loss: 0.044

 71%|█████████████████████████████████████████████████████████████████████████████████▊                                 | 64/90 [03:00<01:16,  2.92s/it]
Epoch 64 (train) - Loss: 0.044

 72%|███████████████████████████████████████████████████████████████████████████████████                                | 65/90 [03:03<01:11,  2.88s/it]
Epoch 65 (train) - Loss: 0.044

 73%|████████████████████████████████████████████████████████████████████████████████████▎                              | 66/90 [03:06<01:09,  2.91s/it]
Epoch 66 (train) - Loss: 0.045

 74%|█████████████████████████████████████████████████████████████████████████████████████▌                             | 67/90 [03:09<01:08,  2.99s/it]
Epoch 67 (train) - Loss: 0.046

 76%|██████████████████████████████████████████████████████████████████████████████████████▉                            | 68/90 [03:12<01:02,  2.83s/it]
Epoch 68 (train) - Loss: 0.046

 77%|████████████████████████████████████████████████████████████████████████████████████████▏                          | 69/90 [03:15<01:00,  2.89s/it]
Epoch 69 (train) - Loss: 0.045

 78%|█████████████████████████████████████████████████████████████████████████████████████████▍                         | 70/90 [03:17<00:55,  2.76s/it]
Epoch 70 (train) - Loss: 0.046

 79%|██████████████████████████████████████████████████████████████████████████████████████████▋                        | 71/90 [03:20<00:53,  2.81s/it]
Epoch 71 (train) - Loss: 0.045

 80%|████████████████████████████████████████████████████████████████████████████████████████████                       | 72/90 [03:23<00:49,  2.75s/it]
Epoch 72 (train) - Loss: 0.043

 81%|█████████████████████████████████████████████████████████████████████████████████████████████▎                     | 73/90 [03:26<00:47,  2.81s/it]
Epoch 73 (train) - Loss: 0.046

 82%|██████████████████████████████████████████████████████████████████████████████████████████████▌                    | 74/90 [03:29<00:45,  2.86s/it]
Epoch 74 (train) - Loss: 0.044

 83%|███████████████████████████████████████████████████████████████████████████████████████████████▊                   | 75/90 [03:32<00:43,  2.93s/it]
Epoch 75 (train) - Loss: 0.044

 84%|█████████████████████████████████████████████████████████████████████████████████████████████████                  | 76/90 [03:35<00:41,  2.98s/it]
Epoch 76 (train) - Loss: 0.044

 86%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                | 77/90 [03:37<00:37,  2.86s/it]
Epoch 77 (train) - Loss: 0.046

 87%|███████████████████████████████████████████████████████████████████████████████████████████████████▋               | 78/90 [03:40<00:34,  2.89s/it]
Epoch 78 (train) - Loss: 0.045

 88%|████████████████████████████████████████████████████████████████████████████████████████████████████▉              | 79/90 [03:43<00:30,  2.76s/it]
Epoch 79 (train) - Loss: 0.044

 89%|██████████████████████████████████████████████████████████████████████████████████████████████████████▏            | 80/90 [03:46<00:28,  2.81s/it]
Epoch 80 (train) - Loss: 0.045

 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 81/90 [03:48<00:24,  2.71s/it]
Epoch 81 (train) - Loss: 0.044

 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████▊          | 82/90 [03:51<00:22,  2.77s/it]
Epoch 82 (train) - Loss: 0.044

 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████         | 83/90 [03:54<00:19,  2.74s/it]
Epoch 83 (train) - Loss: 0.046

 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▎       | 84/90 [03:57<00:16,  2.76s/it]
Epoch 84 (train) - Loss: 0.044

 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 85/90 [04:00<00:13,  2.78s/it]
Epoch 85 (train) - Loss: 0.044

 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▉     | 86/90 [04:02<00:11,  2.80s/it]
Epoch 86 (train) - Loss: 0.044

 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏   | 87/90 [04:05<00:08,  2.75s/it]
Epoch 87 (train) - Loss: 0.044

 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍  | 88/90 [04:08<00:05,  2.81s/it]
Epoch 88 (train) - Loss: 0.044

 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋ | 89/90 [04:11<00:02,  2.89s/it]
Epoch 89 (train) - Loss: 0.044
Epoch 89 (test) - Accuracy: 0.916 - F1 score: 0.952
Plotting the results...
Saving the plot as 'results_ftt_model_2_raw.png'...
Saving the model as 'ftt_model_2_raw'...

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [04:14<00:00,  2.82s/it]
Done!