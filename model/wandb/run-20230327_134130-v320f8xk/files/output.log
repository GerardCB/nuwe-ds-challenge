[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'learning_rate' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_epochs' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'weight_decay' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'depth' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'heads' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'attn_dropout' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'dim_ff' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'd_model' was locked by 'sweep' (ignored update).
  0%|                                                                                                                            | 0/30 [00:00<?, ?it/s]
Creating dataset...
Loading data from /home/usuaris/veu/gerard.calvo.bartra/nuwe/model/../data/supply_chain_train_raw.csv
Train batch 0:
{'data': tensor([[ 1.8339,  0.2000,  0.5180,  ...,  0.0000,  0.0000,  0.0000],
        [-0.6604, -0.4221, -0.2530,  ...,  0.0000,  0.0000,  0.0000],
        [-0.5913,  1.4443,  0.5180,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-0.5511,  2.1908, -1.0240,  ...,  0.0000,  0.0000,  0.0000],
        [-0.5512,  0.9466, -0.2530,  ...,  0.0000,  0.0000,  0.0000],
        [ 1.3489, -0.4221,  0.5180,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1,
        0, 1, 0, 1, 1, 1, 0, 1])}
Validation batch 0:
{'data': tensor([[-0.7021, -0.9862, -0.2985,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7690,  0.4015,  2.1085,  ...,  0.0000,  0.0000,  1.0000],
        [-0.7355,  0.0231, -1.1008,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-0.7259,  0.1492, -0.2985,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.4713,  0.5277,  2.1085,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7987, -0.2293,  0.5039,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 0, 1, 1])}
batch_data.shape: torch.Size([32, 38])
Percentage of positive and negative samples in the training set:
1    0.839094
0    0.160906
Name: Attrition_Flag, dtype: float64
FTTransformer(
  (numerical_embedder): NumericalEmbedder(
    (linear): Linear(in_features=38, out_features=16, bias=True)
  )
  (layers): ModuleList(
    (0-2): 3 x ModuleList(
      (0): Attention(
        (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)
        (to_qkv): Linear(in_features=16, out_features=48, bias=False)
        (to_out): Linear(in_features=16, out_features=16, bias=False)
        (dropout): Dropout(p=0.014931638826985838, inplace=False)
      )
      (1): Sequential(
        (0): LayerNorm((16,), eps=1e-05, elementwise_affine=True)
        (1): Linear(in_features=16, out_features=128, bias=True)
        (2): GEGLU()
        (3): Dropout(p=0.014931638826985838, inplace=False)
        (4): Linear(in_features=64, out_features=16, bias=True)
      )
    )
  )
  (to_logits): Sequential(
    (0): LayerNorm((16,), eps=1e-05, elementwise_affine=True)
    (1): ReLU()
    (2): Linear(in_features=16, out_features=1, bias=True)
    (3): Sigmoid()
  )
)
Num params:  13585

  3%|███▊                                                                                                                | 1/30 [00:03<01:54,  3.94s/it]
Epoch 0 (train) - Loss: 0.086

  7%|███████▋                                                                                                            | 2/30 [00:08<01:52,  4.03s/it]
Epoch 1 (train) - Loss: 0.062

 10%|███████████▌                                                                                                        | 3/30 [00:11<01:44,  3.86s/it]
Epoch 2 (train) - Loss: 0.062

 13%|███████████████▍                                                                                                    | 4/30 [00:15<01:42,  3.95s/it]
Epoch 3 (train) - Loss: 0.059

 17%|███████████████████▎                                                                                                | 5/30 [00:19<01:37,  3.91s/it]
Epoch 4 (train) - Loss: 0.058

 20%|███████████████████████▏                                                                                            | 6/30 [00:23<01:34,  3.94s/it]
Epoch 5 (train) - Loss: 0.057

 23%|███████████████████████████                                                                                         | 7/30 [00:27<01:31,  3.98s/it]
Epoch 6 (train) - Loss: 0.056
Epoch 6 (test) - Accuracy: 0.913 - F1 score: 0.949
Epoch 7 (train) - Loss: 0.055

 27%|██████████████████████████████▉                                                                                     | 8/30 [00:31<01:29,  4.08s/it]
Epoch 8 (train) - Loss: 0.056

 30%|██████████████████████████████████▊                                                                                 | 9/30 [00:36<01:25,  4.08s/it]
Epoch 9 (train) - Loss: 0.054

 33%|██████████████████████████████████████▎                                                                            | 10/30 [00:39<01:19,  4.00s/it]
Epoch 10 (train) - Loss: 0.054

 37%|██████████████████████████████████████████▏                                                                        | 11/30 [00:44<01:17,  4.06s/it]
Epoch 11 (train) - Loss: 0.054

 40%|██████████████████████████████████████████████                                                                     | 12/30 [00:47<01:11,  3.99s/it]
Epoch 12 (train) - Loss: 0.053

 43%|█████████████████████████████████████████████████▊                                                                 | 13/30 [00:51<01:06,  3.94s/it]
Epoch 13 (train) - Loss: 0.053

 47%|█████████████████████████████████████████████████████▋                                                             | 14/30 [00:55<01:01,  3.86s/it]
Epoch 14 (train) - Loss: 0.051

 50%|█████████████████████████████████████████████████████████▌                                                         | 15/30 [00:59<00:58,  3.92s/it]
Epoch 15 (train) - Loss: 0.052

 53%|█████████████████████████████████████████████████████████████▎                                                     | 16/30 [01:03<00:55,  3.96s/it]
Epoch 16 (train) - Loss: 0.051

 57%|█████████████████████████████████████████████████████████████████▏                                                 | 17/30 [01:07<00:50,  3.90s/it]
Epoch 17 (train) - Loss: 0.052

 60%|█████████████████████████████████████████████████████████████████████                                              | 18/30 [01:11<00:48,  4.02s/it]

 63%|████████████████████████████████████████████████████████████████████████▊                                          | 19/30 [01:15<00:44,  4.08s/it]
Epoch 18 (test) - Accuracy: 0.914 - F1 score: 0.950

 67%|████████████████████████████████████████████████████████████████████████████▋                                      | 20/30 [01:19<00:41,  4.11s/it]
Epoch 19 (test) - Accuracy: 0.914 - F1 score: 0.951
Epoch 20 (train) - Loss: 0.051

 70%|████████████████████████████████████████████████████████████████████████████████▌                                  | 21/30 [01:24<00:38,  4.28s/it]
Epoch 21 (train) - Loss: 0.052

 73%|████████████████████████████████████████████████████████████████████████████████████▎                              | 22/30 [01:28<00:34,  4.27s/it]
Epoch 22 (train) - Loss: 0.052

 77%|████████████████████████████████████████████████████████████████████████████████████████▏                          | 23/30 [01:33<00:30,  4.30s/it]

 80%|████████████████████████████████████████████████████████████████████████████████████████████                       | 24/30 [01:37<00:26,  4.34s/it]

 83%|███████████████████████████████████████████████████████████████████████████████████████████████▊                   | 25/30 [01:42<00:21,  4.38s/it]
Epoch 24 (train) - Loss: 0.051
Epoch 24 (test) - Accuracy: 0.914 - F1 score: 0.949
Epoch 25 (train) - Loss: 0.050

 87%|███████████████████████████████████████████████████████████████████████████████████████████████████▋               | 26/30 [01:46<00:17,  4.38s/it]
Epoch 26 (train) - Loss: 0.051

 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 27/30 [01:51<00:13,  4.41s/it]
Epoch 27 (train) - Loss: 0.051

 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▎       | 28/30 [01:54<00:08,  4.24s/it]
Epoch 28 (train) - Loss: 0.049

 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏   | 29/30 [01:59<00:04,  4.28s/it]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [02:04<00:00,  4.14s/it]
Epoch 29 (test) - Accuracy: 0.916 - F1 score: 0.951
Plotting the results...
Saving the plot as 'results_ftt_model_2_raw.png'...
Saving the model as 'ftt_model_2_raw'...
Generating the test.json file...
Done!