[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'learning_rate' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_epochs' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'hidden_size' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_layers' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'dropout' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'weight_decay' was locked by 'sweep' (ignored update).
  0%|                                                                                              | 0/50 [00:00<?, ?it/s]
Creating dataset...
Loading data from /home/usuaris/veu/gerard.calvo.bartra/nuwe/model/../data/supply_chain_train_balanced.csv
Train batch 0:
{'data': tensor([[-1.7650,  0.6141,  0.3519,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.8175, -0.4065, -0.5574,  ...,  0.0000,  0.0000,  0.0000],
        [-0.4738, -0.4065,  1.2611,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-1.1194,  0.6141, -0.5574,  ...,  0.0000,  0.0000,  0.0000],
        [ 1.4631, -1.4270, -0.5574,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.1719,  0.6141,  0.3519,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1,
        0, 1, 1, 1, 1, 1, 1, 1])}
Validation batch 0:
{'data': tensor([[-1.1402,  0.6459, -1.3412,  ...,  0.0000,  0.0000,  0.0000],
        [-0.4862, -0.3693,  1.1670,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.1677, -0.3693, -1.3412,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-1.1402,  0.6459,  2.0031,  ...,  0.0000,  0.0000,  0.0000],
        [-0.4862,  0.6459, -0.5051,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.1677, -0.3693,  1.1670,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1,
        1, 0, 1, 1, 1, 0, 0, 1])}
batch_data.shape: torch.Size([32, 32])
Percentage of positive and negative samples in the training set:
1    0.644696
0    0.355304
Name: Attrition_Flag, dtype: float64
BaselineNet(
  (fc): Sequential(
    (fc0): Linear(in_features=32, out_features=32, bias=True)
    (relu0): ReLU()
    (dropout0): Dropout(p=0.22409083569863172, inplace=False)
    (fc1): Linear(in_features=32, out_features=32, bias=True)
    (relu1): ReLU()
    (dropout1): Dropout(p=0.22409083569863172, inplace=False)
    (fc2): Linear(in_features=32, out_features=32, bias=True)
    (relu2): ReLU()
    (dropout2): Dropout(p=0.22409083569863172, inplace=False)
    (fc3): Linear(in_features=32, out_features=32, bias=True)
    (relu3): ReLU()
    (dropout3): Dropout(p=0.22409083569863172, inplace=False)
    (fc4): Linear(in_features=32, out_features=1, bias=True)
    (sigmoid): Sigmoid()
  )
)
Num params:  4257

  2%|█▋                                                                                    | 1/50 [00:02<01:42,  2.09s/it]
Epoch 0 (train) - Loss: 0.466

  6%|█████▏                                                                                | 3/50 [00:05<01:30,  1.92s/it]
Epoch 1 (train) - Loss: 0.371

  8%|██████▉                                                                               | 4/50 [00:07<01:28,  1.93s/it]
Epoch 2 (train) - Loss: 0.315
Epoch 2 (test) - Accuracy: 0.881 - F1 score: 0.911
Epoch 3 (train) - Loss: 0.303

 10%|████████▌                                                                             | 5/50 [00:09<01:25,  1.90s/it]

 12%|██████████▎                                                                           | 6/50 [00:11<01:24,  1.93s/it]
Epoch 4 (test) - Accuracy: 0.878 - F1 score: 0.902
Epoch 5 (train) - Loss: 0.274

 14%|████████████                                                                          | 7/50 [00:13<01:20,  1.88s/it]
Epoch 6 (train) - Loss: 0.256

 16%|█████████████▊                                                                        | 8/50 [00:15<01:18,  1.87s/it]
Epoch 7 (train) - Loss: 0.264

 18%|███████████████▍                                                                      | 9/50 [00:17<01:17,  1.90s/it]
Epoch 8 (train) - Loss: 0.255

 20%|█████████████████                                                                    | 10/50 [00:19<01:16,  1.91s/it]
Epoch 9 (train) - Loss: 0.239

 22%|██████████████████▋                                                                  | 11/50 [00:21<01:15,  1.93s/it]
Epoch 10 (train) - Loss: 0.243

 24%|████████████████████▍                                                                | 12/50 [00:22<01:11,  1.89s/it]
Epoch 11 (train) - Loss: 0.240

 26%|██████████████████████                                                               | 13/50 [00:24<01:09,  1.87s/it]
Epoch 12 (train) - Loss: 0.236
Epoch 12 (test) - Accuracy: 0.897 - F1 score: 0.918
Epoch 13 (train) - Loss: 0.212

 28%|███████████████████████▊                                                             | 14/50 [00:26<01:09,  1.92s/it]
Epoch 14 (train) - Loss: 0.229

 30%|█████████████████████████▌                                                           | 15/50 [00:28<01:06,  1.90s/it]
Epoch 15 (train) - Loss: 0.217

 32%|███████████████████████████▏                                                         | 16/50 [00:30<01:04,  1.91s/it]
Epoch 16 (train) - Loss: 0.204

 34%|████████████████████████████▉                                                        | 17/50 [00:32<01:02,  1.90s/it]
Epoch 17 (train) - Loss: 0.211
Epoch 17 (test) - Accuracy: 0.912 - F1 score: 0.934

 36%|██████████████████████████████▌                                                      | 18/50 [00:34<01:01,  1.92s/it]
Epoch 18 (test) - Accuracy: 0.904 - F1 score: 0.923

 38%|████████████████████████████████▎                                                    | 19/50 [00:36<00:59,  1.92s/it]
Epoch 19 (test) - Accuracy: 0.913 - F1 score: 0.933
Epoch 20 (train) - Loss: 0.196

 42%|███████████████████████████████████▋                                                 | 21/50 [00:40<00:54,  1.88s/it]
Epoch 21 (train) - Loss: 0.194

 44%|█████████████████████████████████████▍                                               | 22/50 [00:42<00:54,  1.93s/it]
Epoch 22 (train) - Loss: 0.202

 46%|███████████████████████████████████████                                              | 23/50 [00:43<00:51,  1.92s/it]
Epoch 23 (train) - Loss: 0.195

 48%|████████████████████████████████████████▊                                            | 24/50 [00:46<00:50,  1.96s/it]
Epoch 24 (train) - Loss: 0.197

 50%|██████████████████████████████████████████▌                                          | 25/50 [00:47<00:48,  1.94s/it]
Epoch 25 (train) - Loss: 0.191

 52%|████████████████████████████████████████████▏                                        | 26/50 [00:49<00:47,  1.96s/it]
Epoch 26 (train) - Loss: 0.198

 54%|█████████████████████████████████████████████▉                                       | 27/50 [00:51<00:44,  1.96s/it]
Epoch 27 (train) - Loss: 0.197

 56%|███████████████████████████████████████████████▌                                     | 28/50 [00:53<00:42,  1.95s/it]
Epoch 28 (train) - Loss: 0.179

 58%|█████████████████████████████████████████████████▎                                   | 29/50 [00:55<00:40,  1.92s/it]
Epoch 29 (train) - Loss: 0.190

 60%|███████████████████████████████████████████████████                                  | 30/50 [00:57<00:39,  1.95s/it]
Epoch 30 (train) - Loss: 0.180

 62%|████████████████████████████████████████████████████▋                                | 31/50 [00:59<00:36,  1.93s/it]
Epoch 31 (train) - Loss: 0.176

 64%|██████████████████████████████████████████████████████▍                              | 32/50 [01:01<00:35,  1.96s/it]
Epoch 32 (train) - Loss: 0.182

 66%|████████████████████████████████████████████████████████                             | 33/50 [01:03<00:33,  1.97s/it]
Epoch 33 (train) - Loss: 0.164

 68%|█████████████████████████████████████████████████████████▊                           | 34/50 [01:05<00:30,  1.90s/it]
Epoch 34 (train) - Loss: 0.173

 70%|███████████████████████████████████████████████████████████▍                         | 35/50 [01:07<00:28,  1.92s/it]
Epoch 35 (train) - Loss: 0.162

 72%|█████████████████████████████████████████████████████████████▏                       | 36/50 [01:09<00:27,  1.94s/it]
Epoch 36 (train) - Loss: 0.176

 74%|██████████████████████████████████████████████████████████████▉                      | 37/50 [01:11<00:25,  1.96s/it]
Epoch 37 (train) - Loss: 0.175

 76%|████████████████████████████████████████████████████████████████▌                    | 38/50 [01:13<00:23,  1.97s/it]
Epoch 38 (train) - Loss: 0.168

 78%|██████████████████████████████████████████████████████████████████▎                  | 39/50 [01:15<00:21,  1.94s/it]
Epoch 39 (train) - Loss: 0.163

 80%|████████████████████████████████████████████████████████████████████                 | 40/50 [01:17<00:19,  1.94s/it]
Epoch 40 (train) - Loss: 0.167

 82%|█████████████████████████████████████████████████████████████████████▋               | 41/50 [01:18<00:17,  1.92s/it]
Epoch 41 (train) - Loss: 0.167

 84%|███████████████████████████████████████████████████████████████████████▍             | 42/50 [01:20<00:14,  1.87s/it]
Epoch 42 (train) - Loss: 0.157
Epoch 42 (test) - Accuracy: 0.894 - F1 score: 0.919

 86%|█████████████████████████████████████████████████████████████████████████            | 43/50 [01:22<00:12,  1.85s/it]
Epoch 43 (test) - Accuracy: 0.912 - F1 score: 0.931

 88%|██████████████████████████████████████████████████████████████████████████▊          | 44/50 [01:24<00:11,  1.84s/it]
Epoch 44 (test) - Accuracy: 0.909 - F1 score: 0.930
Epoch 45 (train) - Loss: 0.166

 92%|██████████████████████████████████████████████████████████████████████████████▏      | 46/50 [01:28<00:07,  1.90s/it]
Epoch 46 (train) - Loss: 0.154

 94%|███████████████████████████████████████████████████████████████████████████████▉     | 47/50 [01:30<00:05,  1.90s/it]
Epoch 47 (train) - Loss: 0.163

 96%|█████████████████████████████████████████████████████████████████████████████████▌   | 48/50 [01:32<00:03,  1.91s/it]
Epoch 48 (train) - Loss: 0.165

 98%|███████████████████████████████████████████████████████████████████████████████████▎ | 49/50 [01:33<00:01,  1.91s/it]
Epoch 49 (train) - Loss: 0.164
Epoch 49 (test) - Accuracy: 0.901 - F1 score: 0.923
Plotting the results...

100%|█████████████████████████████████████████████████████████████████████████████████████| 50/50 [01:35<00:00,  1.92s/it]
Saving the model as 'baseline_model_2_balanced'...
Generating the test.json file...
Done!