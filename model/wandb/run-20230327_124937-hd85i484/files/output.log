[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'learning_rate' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_epochs' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'weight_decay' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'depth' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'heads' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'attn_dropout' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'dim_ff' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'd_model' was locked by 'sweep' (ignored update).
  0%|                                                                                                                            | 0/80 [00:00<?, ?it/s]
Creating dataset...
Loading data from /home/usuaris/veu/gerard.calvo.bartra/nuwe/model/../data/supply_chain_train_raw.csv
Train batch 0:
{'data': tensor([[-0.6776,  1.0710,  0.5180,  ...,  0.0000,  0.0000,  0.0000],
        [-0.6485,  0.4489,  1.2890,  ...,  0.0000,  0.0000,  0.0000],
        [-0.6388,  0.2000,  0.5180,  ...,  1.0000,  0.0000,  0.0000],
        ...,
        [ 1.5767,  0.8221,  0.5180,  ...,  0.0000,  0.0000,  0.0000],
        [-0.5245, -2.0397, -0.2530,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7678,  0.2000,  1.2890,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1,
        1, 0, 1, 1, 1, 1, 1, 1])}
Validation batch 0:
{'data': tensor([[-0.7021, -0.9862, -0.2985,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7690,  0.4015,  2.1085,  ...,  0.0000,  0.0000,  1.0000],
        [-0.7355,  0.0231, -1.1008,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-0.7259,  0.1492, -0.2985,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.4713,  0.5277,  2.1085,  ...,  0.0000,  0.0000,  0.0000],
        [-0.7987, -0.2293,  0.5039,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 0, 1, 1])}
batch_data.shape: torch.Size([32, 38])
Percentage of positive and negative samples in the training set:
1    0.839094
0    0.160906
Name: Attrition_Flag, dtype: float64
FTTransformer(
  (numerical_embedder): NumericalEmbedder(
    (linear): Linear(in_features=38, out_features=128, bias=True)
  )
  (layers): ModuleList(
    (0-4): 5 x ModuleList(
      (0): Attention(
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (to_qkv): Linear(in_features=128, out_features=384, bias=False)
        (to_out): Linear(in_features=128, out_features=128, bias=False)
        (dropout): Dropout(p=0.06110129170343309, inplace=False)
      )
      (1): Sequential(
        (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (1): Linear(in_features=128, out_features=64, bias=True)
        (2): GEGLU()
        (3): Dropout(p=0.06110129170343309, inplace=False)
        (4): Linear(in_features=32, out_features=128, bias=True)
      )
    )
  )
  (to_logits): Sequential(
    (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (1): ReLU()
    (2): Linear(in_features=128, out_features=1, bias=True)
    (3): Sigmoid()
  )
)
Num params:  398017

  1%|█▍                                                                                                                  | 1/80 [00:06<08:05,  6.14s/it]
Epoch 0 (train) - Loss: 0.094

  2%|██▉                                                                                                                 | 2/80 [00:12<08:04,  6.22s/it]
Epoch 1 (train) - Loss: 0.064
Epoch 1 (test) - Accuracy: 0.899 - F1 score: 0.942
Epoch 2 (train) - Loss: 0.061

  4%|████▎                                                                                                               | 3/80 [00:18<07:57,  6.20s/it]
Epoch 3 (train) - Loss: 0.060

  5%|█████▊                                                                                                              | 4/80 [00:24<07:34,  5.98s/it]
Epoch 4 (train) - Loss: 0.057


  8%|████████▋                                                                                                           | 6/80 [00:36<07:21,  5.96s/it]
Epoch 5 (train) - Loss: 0.057

  9%|██████████▏                                                                                                         | 7/80 [00:43<07:50,  6.44s/it]
Epoch 6 (train) - Loss: 0.056
Epoch 6 (test) - Accuracy: 0.909 - F1 score: 0.948
Epoch 7 (train) - Loss: 0.055

 10%|███████████▌                                                                                                        | 8/80 [00:51<08:11,  6.83s/it]
Epoch 8 (train) - Loss: 0.055

 11%|█████████████                                                                                                       | 9/80 [00:59<08:39,  7.31s/it]
Epoch 9 (train) - Loss: 0.054

 12%|██████████████▍                                                                                                    | 10/80 [01:08<09:00,  7.72s/it]
Epoch 10 (train) - Loss: 0.052

 14%|███████████████▊                                                                                                   | 11/80 [01:16<08:56,  7.78s/it]
Epoch 11 (train) - Loss: 0.052

 15%|█████████████████▎                                                                                                 | 12/80 [01:24<09:05,  8.02s/it]
Epoch 12 (train) - Loss: 0.050

 16%|██████████████████▋                                                                                                | 13/80 [01:33<09:05,  8.14s/it]
Epoch 13 (train) - Loss: 0.050

 18%|████████████████████▏                                                                                              | 14/80 [01:42<09:20,  8.49s/it]
Epoch 14 (train) - Loss: 0.048

 19%|█████████████████████▌                                                                                             | 15/80 [01:51<09:21,  8.63s/it]
Epoch 15 (train) - Loss: 0.048

 20%|███████████████████████                                                                                            | 16/80 [02:00<09:22,  8.79s/it]
Epoch 16 (train) - Loss: 0.047

 21%|████████████████████████▍                                                                                          | 17/80 [02:09<09:11,  8.75s/it]

 22%|█████████████████████████▉                                                                                         | 18/80 [02:19<09:34,  9.27s/it]
Epoch 17 (test) - Accuracy: 0.923 - F1 score: 0.955
Epoch 18 (train) - Loss: 0.047

 24%|███████████████████████████▎                                                                                       | 19/80 [02:29<09:40,  9.52s/it]
Epoch 19 (train) - Loss: 0.048

 25%|████████████████████████████▊                                                                                      | 20/80 [02:39<09:35,  9.59s/it]
Epoch 20 (train) - Loss: 0.046

 26%|██████████████████████████████▏                                                                                    | 21/80 [02:49<09:35,  9.76s/it]
Epoch 21 (train) - Loss: 0.046

 28%|███████████████████████████████▋                                                                                   | 22/80 [03:00<09:39,  9.99s/it]
Epoch 22 (train) - Loss: 0.046

 29%|█████████████████████████████████                                                                                  | 23/80 [03:10<09:43, 10.23s/it]
Epoch 23 (train) - Loss: 0.045

 30%|██████████████████████████████████▌                                                                                | 24/80 [03:21<09:43, 10.42s/it]
Epoch 24 (train) - Loss: 0.046

 31%|███████████████████████████████████▉                                                                               | 25/80 [03:33<09:45, 10.64s/it]

 32%|█████████████████████████████████████▍                                                                             | 26/80 [03:44<09:44, 10.82s/it]
Epoch 25 (test) - Accuracy: 0.921 - F1 score: 0.954
Epoch 26 (train) - Loss: 0.046

 34%|██████████████████████████████████████▊                                                                            | 27/80 [03:56<09:54, 11.21s/it]
Epoch 27 (train) - Loss: 0.044

 35%|████████████████████████████████████████▎                                                                          | 28/80 [04:07<09:42, 11.21s/it]
Epoch 28 (train) - Loss: 0.046

 36%|█████████████████████████████████████████▋                                                                         | 29/80 [04:19<09:41, 11.40s/it]
Epoch 29 (train) - Loss: 0.044

 38%|███████████████████████████████████████████▏                                                                       | 30/80 [04:31<09:38, 11.56s/it]
Epoch 30 (train) - Loss: 0.044

 39%|████████████████████████████████████████████▌                                                                      | 31/80 [04:43<09:36, 11.76s/it]
Epoch 31 (train) - Loss: 0.044

 40%|██████████████████████████████████████████████                                                                     | 32/80 [04:55<09:27, 11.83s/it]
Epoch 32 (train) - Loss: 0.043

 41%|███████████████████████████████████████████████▍                                                                   | 33/80 [05:07<09:19, 11.91s/it]

 42%|████████████████████████████████████████████████▉                                                                  | 34/80 [05:19<09:13, 12.03s/it]
Epoch 33 (test) - Accuracy: 0.923 - F1 score: 0.955

 44%|██████████████████████████████████████████████████▎                                                                | 35/80 [05:32<09:05, 12.11s/it]
Epoch 34 (test) - Accuracy: 0.923 - F1 score: 0.956

 45%|███████████████████████████████████████████████████▊                                                               | 36/80 [05:44<08:50, 12.06s/it]
Epoch 35 (test) - Accuracy: 0.928 - F1 score: 0.958

 46%|█████████████████████████████████████████████████████▏                                                             | 37/80 [05:56<08:36, 12.02s/it]
Epoch 36 (test) - Accuracy: 0.921 - F1 score: 0.954
Epoch 37 (train) - Loss: 0.043

 48%|██████████████████████████████████████████████████████▋                                                            | 38/80 [06:08<08:31, 12.18s/it]
Epoch 38 (train) - Loss: 0.042

 49%|████████████████████████████████████████████████████████                                                           | 39/80 [06:20<08:15, 12.09s/it]
Epoch 39 (train) - Loss: 0.041

 50%|█████████████████████████████████████████████████████████▌                                                         | 40/80 [06:32<08:05, 12.13s/it]

 51%|██████████████████████████████████████████████████████████▉                                                        | 41/80 [06:44<07:47, 11.98s/it]
Epoch 40 (test) - Accuracy: 0.923 - F1 score: 0.955
Epoch 41 (train) - Loss: 0.041

 52%|████████████████████████████████████████████████████████████▍                                                      | 42/80 [06:55<07:29, 11.83s/it]
Epoch 42 (train) - Loss: 0.040

 54%|█████████████████████████████████████████████████████████████▊                                                     | 43/80 [07:07<07:14, 11.74s/it]

 55%|███████████████████████████████████████████████████████████████▎                                                   | 44/80 [07:18<06:49, 11.38s/it]
Epoch 43 (test) - Accuracy: 0.924 - F1 score: 0.956

 56%|████████████████████████████████████████████████████████████████▋                                                  | 45/80 [07:28<06:27, 11.08s/it]
Epoch 44 (test) - Accuracy: 0.927 - F1 score: 0.957

 57%|██████████████████████████████████████████████████████████████████▏                                                | 46/80 [07:38<06:03, 10.69s/it]
Epoch 45 (test) - Accuracy: 0.925 - F1 score: 0.956
Epoch 46 (train) - Loss: 0.041

 59%|███████████████████████████████████████████████████████████████████▌                                               | 47/80 [07:47<05:44, 10.42s/it]
Epoch 47 (train) - Loss: 0.041

 60%|█████████████████████████████████████████████████████████████████████                                              | 48/80 [07:57<05:21, 10.04s/it]
Epoch 48 (train) - Loss: 0.041

 61%|██████████████████████████████████████████████████████████████████████▍                                            | 49/80 [08:06<05:09,  9.98s/it]
Epoch 49 (train) - Loss: 0.042

 62%|███████████████████████████████████████████████████████████████████████▉                                           | 50/80 [08:17<05:04, 10.15s/it]
Epoch 50 (train) - Loss: 0.041

 64%|█████████████████████████████████████████████████████████████████████████▎                                         | 51/80 [08:27<04:51, 10.05s/it]
Epoch 51 (train) - Loss: 0.041

 65%|██████████████████████████████████████████████████████████████████████████▊                                        | 52/80 [08:37<04:38,  9.96s/it]

 66%|████████████████████████████████████████████████████████████████████████████▏                                      | 53/80 [08:46<04:23,  9.77s/it]
Epoch 52 (test) - Accuracy: 0.930 - F1 score: 0.959

 68%|█████████████████████████████████████████████████████████████████████████████▋                                     | 54/80 [08:56<04:14,  9.79s/it]
Epoch 53 (test) - Accuracy: 0.923 - F1 score: 0.955
Epoch 54 (train) - Loss: 0.041


 70%|████████████████████████████████████████████████████████████████████████████████▌                                  | 56/80 [09:16<03:59,  9.99s/it]
Epoch 55 (train) - Loss: 0.039

 71%|█████████████████████████████████████████████████████████████████████████████████▉                                 | 57/80 [09:26<03:49,  9.99s/it]
Epoch 56 (train) - Loss: 0.039
Epoch 56 (test) - Accuracy: 0.929 - F1 score: 0.959

 72%|███████████████████████████████████████████████████████████████████████████████████▍                               | 58/80 [09:36<03:39,  9.98s/it]
Epoch 57 (test) - Accuracy: 0.927 - F1 score: 0.957

 74%|████████████████████████████████████████████████████████████████████████████████████▊                              | 59/80 [09:46<03:28,  9.92s/it]
Epoch 58 (test) - Accuracy: 0.921 - F1 score: 0.954

 75%|██████████████████████████████████████████████████████████████████████████████████████▎                            | 60/80 [09:56<03:18,  9.91s/it]
Epoch 59 (test) - Accuracy: 0.929 - F1 score: 0.959

 76%|███████████████████████████████████████████████████████████████████████████████████████▋                           | 61/80 [10:06<03:08,  9.92s/it]
Epoch 60 (test) - Accuracy: 0.924 - F1 score: 0.956
Epoch 61 (train) - Loss: 0.040

 78%|█████████████████████████████████████████████████████████████████████████████████████████▏                         | 62/80 [10:15<02:55,  9.74s/it]
Epoch 62 (train) - Loss: 0.040

 79%|██████████████████████████████████████████████████████████████████████████████████████████▌                        | 63/80 [10:25<02:46,  9.77s/it]
Epoch 63 (train) - Loss: 0.039

 80%|████████████████████████████████████████████████████████████████████████████████████████████                       | 64/80 [10:35<02:35,  9.75s/it]
Epoch 64 (train) - Loss: 0.040

 81%|█████████████████████████████████████████████████████████████████████████████████████████████▍                     | 65/80 [10:44<02:26,  9.76s/it]

 82%|██████████████████████████████████████████████████████████████████████████████████████████████▉                    | 66/80 [10:54<02:16,  9.75s/it]
Epoch 65 (test) - Accuracy: 0.928 - F1 score: 0.958

 84%|████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 67/80 [11:04<02:06,  9.76s/it]
Epoch 66 (test) - Accuracy: 0.923 - F1 score: 0.955
Epoch 67 (train) - Loss: 0.039

 85%|█████████████████████████████████████████████████████████████████████████████████████████████████▊                 | 68/80 [11:14<01:57,  9.77s/it]
Epoch 68 (train) - Loss: 0.039

 86%|███████████████████████████████████████████████████████████████████████████████████████████████████▏               | 69/80 [11:23<01:46,  9.70s/it]
Epoch 69 (train) - Loss: 0.038

 88%|████████████████████████████████████████████████████████████████████████████████████████████████████▋              | 70/80 [11:33<01:38,  9.81s/it]

 89%|██████████████████████████████████████████████████████████████████████████████████████████████████████             | 71/80 [11:44<01:30, 10.08s/it]
Epoch 70 (test) - Accuracy: 0.924 - F1 score: 0.956

 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 72/80 [11:54<01:20, 10.09s/it]
Epoch 71 (test) - Accuracy: 0.928 - F1 score: 0.957
Epoch 72 (train) - Loss: 0.040

 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉          | 73/80 [12:04<01:09,  9.98s/it]
Epoch 73 (train) - Loss: 0.038

 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▍        | 74/80 [12:14<00:59,  9.97s/it]

 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▊       | 75/80 [12:24<00:50, 10.04s/it]
Epoch 74 (test) - Accuracy: 0.928 - F1 score: 0.958

 95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▎     | 76/80 [12:34<00:40, 10.01s/it]
Epoch 75 (test) - Accuracy: 0.928 - F1 score: 0.957
Epoch 76 (train) - Loss: 0.038

 96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▋    | 77/80 [12:44<00:29,  9.99s/it]

 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏  | 78/80 [12:54<00:20, 10.08s/it]
Epoch 77 (test) - Accuracy: 0.930 - F1 score: 0.959
Epoch 78 (train) - Loss: 0.039

 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌ | 79/80 [13:04<00:09,  9.98s/it]
Epoch 79 (train) - Loss: 0.037
Epoch 79 (test) - Accuracy: 0.929 - F1 score: 0.959
Plotting the results...
Saving the plot as 'results_ftt_model_2_raw.png'...

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 80/80 [13:13<00:00,  9.92s/it]
Generating the test.json file...
Done!