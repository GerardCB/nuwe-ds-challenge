[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'learning_rate' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_epochs' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'hidden_size' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_layers' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'dropout' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'weight_decay' was locked by 'sweep' (ignored update).
  0%|                                                                                              | 0/80 [00:00<?, ?it/s]
Creating dataset...
Loading data from /home/usuaris/veu/gerard.calvo.bartra/nuwe/model/../data/supply_chain_train_balanced.csv
Train batch 0:
{'data': tensor([[-0.4738, -0.4065,  0.3519,  ...,  0.0000,  0.0000,  0.0000],
        [-1.7650, -0.4065,  0.3519,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.8175, -1.4270,  2.1704,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [ 1.4631, -1.4270, -1.4666,  ...,  0.0000,  0.0000,  0.0000],
        [-1.1194, -1.4270,  0.3519,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.1719,  0.6141, -0.5574,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1])}
Validation batch 0:
{'data': tensor([[-1.1402,  0.6459, -1.3412,  ...,  0.0000,  0.0000,  0.0000],
        [-0.4862, -0.3693,  1.1670,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.1677, -0.3693, -1.3412,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-1.1402,  0.6459,  2.0031,  ...,  0.0000,  0.0000,  0.0000],
        [-0.4862,  0.6459, -0.5051,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.1677, -0.3693,  1.1670,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1,
        1, 0, 1, 1, 1, 0, 0, 1])}
batch_data.shape: torch.Size([32, 32])
Percentage of positive and negative samples in the training set:
1    0.644696
0    0.355304
Name: Attrition_Flag, dtype: float64
BaselineNet(
  (fc): Sequential(
    (fc0): Linear(in_features=32, out_features=256, bias=True)
    (relu0): ReLU()
    (dropout0): Dropout(p=0.10125454143814824, inplace=False)
    (fc1): Linear(in_features=256, out_features=256, bias=True)
    (relu1): ReLU()
    (dropout1): Dropout(p=0.10125454143814824, inplace=False)
    (fc2): Linear(in_features=256, out_features=256, bias=True)
    (relu2): ReLU()
    (dropout2): Dropout(p=0.10125454143814824, inplace=False)
    (fc3): Linear(in_features=256, out_features=256, bias=True)
    (relu3): ReLU()
    (dropout3): Dropout(p=0.10125454143814824, inplace=False)
    (fc4): Linear(in_features=256, out_features=256, bias=True)
    (relu4): ReLU()
    (dropout4): Dropout(p=0.10125454143814824, inplace=False)
    (fc5): Linear(in_features=256, out_features=1, bias=True)
    (sigmoid): Sigmoid()
  )
)
Num params:  271873

  1%|█                                                                                     | 1/80 [00:02<03:45,  2.85s/it]
Epoch 0 (train) - Loss: 0.397
Epoch 0 (test) - Accuracy: 0.881 - F1 score: 0.909
Epoch 1 (train) - Loss: 0.298

  2%|██▏                                                                                   | 2/80 [00:06<04:08,  3.18s/it]
Epoch 2 (train) - Loss: 0.272

  4%|███▏                                                                                  | 3/80 [00:09<03:57,  3.08s/it]
Epoch 3 (train) - Loss: 0.260

  5%|████▎                                                                                 | 4/80 [00:12<03:53,  3.07s/it]
Epoch 4 (train) - Loss: 0.245

  6%|█████▍                                                                                | 5/80 [00:15<03:42,  2.96s/it]
Epoch 5 (train) - Loss: 0.227

  8%|██████▍                                                                               | 6/80 [00:18<03:43,  3.02s/it]

  9%|███████▌                                                                              | 7/80 [00:21<03:46,  3.10s/it]
Epoch 6 (test) - Accuracy: 0.904 - F1 score: 0.925
Epoch 7 (train) - Loss: 0.214

 10%|████████▌                                                                             | 8/80 [00:24<03:39,  3.05s/it]
Epoch 8 (train) - Loss: 0.198

 11%|█████████▋                                                                            | 9/80 [00:27<03:28,  2.94s/it]
Epoch 9 (train) - Loss: 0.205

 12%|██████████▋                                                                          | 10/80 [00:30<03:37,  3.11s/it]
Epoch 10 (train) - Loss: 0.197

 14%|███████████▋                                                                         | 11/80 [00:33<03:39,  3.18s/it]
Epoch 11 (train) - Loss: 0.185

 15%|████████████▊                                                                        | 12/80 [00:36<03:29,  3.08s/it]
Epoch 12 (train) - Loss: 0.175

 16%|█████████████▊                                                                       | 13/80 [00:40<03:36,  3.23s/it]
Epoch 13 (train) - Loss: 0.188

 18%|██████████████▊                                                                      | 14/80 [00:43<03:38,  3.31s/it]
Epoch 14 (train) - Loss: 0.169

 19%|███████████████▉                                                                     | 15/80 [00:48<03:55,  3.63s/it]
Epoch 15 (train) - Loss: 0.168

 20%|█████████████████                                                                    | 16/80 [00:52<03:58,  3.73s/it]
Epoch 16 (train) - Loss: 0.157

 21%|██████████████████                                                                   | 17/80 [00:56<03:59,  3.80s/it]
Epoch 17 (train) - Loss: 0.142

 22%|███████████████████▏                                                                 | 18/80 [01:00<04:04,  3.94s/it]
Epoch 18 (train) - Loss: 0.155

 24%|████████████████████▏                                                                | 19/80 [01:05<04:14,  4.17s/it]
Epoch 19 (train) - Loss: 0.137

 25%|█████████████████████▎                                                               | 20/80 [01:09<04:06,  4.11s/it]
Epoch 20 (train) - Loss: 0.134

 26%|██████████████████████▎                                                              | 21/80 [01:13<03:59,  4.07s/it]
Epoch 21 (train) - Loss: 0.132

 28%|███████████████████████▍                                                             | 22/80 [01:17<03:58,  4.11s/it]
Epoch 22 (train) - Loss: 0.144

 29%|████████████████████████▍                                                            | 23/80 [01:22<04:05,  4.31s/it]
Epoch 23 (train) - Loss: 0.126

 30%|█████████████████████████▌                                                           | 24/80 [01:26<03:59,  4.28s/it]
Epoch 24 (train) - Loss: 0.118

 31%|██████████████████████████▌                                                          | 25/80 [01:30<03:54,  4.26s/it]
Epoch 25 (train) - Loss: 0.116

 32%|███████████████████████████▋                                                         | 26/80 [01:34<03:48,  4.24s/it]
Epoch 26 (train) - Loss: 0.114

 34%|████████████████████████████▋                                                        | 27/80 [01:38<03:36,  4.08s/it]
Epoch 27 (train) - Loss: 0.099

 35%|█████████████████████████████▋                                                       | 28/80 [01:42<03:39,  4.23s/it]
Epoch 28 (train) - Loss: 0.118

 36%|██████████████████████████████▊                                                      | 29/80 [01:47<03:37,  4.26s/it]
Epoch 29 (train) - Loss: 0.131

 38%|███████████████████████████████▉                                                     | 30/80 [01:52<03:41,  4.42s/it]
Epoch 30 (train) - Loss: 0.115

 39%|████████████████████████████████▉                                                    | 31/80 [01:56<03:39,  4.48s/it]
Epoch 31 (train) - Loss: 0.096

 40%|██████████████████████████████████                                                   | 32/80 [02:00<03:21,  4.19s/it]
Epoch 32 (train) - Loss: 0.109

 41%|███████████████████████████████████                                                  | 33/80 [02:04<03:12,  4.09s/it]

 42%|████████████████████████████████████▏                                                | 34/80 [02:07<03:03,  4.00s/it]

 44%|█████████████████████████████████████▏                                               | 35/80 [02:11<02:59,  3.99s/it]
Epoch 34 (test) - Accuracy: 0.918 - F1 score: 0.936
Epoch 35 (train) - Loss: 0.104

 45%|██████████████████████████████████████▎                                              | 36/80 [02:15<02:51,  3.90s/it]
Epoch 36 (train) - Loss: 0.097

 46%|███████████████████████████████████████▎                                             | 37/80 [02:19<02:46,  3.87s/it]
Epoch 37 (train) - Loss: 0.092

 48%|████████████████████████████████████████▍                                            | 38/80 [02:23<02:41,  3.85s/it]
Epoch 38 (train) - Loss: 0.089

 49%|█████████████████████████████████████████▍                                           | 39/80 [02:26<02:37,  3.85s/it]
Epoch 39 (train) - Loss: 0.119

 50%|██████████████████████████████████████████▌                                          | 40/80 [02:30<02:35,  3.89s/it]
Epoch 40 (train) - Loss: 0.086

 51%|███████████████████████████████████████████▌                                         | 41/80 [02:34<02:30,  3.86s/it]
Epoch 41 (train) - Loss: 0.077

 52%|████████████████████████████████████████████▋                                        | 42/80 [02:38<02:24,  3.81s/it]
Epoch 42 (train) - Loss: 0.086

 54%|█████████████████████████████████████████████▋                                       | 43/80 [02:42<02:27,  3.98s/it]
Epoch 43 (train) - Loss: 0.132

 55%|██████████████████████████████████████████████▊                                      | 44/80 [02:46<02:20,  3.91s/it]
Epoch 44 (train) - Loss: 0.099

 56%|███████████████████████████████████████████████▊                                     | 45/80 [02:50<02:21,  4.03s/it]
Epoch 45 (train) - Loss: 0.097

 57%|████████████████████████████████████████████████▊                                    | 46/80 [02:54<02:14,  3.96s/it]
Epoch 46 (train) - Loss: 0.079

 59%|█████████████████████████████████████████████████▉                                   | 47/80 [02:58<02:11,  3.99s/it]
Epoch 47 (train) - Loss: 0.085

 60%|███████████████████████████████████████████████████                                  | 48/80 [03:02<02:04,  3.90s/it]
Epoch 48 (train) - Loss: 0.103

 61%|████████████████████████████████████████████████████                                 | 49/80 [03:06<02:05,  4.04s/it]
Epoch 49 (train) - Loss: 0.083

 62%|█████████████████████████████████████████████████████▏                               | 50/80 [03:10<01:58,  3.94s/it]
Epoch 50 (train) - Loss: 0.074

 64%|██████████████████████████████████████████████████████▏                              | 51/80 [03:14<01:53,  3.90s/it]
Epoch 51 (train) - Loss: 0.072

 65%|███████████████████████████████████████████████████████▎                             | 52/80 [03:18<01:48,  3.88s/it]
Epoch 52 (train) - Loss: 0.070

 66%|████████████████████████████████████████████████████████▎                            | 53/80 [03:22<01:44,  3.88s/it]
Epoch 53 (train) - Loss: 0.081

 68%|█████████████████████████████████████████████████████████▍                           | 54/80 [03:26<01:41,  3.92s/it]
Epoch 54 (train) - Loss: 0.094

 69%|██████████████████████████████████████████████████████████▍                          | 55/80 [03:29<01:37,  3.89s/it]
Epoch 55 (train) - Loss: 0.065

 70%|███████████████████████████████████████████████████████████▍                         | 56/80 [03:33<01:30,  3.78s/it]
Epoch 56 (train) - Loss: 0.062

 71%|████████████████████████████████████████████████████████████▌                        | 57/80 [03:37<01:27,  3.81s/it]
Epoch 57 (train) - Loss: 0.080

 72%|█████████████████████████████████████████████████████████████▋                       | 58/80 [03:41<01:24,  3.83s/it]
Epoch 58 (train) - Loss: 0.083

 74%|██████████████████████████████████████████████████████████████▋                      | 59/80 [03:45<01:20,  3.84s/it]
Epoch 59 (train) - Loss: 0.085

 75%|███████████████████████████████████████████████████████████████▊                     | 60/80 [03:48<01:14,  3.74s/it]
Epoch 60 (train) - Loss: 0.075

 76%|████████████████████████████████████████████████████████████████▊                    | 61/80 [03:52<01:11,  3.78s/it]
Epoch 61 (train) - Loss: 0.073

 78%|█████████████████████████████████████████████████████████████████▉                   | 62/80 [03:56<01:08,  3.82s/it]
Epoch 62 (train) - Loss: 0.078

 79%|██████████████████████████████████████████████████████████████████▉                  | 63/80 [04:00<01:05,  3.85s/it]
Epoch 63 (train) - Loss: 0.096

 80%|████████████████████████████████████████████████████████████████████                 | 64/80 [04:03<01:00,  3.77s/it]
Epoch 64 (train) - Loss: 0.092

 81%|█████████████████████████████████████████████████████████████████████                | 65/80 [04:07<00:56,  3.75s/it]
Epoch 65 (train) - Loss: 0.076

 82%|██████████████████████████████████████████████████████████████████████▏              | 66/80 [04:11<00:52,  3.78s/it]
Epoch 66 (train) - Loss: 0.072

 84%|███████████████████████████████████████████████████████████████████████▏             | 67/80 [04:16<00:54,  4.17s/it]
Epoch 67 (train) - Loss: 0.073

 85%|████████████████████████████████████████████████████████████████████████▎            | 68/80 [04:20<00:49,  4.12s/it]
Epoch 68 (train) - Loss: 0.074

 86%|█████████████████████████████████████████████████████████████████████████▎           | 69/80 [04:24<00:44,  4.02s/it]
Epoch 69 (train) - Loss: 0.086

 88%|██████████████████████████████████████████████████████████████████████████▍          | 70/80 [04:28<00:39,  3.95s/it]
Epoch 70 (train) - Loss: 0.080

 89%|███████████████████████████████████████████████████████████████████████████▍         | 71/80 [04:31<00:35,  3.94s/it]
Epoch 71 (train) - Loss: 0.058

 90%|████████████████████████████████████████████████████████████████████████████▌        | 72/80 [04:35<00:31,  3.93s/it]
Epoch 72 (train) - Loss: 0.103

 91%|█████████████████████████████████████████████████████████████████████████████▌       | 73/80 [04:39<00:27,  3.94s/it]
Epoch 73 (train) - Loss: 0.061

 92%|██████████████████████████████████████████████████████████████████████████████▋      | 74/80 [04:43<00:22,  3.82s/it]
Epoch 74 (train) - Loss: 0.077

 94%|███████████████████████████████████████████████████████████████████████████████▋     | 75/80 [04:47<00:19,  3.85s/it]
Epoch 75 (train) - Loss: 0.066

 95%|████████████████████████████████████████████████████████████████████████████████▊    | 76/80 [04:51<00:15,  3.85s/it]
Epoch 76 (train) - Loss: 0.072

 96%|█████████████████████████████████████████████████████████████████████████████████▊   | 77/80 [04:55<00:11,  3.91s/it]
Epoch 77 (train) - Loss: 0.083

 98%|██████████████████████████████████████████████████████████████████████████████████▉  | 78/80 [04:59<00:07,  3.90s/it]
Epoch 78 (train) - Loss: 0.059

 99%|███████████████████████████████████████████████████████████████████████████████████▉ | 79/80 [05:02<00:03,  3.77s/it]
Epoch 79 (train) - Loss: 0.059
Epoch 79 (test) - Accuracy: 0.912 - F1 score: 0.931

100%|█████████████████████████████████████████████████████████████████████████████████████| 80/80 [05:06<00:00,  3.83s/it]
Saving the plot as 'results_baseline_model_2_balanced.png'...
Saving the model as 'baseline_model_2_balanced'...
Generating the test.json file...
Done!