[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'learning_rate' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_epochs' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'hidden_size' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'num_layers' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'dropout' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'weight_decay' was locked by 'sweep' (ignored update).
  0%|                                                                                              | 0/50 [00:00<?, ?it/s]
Creating dataset...
Loading data from /home/usuaris/veu/gerard.calvo.bartra/nuwe/model/../data/supply_chain_train_balanced.csv
Train batch 0:
{'data': tensor([[ 0.8175, -0.4065,  3.0796,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.1719, -1.4270,  1.2611,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.8175,  0.6141, -0.5574,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-0.4738, -0.4065,  0.3519,  ...,  0.0000,  0.0000,  0.0000],
        [-1.1194, -1.4270,  0.3519,  ...,  0.0000,  0.0000,  0.0000],
        [-0.4738,  0.6141,  0.3519,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1,
        0, 1, 1, 1, 0, 0, 1, 0])}
Validation batch 0:
{'data': tensor([[-1.1402,  0.6459, -1.3412,  ...,  0.0000,  0.0000,  0.0000],
        [-0.4862, -0.3693,  1.1670,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.1677, -0.3693, -1.3412,  ...,  0.0000,  0.0000,  0.0000],
        ...,
        [-1.1402,  0.6459,  2.0031,  ...,  0.0000,  0.0000,  0.0000],
        [-0.4862,  0.6459, -0.5051,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.1677, -0.3693,  1.1670,  ...,  0.0000,  0.0000,  0.0000]],
       dtype=torch.float64), 'target': tensor([0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1,
        1, 0, 1, 1, 1, 0, 0, 1])}
batch_data.shape: torch.Size([32, 32])
Percentage of positive and negative samples in the training set:
1    0.644696
0    0.355304
Name: Attrition_Flag, dtype: float64
BaselineNet(
  (fc): Sequential(
    (fc0): Linear(in_features=32, out_features=32, bias=True)
    (relu0): ReLU()
    (dropout0): Dropout(p=0.01449082910065771, inplace=False)
    (fc1): Linear(in_features=32, out_features=32, bias=True)
    (relu1): ReLU()
    (dropout1): Dropout(p=0.01449082910065771, inplace=False)
    (fc2): Linear(in_features=32, out_features=1, bias=True)
    (sigmoid): Sigmoid()
  )
)
Num params:  2145
Training the model...

  4%|███▍                                                                                  | 2/50 [00:03<01:21,  1.69s/it]
Epoch 0 (test) - Accuracy: 0.638 - F1 score: 0.779
Epoch 1 (train) - Loss: 0.631

  6%|█████▏                                                                                | 3/50 [00:05<01:23,  1.77s/it]
Epoch 2 (train) - Loss: 0.586

  8%|██████▉                                                                               | 4/50 [00:06<01:19,  1.73s/it]
Epoch 3 (train) - Loss: 0.543

 10%|████████▌                                                                             | 5/50 [00:08<01:15,  1.68s/it]
Epoch 4 (train) - Loss: 0.504

 12%|██████████▎                                                                           | 6/50 [00:10<01:14,  1.70s/it]
Epoch 5 (train) - Loss: 0.466
Epoch 5 (test) - Accuracy: 0.798 - F1 score: 0.850
Epoch 6 (train) - Loss: 0.436
Epoch 6 (test) - Accuracy: 0.812 - F1 score: 0.860

 14%|████████████                                                                          | 7/50 [00:12<01:14,  1.72s/it]
Epoch 7 (test) - Accuracy: 0.811 - F1 score: 0.857
Epoch 8 (train) - Loss: 0.401

 18%|███████████████▍                                                                      | 9/50 [00:15<01:10,  1.73s/it]
Epoch 9 (train) - Loss: 0.387

 20%|█████████████████                                                                    | 10/50 [00:17<01:08,  1.72s/it]
Epoch 10 (train) - Loss: 0.377

 22%|██████████████████▋                                                                  | 11/50 [00:18<01:07,  1.74s/it]
Epoch 11 (train) - Loss: 0.369

 24%|████████████████████▍                                                                | 12/50 [00:20<01:07,  1.78s/it]
Epoch 12 (train) - Loss: 0.356

 26%|██████████████████████                                                               | 13/50 [00:22<01:04,  1.75s/it]
Epoch 13 (train) - Loss: 0.349

 28%|███████████████████████▊                                                             | 14/50 [00:24<01:02,  1.73s/it]
Epoch 14 (train) - Loss: 0.340
Epoch 14 (test) - Accuracy: 0.848 - F1 score: 0.883

 30%|█████████████████████████▌                                                           | 15/50 [00:26<01:01,  1.74s/it]
Epoch 15 (test) - Accuracy: 0.856 - F1 score: 0.889
Epoch 16 (train) - Loss: 0.329

 34%|████████████████████████████▉                                                        | 17/50 [00:29<00:56,  1.72s/it]
Epoch 17 (train) - Loss: 0.324

 36%|██████████████████████████████▌                                                      | 18/50 [00:31<00:55,  1.72s/it]
Epoch 18 (train) - Loss: 0.316

 38%|████████████████████████████████▎                                                    | 19/50 [00:32<00:53,  1.72s/it]
Epoch 19 (train) - Loss: 0.312

 40%|██████████████████████████████████                                                   | 20/50 [00:34<00:51,  1.71s/it]
Epoch 20 (train) - Loss: 0.309

 42%|███████████████████████████████████▋                                                 | 21/50 [00:36<00:49,  1.71s/it]
Epoch 21 (train) - Loss: 0.303
Epoch 21 (test) - Accuracy: 0.862 - F1 score: 0.894

 44%|█████████████████████████████████████▍                                               | 22/50 [00:38<00:48,  1.73s/it]
Epoch 22 (test) - Accuracy: 0.865 - F1 score: 0.896
Epoch 23 (train) - Loss: 0.294

 48%|████████████████████████████████████████▊                                            | 24/50 [00:41<00:44,  1.70s/it]
Epoch 24 (train) - Loss: 0.290

 50%|██████████████████████████████████████████▌                                          | 25/50 [00:43<00:42,  1.71s/it]
Epoch 25 (train) - Loss: 0.284

 52%|████████████████████████████████████████████▏                                        | 26/50 [00:44<00:41,  1.74s/it]
Epoch 26 (train) - Loss: 0.283

 54%|█████████████████████████████████████████████▉                                       | 27/50 [00:46<00:40,  1.76s/it]
Epoch 27 (train) - Loss: 0.282

 58%|█████████████████████████████████████████████████▎                                   | 29/50 [00:50<00:36,  1.74s/it]
Epoch 28 (train) - Loss: 0.282
Epoch 28 (test) - Accuracy: 0.878 - F1 score: 0.906

 60%|███████████████████████████████████████████████████                                  | 30/50 [00:51<00:34,  1.75s/it]
Epoch 29 (test) - Accuracy: 0.885 - F1 score: 0.912
Epoch 30 (train) - Loss: 0.275

 62%|████████████████████████████████████████████████████▋                                | 31/50 [00:53<00:33,  1.76s/it]
Epoch 31 (train) - Loss: 0.272

 64%|██████████████████████████████████████████████████████▍                              | 32/50 [00:55<00:31,  1.73s/it]
Epoch 32 (train) - Loss: 0.270

 66%|████████████████████████████████████████████████████████                             | 33/50 [00:57<00:29,  1.73s/it]
Epoch 33 (train) - Loss: 0.267

 68%|█████████████████████████████████████████████████████████▊                           | 34/50 [00:58<00:27,  1.75s/it]
Epoch 34 (train) - Loss: 0.267
Epoch 34 (test) - Accuracy: 0.889 - F1 score: 0.915

 70%|███████████████████████████████████████████████████████████▍                         | 35/50 [01:00<00:25,  1.71s/it]
Epoch 35 (test) - Accuracy: 0.878 - F1 score: 0.906
Epoch 36 (train) - Loss: 0.263

 74%|██████████████████████████████████████████████████████████████▉                      | 37/50 [01:04<00:22,  1.75s/it]
Epoch 37 (train) - Loss: 0.262

 76%|████████████████████████████████████████████████████████████████▌                    | 38/50 [01:05<00:21,  1.76s/it]
Epoch 38 (train) - Loss: 0.261

 78%|██████████████████████████████████████████████████████████████████▎                  | 39/50 [01:07<00:18,  1.71s/it]
Epoch 39 (train) - Loss: 0.258

 80%|████████████████████████████████████████████████████████████████████                 | 40/50 [01:09<00:17,  1.70s/it]
Epoch 40 (train) - Loss: 0.257

 82%|█████████████████████████████████████████████████████████████████████▋               | 41/50 [01:10<00:15,  1.71s/it]
Epoch 41 (train) - Loss: 0.253
Epoch 41 (test) - Accuracy: 0.891 - F1 score: 0.916

 84%|███████████████████████████████████████████████████████████████████████▍             | 42/50 [01:12<00:13,  1.68s/it]
Epoch 42 (test) - Accuracy: 0.888 - F1 score: 0.915
Epoch 43 (train) - Loss: 0.254

 88%|██████████████████████████████████████████████████████████████████████████▊          | 44/50 [01:16<00:10,  1.73s/it]
Epoch 44 (train) - Loss: 0.251

 90%|████████████████████████████████████████████████████████████████████████████▌        | 45/50 [01:17<00:08,  1.75s/it]
Epoch 45 (train) - Loss: 0.253

 92%|██████████████████████████████████████████████████████████████████████████████▏      | 46/50 [01:19<00:06,  1.75s/it]
Epoch 46 (train) - Loss: 0.249

 94%|███████████████████████████████████████████████████████████████████████████████▉     | 47/50 [01:21<00:05,  1.73s/it]
Epoch 47 (train) - Loss: 0.247

 96%|█████████████████████████████████████████████████████████████████████████████████▌   | 48/50 [01:23<00:03,  1.73s/it]
Epoch 48 (train) - Loss: 0.244

 98%|███████████████████████████████████████████████████████████████████████████████████▎ | 49/50 [01:24<00:01,  1.75s/it]
Epoch 49 (train) - Loss: 0.246
Epoch 49 (test) - Accuracy: 0.881 - F1 score: 0.908
Plotting the results...
Saving the plot as 'results_baseline_model_2_balanced.png'...
Saving the model as 'baseline_model_2_balanced'...

100%|█████████████████████████████████████████████████████████████████████████████████████| 50/50 [01:26<00:00,  1.73s/it]
Done!